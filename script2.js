var A = "Ly8gQHRzLW5vY2hlY2sKCi8qYWxyZWFkeSBkaXNwYXRjaGVkIGlkcyovCnZhciB1RGxncyA9IFtdOwp2YXIgdUJvb2wgPSBbXTsKdmFyIHVGbHQgPSBbXTsKdmFyIHVJbnQgPSBbXTsKdmFyIHVJbnQyID0gWyJ0aGVtZV9zZWxlY3QiXTsKdmFyIHBJZCA9ICIiOwoKdmFyIGRBdmF0YXIgPSAiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL0NvbGFDYXByaWNob3NhL0ZQV0xSL2xvZ2FyZG8ucG5nIjsKdmFyIGFVcGRhdGUgPSBmYWxzZTsKdmFyIGhBbGlhcyA9IGZhbHNlOwp2YXIgbE1zZyA9IDA7CnZhciBmU25kID0gMDsKdmFyIGZVc2VyQ2QgPSAwOwoKY29uc3QgYnlJZCA9IChpZCkgPT4geyByZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOyB9Owpjb25zdCBjRWxlbWVudCA9ICh0cCkgPT4geyByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0cCk7IH07Cgpjb25zdCBjU3R5bGVzID0gewoJc2xpZGVyczogeyB0dGlwczogeyBjb2xvcjogIndoaXRlIiB9LCB0aXRsZXo6IHsgY29sb3I6ICJ3aGl0ZSIgfSwgYmd6OiB7IGNvbG9yOiAid2hpdGUiIH0gfSwKCWRsZ1RpdGxlczogewoJCXN0OiB7CgkJCXRleHRBbGlnbjogJ2NlbnRlcicsCgkJCXRleHREZWNvcmF0aW9uOiAndW5kZXJsaW5lJywKCQkJZm9udFNpemU6ICcxOHB4JywKCQkJbWFyZ2luQm90dG9tOiAnMTBweCcsCgkJCW1hcmdpblRvcDogIjBweCIsIGNvbG9yOiAid2hpdGUiCgkJfQoJfSwKCXN1YnRpdGxlczogeyBmb250U2l6ZTogIjE4cHgiLCBmb250V2VpZ2h0OiAiYm9sZCIsIG1hcmdpbkxlZnQ6ICIyMHB4IiwgZGlzcGxheTogImlubGluZS1mbGV4IiB9LAoJYmdTbGlkZXJzOiAicmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIxNCkiLAp9OwoKY29uc3Qgcm9sZWNsciA9IHsgIm5vcm1hbCI6ICIjNjA2MDYwIiwgInByZW1pdW0iOiAiIzhiYjBmZiIsICJjaGFkIjogIiNmZmU1OGIiLCAiR09EIjogIiNmMTRjMzkiLCAiUEFQSSI6ICIjY2U5OGUyIiB9OwoKY29uc3QgdG9vbHRpcCA9IGNFbGVtZW50KCJkaXYiKTsKdG9vbHRpcC5jbGFzc0xpc3QuYWRkKCJ0b29sdGlwIik7CnRvb2x0aXAuaWQgPSAid210b29sdGlwIjsKZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0b29sdGlwKTsKCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlb3ZlciIsIChldmVudCkgPT4gewoJY29uc3QgZWxlbWVudCA9IGV2ZW50LnRhcmdldDsKCgljb25zdCB0dGlwTXNnID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtdHRpcCIpOwoJaWYgKHR0aXBNc2cpIHsKCQl2YXIgd0RsZyA9IG51bGw7CgkJZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHVEbGdzLmxlbmd0aDsgaW5kZXgrKykgewoJCQlpZiAoY2hlY2tEbGcodURsZ3NbaW5kZXhdKSkgewoJCQkJd0RsZyA9IHVEbGdzW2luZGV4XTsKCQkJCWJyZWFrOwoJCQl9CgkJfQoKCQlpZiAod0RsZyAhPSBudWxsKSB7CgkJCWNvbnN0IGFsckV4aXN0VHRpcCA9IGJ5SWQod0RsZyArICJfdHRpcCIpOwoJCQljb25zdCBjVHRpcCA9IGFsckV4aXN0VHRpcCB8fCBjRWxlbWVudCgiZGl2Iik7CgkJCWlmICghYWxyRXhpc3RUdGlwKSB7CgkJCQljVHRpcC5jbGFzc0xpc3QuYWRkKCJ0b29sdGlwIik7CgkJCQljVHRpcC5pZCA9IHdEbGcgKyAiX3R0aXAiOwoKCQkJCWJ5SWQod0RsZykuYXBwZW5kQ2hpbGQoY1R0aXApOwoJCQl9CgkJCWNUdGlwLmlubmVyVGV4dCA9IHR0aXBNc2c7CgkJCWNUdGlwLnN0eWxlLnRvcCA9IGVsZW1lbnQub2Zmc2V0VG9wIC0gY1R0aXAub2Zmc2V0SGVpZ2h0IC0gOCArICJweCI7CgkJCWNUdGlwLnN0eWxlLmxlZnQgPSBlbGVtZW50Lm9mZnNldExlZnQgKyAoZWxlbWVudC5vZmZzZXRXaWR0aCAtIGNUdGlwLm9mZnNldFdpZHRoKSAvIDIgKyAicHgiOwoJCQljVHRpcC5jbGFzc0xpc3QuYWRkKCJ0b29sdGlwLS12aXNpYmxlIik7CgkJfQoJCWVsc2UgewoJCQl0b29sdGlwLmlubmVyVGV4dCA9IHR0aXBNc2c7CgkJCXRvb2x0aXAuc3R5bGUudG9wID0gZWxlbWVudC5vZmZzZXRUb3AgLSB0b29sdGlwLm9mZnNldEhlaWdodCAtIDggKyAicHgiOwoJCQl0b29sdGlwLnN0eWxlLmxlZnQgPSBlbGVtZW50Lm9mZnNldExlZnQgKyAoZWxlbWVudC5vZmZzZXRXaWR0aCAtIHRvb2x0aXAub2Zmc2V0V2lkdGgpIC8gMiArICJweCI7CgkJCXRvb2x0aXAuY2xhc3NMaXN0LmFkZCgidG9vbHRpcC0tdmlzaWJsZSIpOwoJCX0KCX0KfSk7Cgpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJtb3VzZW91dCIsIChldmVudCkgPT4gewoJY29uc3QgZWxlbWVudCA9IGV2ZW50LnRhcmdldDsKCWNvbnN0IHRvb2x0aXBNZXNzYWdlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtdHRpcCIpOwoJaWYgKHRvb2x0aXBNZXNzYWdlKSB7CgkJdmFyIHdEbGcgPSBudWxsOwoJCWZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCB1RGxncy5sZW5ndGg7IGluZGV4KyspIHsKCQkJaWYgKGNoZWNrRGxnKHVEbGdzW2luZGV4XSkpIHsKCQkJCXdEbGcgPSB1RGxnc1tpbmRleF07CgkJCX0KCQl9CgoJCWlmICh3RGxnICE9IG51bGwpIHsKCQkJY29uc3QgdG9vbHRpcHogPSBieUlkKHdEbGcgKyAiX3R0aXAiKTsKCQkJaWYgKHRvb2x0aXB6KSB7CgkJCQl0b29sdGlwei5pbm5lclRleHQgPSAoIi0iKS50cmltKCk7CgkJCQl0b29sdGlwei5jbGFzc0xpc3QucmVtb3ZlKCJ0b29sdGlwLS12aXNpYmxlIik7CgkJCX0KCQkJZWxzZSB7CgkJCQl0b29sdGlwLmlubmVyVGV4dCA9ICgiLSIpLnRyaW0oKTsKCQkJCXRvb2x0aXAuY2xhc3NMaXN0LnJlbW92ZSgidG9vbHRpcC0tdmlzaWJsZSIpOwoJCQl9CgkJfSBlbHNlIHsKCQkJdG9vbHRpcC5pbm5lclRleHQgPSAoIi0iKS50cmltKCk7CgkJCXRvb2x0aXAuY2xhc3NMaXN0LnJlbW92ZSgidG9vbHRpcC0tdmlzaWJsZSIpOwoJCX0KCX0KfSk7CgpwSWQgPSAicGFuZWxfY2hhdCI7CgpjVGV4dChwSWQsICJybmQiLCAiY2hhdCIsIHsKCXN0OiB7CgkJdGV4dEFsaWduOiAnY2VudGVyJywKCQl0ZXh0RGVjb3JhdGlvbjogJ3VuZGVybGluZScsCgkJZm9udFNpemU6ICcxOHB4JywKCQltYXJnaW5Cb3R0b206ICcxMHB4JywKCQltYXJnaW5Ub3A6ICIwcHgiLAoJfQp9KTsKCmNEaXYocElkLCAiY2hhdENvbnRhaW5lciIsIHsKCXdpZHRoOiAiMjMwcHgiLAoJaGVpZ2h0OiAiMzE1cHgiLAoJbWF4SGVpZ2h0OiAiMzE1cHgiLAoJb3ZlcmZsb3dZOiAiYXV0byIsCglwYWRkaW5nOiAiMTBweCIsCgliYWNrZ3JvdW5kQ29sb3I6ICd2YXIoLS1jLXNlY29uZGFyeSknLAp9KTsKCmNCcigpOwoKZnVuY3Rpb24gc2VuZENoYXQoKSB7CglpZiAoIWhBbGlhcykgewoJCW5vdGlmeSgiZGlzYWJsZWQgdG8gZGVmYXVsdCB1c2VycyIsIDcwMDApOwoJCXJldHVybjsKCX0KCglpZiAoY1R4dFZhbGlkKCdjaGF0X3RleHQnKSkgewoJCWNvbnN0IGNUZXh0ID0gYnlJZCgiY2hhdF90ZXh0IikudmFsdWU7CgkJc0J0bigic2VuZF9jaGF0IiwgY1RleHQpCgkJCS50aGVuKGFzeW5jIChyVHh0KSA9PiB7CgkJCQlub3RpZnkoclR4dC5yZXBsYWNlKC9fL2csICIgIiksIDcwMDApOwoKCQkJCWlmICghclR4dC5pbmNsdWRlcygiZG9uZSIpKQoJCQkJCXJldHVybjsKCgkJCQlhd2FpdCBzbGVlcCgzNTApOwoJCQkJdUNoYXQoKTsKCQkJCWJ5SWQoImNoYXRfdGV4dCIpLnZhbHVlID0gIiI7CgkJCX0pCgkJCS5jYXRjaCgoZXJyb3IpID0+IHsKCQkJCWNMb2coZXJyb3IpOwoJCQkJYnlJZCgiY2hhdF90ZXh0IikudmFsdWUgPSAiIjsKCQkJfSk7Cgl9CgllbHNlIHsKCQlub3RpZnkoIk5vIHNlIGFjZXB0YW4gY2FyYWN0ZXJlcyBlc3BlY2lhbGVzLCBkZSAxIGEgNjQgY2FyYWN0ZXJlcyBzb2xhbWVudGUuIiwgNTAwMCwgIlJFRCIpOwoJfQp9CgpjVHh0Ym94KHBJZCwgImNoYXRfdGV4dCIsIGZhbHNlLCAiIiwgIiIsIHt9LCB7CglwYXR0ZXJuOiAiXlthLXpBLVowLTkgXSokIiwKCW1pbkxlbmd0aDogMSwKCW1heExlbmd0aDogNjQsCglyZXF1aXJlZDogdHJ1ZSwKCXBsYWNlaG9sZGVyOiAid3JpdGUiLAoJZXZlbnRMaXN0ZW5lcjogewoJCWtleWRvd246IChlbCwgZXYpID0+IHsKCQkJaWYgKGV2LmtleSA9PT0gJ0VudGVyJykgewoJCQkJc2VuZENoYXQoKTsKCQkJfQoJCX0KCX0KfSwgdHJ1ZSk7CgpjQnRuKHBJZCwgImJ0bl9zZW5kX2NoYXQiLCAic2VuZCIsICgpID0+IHsKCXNlbmRDaGF0KCk7Cn0sICJFbnZpYSB1biBtZW5zYWplIGFsIGNoYXQsIHVuYSB2ZXogY2FkYSAzMCBzZWd1bmRvcy4iKTsKCmNIcihwSWQsIGZhbHNlLCB7IHdpZHRoOiAiMjAwcHgiIH0pOwoKY1RleHQocElkLCAidXNlcnNvbmxpbmUiLCAiZGlzYWJsZWQgb25saW5lcyIsIHsKCXN0OiB7CgkJdGV4dEFsaWduOiAnY2VudGVyJywKCQl0ZXh0RGVjb3JhdGlvbjogJ3VuZGVybGluZScsCgkJZm9udFNpemU6ICcxMHB4JywKCQltYXJnaW5Cb3R0b206ICcxMHB4JywKCQltYXJnaW5Ub3A6ICIwcHgiLAoJfQp9KTsKCmZ1bmN0aW9uIGdPbmxpbmVzKCkgewoJaWYgKCFoQWxpYXMpIHJldHVybjsKCglpZiAoYnlJZCgibGVmdF9wYW5lbCIpLnN0eWxlLmRpc3BsYXkgPT0gIm5vbmUiKQoJCXJldHVybjsKCgl6bkdldCgib25saW5lcyIsICJ6eiIpCgkJLnRoZW4oKHJUeHQpID0+IHsKCQkJdHJ5IHsKCQkJCWNvbnN0IGxpdmVzID0gSlNPTi5wYXJzZShyVHh0KTsKCQkJCWNvbnN0IG9ubGluZXNlbCA9IGJ5SWQoJ3VzZXJzb25saW5lJyk7CgkJCQlvbmxpbmVzZWwuaW5uZXJIVE1MID0gIjxwIGRhdGEtdHRpcD0ndG90YWw6ICIgKyBsaXZlcy5hbGxfb25saW5lcyArICInIHN0eWxlPSdmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToxNHB4O21hcmdpbi1ib3R0b206MHB4O21hcmdpbi10b3A6MHB4Oyc+b25saW5lcyAoIiArIGxpdmVzLmxpdmUubGVuZ3RoICsgIik8L3A+PGJyPiIgKyBsaXZlcy5saXZlLmpvaW4oIiwgIik7CgkJCX0gY2F0Y2ggKGVycm9yKSB7CgkJCQljTG9nKGVycm9yLCByVHh0KTsKCQkJfQoJCX0pCgkJLmNhdGNoKChlcnJvcikgPT4gewoJCQljTG9nKGVycm9yKTsKCQl9KTsKfQoKZ09ubGluZXMoKTsKCmNIcihwSWQsIGZhbHNlLCB7IHdpZHRoOiAiMjAwcHgiIH0pOwoKY0J0bihwSWQsICJybmQiLCAic2VhcmNoIHVzZXIiLCAoKSA9PiB7CglzaG93RGxnKCJmaW5kdXNlcmRsZyIpOwp9LCAiQnVzY2EgdW4gdXN1YXJpby4iLCB7IGp1c3RpZnlTZWxmOiAiY2VudGVyIiB9KTsKCmNCcigpOwoKY0RsZyhwSWQsICJmaW5kdXNlcmRsZyIsIHt9LCB7fSwgKGNFbCkgPT4gewoJY1RleHQoY0VsLmlkLCAicm5kIiwgInNlYXJjaCB1c2VyIiwgY1N0eWxlcy5kbGdUaXRsZXMpOwoKCWNCcihjRWwuaWQpOwoKCWNUeHRib3goY0VsLmlkLCAiZmluZF91c2VyIiwgZmFsc2UsICIiLCAiIiwge30sIHsKCQlwYXR0ZXJuOiAiXlthLXpBLVowLTldKiQiLAoJCW1pbkxlbmd0aDogMywKCQltYXhMZW5ndGg6IDIwLAoJCXJlcXVpcmVkOiB0cnVlLAoJCXBsYWNlaG9sZGVyOiAiYWxpYXMiLAoJCWV2ZW50TGlzdGVuZXI6IHsKCQkJa2V5ZG93bjogKGVsLCBldikgPT4gewoJCQkJaWYgKGV2LmtleSA9PT0gJ0VudGVyJykgewoJCQkJCWJ5SWQoImJ0bl9maW5kX3VzZXIiKS5jbGljaygpOwoJCQkJfQoJCQl9CgkJfQoJfSwgdHJ1ZSk7CgoJY0J0bihjRWwuaWQsICJidG5fZmluZF91c2VyIiwgImZpbmQiLCAoKSA9PiB7CgkJaWYgKCFjVHh0VmFsaWQoJ2ZpbmRfdXNlcicsIHRydWUpKSB7CgkJCW5vdGlmeSgnaW52YWxpZCBpbnB1dCcpOwoJCQlyZXR1cm47CgkJfQoKCQlpZiAoZlVzZXJDZCA+IGdUbUludCgpKSB7CgkJCW5vdGlmeSgicmVjZW50bHkgdXNlZCwgd2FpdCAiICsgKGZVc2VyQ2QgLSBnVG1JbnQoKSkgKyAiIHNlY29uZHMiLCA3MDAwKTsKCQkJcmV0dXJuOwoJCX0KCgkJYnlJZCgibG9hZGluZ2F2YXRhcjIiKS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKCgkJem5HZXQoImluZm9fYWxpYXMiLCBieUlkKCJmaW5kX3VzZXIiKS52YWx1ZSkKCQkJLnRoZW4oKHJUeHQpID0+IHsKCQkJCXRyeSB7CgkJCQkJdmFyIHVJbmYgPSBKU09OLnBhcnNlKHJUeHQpOwoKCQkJCQlpZiAodUluZlsiYXZhdGFyIl0pIHsKCQkJCQkJYnlJZCgidXNlcl9hdnRyIikuc3JjID0gd2luZG93LmF0b2IodUluZlsiYXZhdGFyIl0pOwoJCQkJCX0KCgkJCQkJdmFyIHVEYXRhID0gIiI7CgkJCQkJdURhdGEgKz0gIjxwIHN0eWxlPSdtYXJnaW4tdG9wOjBweDttYXJnaW4tYm90dG9tOjBweDsnPjxzdHJvbmc+QCIgKyB1SW5mWyJhbGlhcyJdOwoKCQkJCQlpZiAodUluZlsicm9sZSJdKQoJCQkJCQl1RGF0YSArPSAiPHNwYW4gc3R5bGU9J2Rpc3BsYXk6aW5saW5lO2ZvbnQtc2l6ZToxMHB4O2NvbG9yOiIgKyByb2xlY2xyW3VJbmZbInJvbGUiXS50b0xvd2VyQ2FzZSgpXSArICI7Jz4gKCIgKyB1SW5mWyJyb2xlIl0gKyAiKTwvc3Bhbj48YnI+PC9zdHJvbmc+PC9wPiI7CgoJCQkJCWlmICh1SW5mWyJ1c2VyX2lkIl0pCgkJCQkJCXVEYXRhICs9ICI8cCBzdHlsZT0nZm9udC1zaXplOjEwcHg7bWFyZ2luLXRvcDowcHg7Jz51aWQ6ICIgKyB1SW5mWyJ1c2VyX2lkIl07CgkJCQkJZWxzZQoJCQkJCQl1RGF0YSArPSAiPHAgc3R5bGU9J2ZvbnQtc2l6ZToxMHB4O21hcmdpbi10b3A6MHB4Oyc+YmV0YSI7CgoJCQkJCWlmICh1SW5mWyJyZWdpc3Rlcl90aW1lIl0pCgkJCQkJCXVEYXRhICs9ICIgLSBqb2luZWQ6ICIgKyBnVG1TdHIodUluZlsicmVnaXN0ZXJfdGltZSJdLCAwKSArICI8L3A+IjsKCQkJCQllbHNlCgkJCQkJCXVEYXRhICs9ICI8L3A+IjsKCgkJCQkJaWYgKHVJbmZbImRlc2NyaXB0aW9uIl0pCgkJCQkJCXVEYXRhICs9ICI8cCBzdHlsZT0nZm9udC1zaXplOjEycHg7bWFyZ2luLXRvcDogMHB4Oyc+aW5mbzogIiArIHdpbmRvdy5hdG9iKHVJbmZbImRlc2NyaXB0aW9uIl0pICsgIjwvcD4iOwoJCQkJCWVsc2UKCQkJCQkJdURhdGEgKz0gIjxwIHN0eWxlPSdmb250LXNpemU6MTJweDttYXJnaW4tdG9wOiAwcHg7Jz5ubyBpbmZvPC9wPiIKCgkJCQkJYnlJZCgidXNlcl9pbmYiKS5pbm5lckhUTUwgPSB1RGF0YTsKCgkJCQkJc2V0VGltZW91dChhc3luYyAoKSA9PiB7CgkJCQkJCWJ5SWQoImxvYWRpbmdhdmF0YXIyIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKCQkJCQl9LCAxMjUwKTsKCQkJCX0gY2F0Y2ggKGVycm9yKSB7CgkJCQkJbm90aWZ5KHJUeHQucmVwbGFjZSgvXy9nLCAiICIpLCA3MDAwKTsKCQkJCQlpZiAoclR4dC5pbmNsdWRlcygicmVjZW50bHkiKSkgewoJCQkJCQlpZiAoZlVzZXJDZCA8IGdUbUludCgpKQoJCQkJCQkJZlVzZXJDZCA9IGdUbUludCgpICsgMzA7CgkJCQkJfQoJCQkJfQoJCQl9KQoJCQkuY2F0Y2goKGVycm9yKSA9PiB7CgkJCQljTG9nKGVycm9yKTsKCQkJfSk7Cgl9LCAiIiwgeyBtYXJnaW5MZWZ0OiAiMTBweCIgfSk7CgoJY0J0bihjRWwuaWQsICJybmQiLCAiY2xvc2UiLCAoKSA9PiB7CgkJY2xvc2VEbGcoY0VsLmlkKTsKCX0sICIiLCB7IG1hcmdpbkxlZnQ6ICIxMHB4IiB9KTsKCgljSHIoY0VsLmlkLCBmYWxzZSwgeyB3aWR0aDogIjIwMHB4IiB9KTsKCgljRGl2KGNFbC5pZCwgInVzZXJfaW5mYWxpYXMiLCB7CgkJZGlzcGxheTogImlubGluZS1ncmlkIiwKCQlncmlkVGVtcGxhdGVDb2x1bW5zOiAicmVwZWF0KDMsIDEwNXB4KSIsCgkJZ3JpZEdhcDogIjEwcHgiCgl9KTsKCgljQnIoY0VsLmlkLCAyKTsKCgljTG9hZGluZygndXNlcl9pbmZhbGlhcycsICJsb2FkaW5nYXZhdGFyMiIsIHsgcG9zaXRpb246ICJhYnNvbHV0ZSIsIGRpc3BsYXk6ICJub25lIiwgbGVmdDogIjY0cHgiLCB0b3A6ICIxNjFweCIsIH0pOwoKCWNJbWcoInVzZXJfaW5mYWxpYXMiLCAidXNlcl9hdnRyIiwgZEF2YXRhciwgOTAsIDkwLAoJCXsKCQkJbWFyZ2luTGVmdDogIjEwcHgiLAoJCQlvYmplY3RGaXQ6ICJjb3ZlciIsCgkJCWJvcmRlclJhZGl1czogIjVweCIsCgkJCXBsYWNlU2VsZjogIm5vcm1hbCIKCQl9KTsKCgljQnIoY0VsLmlkLCAyKTsKCgljVGV4dCgidXNlcl9pbmZhbGlhcyIsICJ1c2VyX2luZiIsICJub25lIiwgewoJCXN0OiB7CgkJCWRpc3BsYXk6ICJncmlkIiwgZ3JpZFRlbXBsYXRlQ29sdW1uczogIjE2MHB4IiwgbWFyZ2luVG9wOiAiMHB4IiwgY29sb3I6ICJ3aGl0ZSIKCQl9Cgl9KTsKfSk7CgpmdW5jdGlvbiBwU25kKGlkKSB7CglpZiAoZlNuZCA9PSAwKSB7CgkJZlNuZCsrOwoJfQoJZWxzZSB7CgkJY29uc3QgZWxlbWVudCA9IGJ5SWQoaWQpOwoJCWVsZW1lbnQudm9sdW1lID0gMC4xOwoJCWVsZW1lbnQucGxheSgpOwoJfQp9CgpmdW5jdGlvbiB1Q2hhdCgpIHsKCWlmIChieUlkKCJsZWZ0X3BhbmVsIikuc3R5bGUuZGlzcGxheSA9PSAibm9uZSIpCgkJcmV0dXJuOwoKCWlmICghaEFsaWFzKSB7CgkJY29uc3QgY2hhdENvbnRhaW5lciA9IGJ5SWQoJ2NoYXRDb250YWluZXInKTsKCQljaGF0Q29udGFpbmVyLmlubmVySFRNTCA9ICcnOwoJCWNvbnN0IGNoYXRFbGVtZW50ID0gY0VsZW1lbnQoJ2RpdicpOwoJCWNoYXRFbGVtZW50LnN0eWxlLmZvbnRTaXplID0gIjEycHgiOwoJCWNoYXRFbGVtZW50LmlubmVySFRNTCA9IGAoPHNwYW4gZGF0YS10dGlwPScke2dUbVN0cihwYXJzZUludChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApLCAwKX0nIHN0eWxlPSJvcGFjaXR5OiAwLjU7Ij4ke2dUbVN0cihwYXJzZUludChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApKX08L3NwYW4+KSA8c3BhbiBzdHlsZT0nJHsoImNvbG9yOiIgKyAoT2JqZWN0LmVudHJpZXMocm9sZWNscilbNF1bIjEiXSkgKyAiOyIpfSc+PHN0cm9uZz5aSU5DPC9zdHJvbmc+PC9zcGFuPjogY2hhdCBkaXNhYmxlZCB0byBkZWZhdWx0IGFsaWFzZXMsIGNoYW5nZSB5b3VyIGFsaWFzIGluIHRoZSByaWdodCBwYW5lbGA7CgkJY2hhdENvbnRhaW5lci5hcHBlbmRDaGlsZChjaGF0RWxlbWVudCk7CgkJcmV0dXJuOwoJfQoKCXpuR2V0KCJnZXRfY2hhdCIsICJ6IikKCQkudGhlbigoclR4dCkgPT4gewoJCQljb25zdCBjaGF0cyA9IEpTT04ucGFyc2UoclR4dCk7CgkJCWNvbnN0IGNoYXRDb250YWluZXIgPSBieUlkKCdjaGF0Q29udGFpbmVyJyk7CgkJCWNoYXRDb250YWluZXIuaW5uZXJIVE1MID0gJyc7CgoJCQlsZXQgdEhpZ2hlc3QgPSAwOwoJCQljaGF0cy5mb3JFYWNoKGFzeW5jIChjaGF0KSA9PiB7CgoJCQkJaWYgKCFjaGF0Lm1zZy5pbmNsdWRlcygiZGlzYWJsZWQiKSkKCQkJCQlpZiAodEhpZ2hlc3QgPCBjaGF0LnRzKQoJCQkJCQl0SGlnaGVzdCA9IGNoYXQudHM7CgoJCQkJY29uc3QgY2hhdEVsZW1lbnQgPSBjRWxlbWVudCgnZGl2Jyk7CgkJCQljaGF0RWxlbWVudC5zdHlsZS5mb250U2l6ZSA9ICIxMnB4IjsKCgkJCQlpZiAoIWNoYXQubXNnLmluY2x1ZGVzKCJkaXNhYmxlZCIpKQoJCQkJCWNoYXRFbGVtZW50LmlubmVySFRNTCA9IGAoPHNwYW4gZGF0YS10dGlwPScke2dUbVN0cihjaGF0LnRzLCAwKX0nIHN0eWxlPSJvcGFjaXR5OiAwLjU7Ij4ke2dUbVN0cihjaGF0LnRzKX08L3NwYW4+KSA8c3BhbiBzdHlsZT0nJHtjaGF0LnIgIT0gdW5kZWZpbmVkID8gKCJjb2xvcjoiICsgKE9iamVjdC5lbnRyaWVzKHJvbGVjbHIpW2NoYXQucl1bIjEiXSkgKyAiOyIpIDogIiJ9Jz48c3Ryb25nPiR7Y2hhdC51fTwvc3Ryb25nPjwvc3Bhbj46ICR7d2luZG93LmF0b2IoY2hhdC5tc2cpfWA7CgkJCQllbHNlCgkJCQkJY2hhdEVsZW1lbnQuaW5uZXJIVE1MID0gYCg8c3BhbiBkYXRhLXR0aXA9JyR7Z1RtU3RyKGNoYXQudHMsIDApfScgc3R5bGU9Im9wYWNpdHk6IDAuNTsiPiR7Z1RtU3RyKGNoYXQudHMpfTwvc3Bhbj4pIDxzcGFuIHN0eWxlPScke2NoYXQuciAhPSB1bmRlZmluZWQgPyAoImNvbG9yOiIgKyAoT2JqZWN0LmVudHJpZXMocm9sZWNscilbY2hhdC5yXVsiMSJdKSArICI7IikgOiAiIn0nPjxzdHJvbmc+JHtjaGF0LnV9PC9zdHJvbmc+PC9zcGFuPjogJHtjaGF0Lm1zZ31gOwoKCQkJCWNoYXRDb250YWluZXIuYXBwZW5kQ2hpbGQoY2hhdEVsZW1lbnQpOwoKCQkJCWNIcigiY2hhdENvbnRhaW5lciIsIGZhbHNlLCB7CgkJCQkJb3BhY2l0eTogIjAuMiIsCgkJCQkJcGFkZGluZ1RvcDogIjBweCIsCgkJCQkJcGFkZGluZ0JvdHRvbTogIjBweCIsCgkJCQl9KTsKCQkJfSk7CgoJCQlpZiAobE1zZyAhPSB0SGlnaGVzdCkgewoJCQkJcFNuZCgic25kMSIpOwoJCQkJbE1zZyA9IHRIaWdoZXN0OwoJCQl9CgkJfSkKCQkuY2F0Y2goKGVycm9yKSA9PiB7CgkJCWNMb2coZXJyb3IpOwoJCX0pOwp9CgpwSWQgPSAibWFpbl9lbGVtZW50cyI7CmJ5SWQoInRpdGxlX2lkIikuaW5uZXJUZXh0ID0gIlpJTkMiOwoKY1RhYkJ0bigiZWxlbWVudF9yaWdodF9idXR0b25zIiwgWwoJeyBpZDogInBfdXBkYXRlcyIsIHRleHQ6ICJsb2dzIiB9LAoJeyBpZDogInBfdGlja2V0cyIsIHRleHQ6ICJ0aWNrZXRzIiB9LAoJeyBpZDogInBfcHJvZmlsZSIsIHRleHQ6ICJwcm9maWxlIiB9Cl0sIDIpOwoKLypTVEFSVCBGRUFUVVJFUyovCmJ5SWQoInByb2R1Y3RfaWQiKS5pbm5lclRleHQgPSAic2NyaXB0IjsKCmNUYWJCdG4oImVsZW1lbnRfYnV0dG9ucyIsIFsKCXsgaWQ6ICJtYWluX3RhYiIsIHRleHQ6ICJtYWluIiB9LAoJeyBpZDogImtleXNfdGFiIiwgdGV4dDogImtleXMiIH0sCgl7IGlkOiAib3ZlcmxheV90YWIiLCB0ZXh0OiAib3ZlcmxheSIgfSwKCXsgaWQ6ICJzZXR0aW5nc190YWIiLCB0ZXh0OiAibWlzYyIgfSwKCXsgaWQ6ICJxcmNvZGVfdGFiIiwgdGV4dDogIlFSIiB9Cl0pOwoKCmNDaGVja2JveChwSWQsICJlbmFibGVfcmNzIiwgImVuYWJsZSIsICJBY3RpdmEgZWwgZnVuY2lvbmFtaWVudG8gZGVsIHNjcmlwdC4iKTsKY0N1c3RvbXMocElkLCAicm5kIiwgImV4dHJhIG9wdGlvbnMiLCAoY0VsKSA9PiB7CgljVGV4dChjRWwuY2lkLCAicm5kIiwgIk9wdGlvbnMiLCBjU3R5bGVzLmRsZ1RpdGxlcyk7CgoJY1NsckZsb2F0KGNFbC5jaWQsICJyY3NfeCIsICJub3JtYWwgcmNzIHgiLCAwLjAxLCAxLjcsIDAuMDEsIDEuMCwgIkFncmVnYS9xdWl0YSB2YWxvciBhbCBFamUgWCIsIGNTdHlsZXMuc2xpZGVycyk7CgljU2xyRmxvYXQoY0VsLmNpZCwgInJjc195IiwgIm5vcm1hbCByY3MgeSIsIDAuMDEsIDEuNywgMC4wMSwgMS4wLCAiQWdyZWdhL3F1aXRhIHZhbG9yIGFsIEVqZSBZIiwgY1N0eWxlcy5zbGlkZXJzKTsKCWNTbHJJbnQoY0VsLmNpZCwgInJjc3Ntb290aCIsICJzbW9vdGgiLCA0LCAxNSwgMSwgNSwgIkFncmVnYSBzdWF2aWRhZCBhIGxvcyBtb3ZpbWllbnRvcywgaGFjaWVuZG9sb3MgbWFzICdodW1hbm9zJyAoU2UgZGVzYWN0aXZhIGVuIGZhc3QtbW9kZSkiLCBjU3R5bGVzLnNsaWRlcnMpOwoKCWNCdG4oY0VsLmNpZCwgInJuZCIsICJjbG9zZSIsICgpID0+IHsKCQlieUlkKGNFbC5jaWQpLmNsb3NlKCk7Cgl9LCAiIiwgeyB3aWR0aDogIjEwMCUiIH0pOwp9LCB7IGNvbG9yOiAid2hpdGUiLCB3aWR0aDogIjM1MHB4IiB9KTsKCmNDaGVja2JveChwSWQsICJmYXN0X21vZGUiLCAiZmFzdCBtb2RlIChISUdIIENQVSkiLCAiQWN0aXZhIGVsIG1vZG8gcmFwaWRvLCBmb3J6YW5kbyBhbCBwcm9ncmFtYSBhIGNvbnN1bWlyIG1hcyBDUFUuIik7CgpjQ29tYm9Cb3gocElkLCAid2VhcG9uX2NvbWJvIiwgIndlYXBvbiIsIDAsIDksIGZhbHNlLCAiQXJtYSBxdWUgZWwgc2NyaXB0IGludGVudGFyYSBjb21wZW5zYXIiLCAoKSA9PiB7CglySW5mbygpOwp9KTsKCmNDb21ib0JveChwSWQsICJzY29wZV9jb21ibyIsICJzY29wZSIsIDAsIDQsIGZhbHNlLCAiU2NvcGUgcXVlIGVsIHNjcmlwdCBpbnRlbnRhcmEgY29tcGVuc2FyIik7CmNDb21ib0JveChwSWQsICJiYXJyZWxfY29tYm8iLCAiYmFycmVsIiwgMCwgMywgZmFsc2UsICJCYXJyZWwgcXVlIGVsIHNjcmlwdCBpbnRlbnRhcmEgY29tcGVuc2FyIik7CgpjU2xyRmxvYXQocElkLCAic2Vuc2luZ2FtZSIsICJzZW5zaXRpdml0eSIsIDAuMDEsIDMuMCwgMC4wMSwgMS4wLCAiRGViZXMgcG9uZXIgdHUgU0VOU0lCSUxJREFEIGRlbCBqdWVnbyAoIDAuMDEgLSAzLjAwICkiKTsKY1NsckZsb2F0KHBJZCwgImZvdmluZ2FtZSIsICJmb3YiLCA3MC4wLCA5MC4wLCAxLjAsIDkwLjAsICJEZWJlcyBwb25lciB0dSBGT1YgZGVsIGp1ZWdvICggNzAgLSA5MCApIik7CgpwSWQgPSAia2V5c19lbGVtZW50cyI7CmNDb21ib0JveChwSWQsICJtYWluX3RvZ2dsZSIsICJtYWluIHRvZ2dsZSIsIC0xMDAwMDAsIDEwMDAwMCwgZmFsc2UsICJBY3RpdmEvRGVzYWN0aXZhIGVsIHNjcmlwdCIpOwpjQ29tYm9Cb3gocElkLCAiY3Jvc3NfdG9nZ2xlIiwgImNyb3NzaGFpciB0b2dnbGUiLCAtMTAwMDAwLCAxMDAwMDAsIGZhbHNlLCAiQWN0aXZhL0Rlc2FjdGl2YSBlbCBjcm9zc2hhaXIiKTsKY0NvbWJvQm94KHBJZCwgIndlYXBvbl9jeWNsZSIsICJ3ZWFwb24gY3ljbGUiLCAtMTAwMDAwLCAxMDAwMDAsIGZhbHNlLCAiQ2FtYmlhIGEgbGEgc2lndWllbnRlIGFybWEgZW4gbGEgbGlzdGEiKTsKY0NvbWJvQm94KHBJZCwgInNjb3BlX2N5Y2xlIiwgInNjb3BlIGN5Y2xlIiwgLTEwMDAwMCwgMTAwMDAwLCBmYWxzZSwgIkNhbWJpYSBhbCBzaWd1aWVudGUgc2NvcGUgZW4gbGEgbGlzdGEiKTsKY0NvbWJvQm94KHBJZCwgImJhcnJlbF9jeWNsZSIsICJiYXJyZWwgY3ljbGUiLCAtMTAwMDAwLCAxMDAwMDAsIGZhbHNlLCAiQ2FtYmlhIGFsIHNpZ3VpZW50ZSBiYXJyZWwgZW4gbGEgbGlzdGEiKTsKCnBJZCA9ICJvdmVybGF5X2VsZW1lbnRzIjsKY0NoZWNrYm94KHBJZCwgIm92ZXJsYXl6IiwgIm92ZXJsYXkiLCAiQWN0aXZhIGVsIG92ZXJsYXkgKGRlYmVzIHRlbmVyIGVsIG92ZXJsYXkgZGVsIGp1ZWdvIGFjdGl2YWRvKS4iKTsKY0N1c3RvbXMocElkLCAicm5kIiwgImV4dHJhIG9wdGlvbnMiLCAoY0VsKSA9PiB7CgljVGV4dChjRWwuY2lkLCAicm5kIiwgIk9wdGlvbnMiLCBjU3R5bGVzLmRsZ1RpdGxlcyk7CgoJY1NsckludChjRWwuY2lkLCAib3ZlcmxheV9wb3NfeCIsICJvdmVybGF5IHBvc2l0aW9uIHgiLCAxLCAyNDQwLCA1LCAxNSwgIiIsIGNTdHlsZXMuc2xpZGVycyk7CgljU2xySW50KGNFbC5jaWQsICJvdmVybGF5X3Bvc195IiwgIm92ZXJsYXkgcG9zaXRpb24geSIsIDEsIDE0NDAsIDUsIDE1LCBjU3R5bGVzLnNsaWRlcnMpOwoKCWNCdG4oY0VsLmNpZCwgInJuZCIsICJjbG9zZSIsICgpID0+IHsKCQlieUlkKGNFbC5jaWQpLmNsb3NlKCk7Cgl9LCAiIiwgeyB3aWR0aDogIjEwMCUiIH0pOwp9LCB7IGNvbG9yOiAid2hpdGUiLCB3aWR0aDogIjM1MHB4IiB9KTsKY0NoZWNrYm94KHBJZCwgIndhdGVybWFyayIsICJpbmZvIHdlYXBvbiBhdHRhY2htZW50cyIsICJNdWVzdHJhIHR1IGFybWEtc2NvcGUtYmFycmVsIGFjdHVhbCBkZWwgc2NyaXB0Iik7CmNDaGVja2JveChwSWQsICJjcm9zc2hhaXIiLCAiY3Jvc3NoYWlyIiwgIk11ZXN0cmEgdW4gY3Jvc3NoYWlyIChkb3QpIGVuIG1lZGlvIGRlIGxhIHBhbnRhbGxhIik7CmNDdXN0b21zKHBJZCwgInJuZCIsICJleHRyYSBvcHRpb25zIiwgKGNFbCkgPT4gewoJY1RleHQoY0VsLmNpZCwgInJuZCIsICJPcHRpb25zIiwgY1N0eWxlcy5kbGdUaXRsZXMpOwoKCWNDaGVja2JveChjRWwuY2lkLCAiZGlzYWJsZWNyb3NzIiwgImRpc2FibGUgY3Jvc3NoYWlyIG9uIGFpbSIsICJEZXNoYWJpbGl0YSB0dSBjcm9zc2hhaXIgYWwgYXB1bnRhciBjb24gUi1DbGljay4iKTsKCgljQnRuKGNFbC5jaWQsICJybmQiLCAiY2xvc2UiLCAoKSA9PiB7CgkJYnlJZChjRWwuY2lkKS5jbG9zZSgpOwoJfSwgIiIsIHsgd2lkdGg6ICIxMDAlIiB9KTsKfSwgeyBjb2xvcjogIndoaXRlIiwgd2lkdGg6ICIzNTBweCIgfSk7CgpwSWQgPSAiZWxlbWVudHNfY2ZnYiI7CmNDaGVja2JveChwSWQsICJzb3VuZF9vbl9jaGFuZ2UiLCAic291bmRzIG9uIHdlYXBvbiBjaGFuZ2UiKTsKY0NoZWNrYm94KHBJZCwgInNvdW5kX29uX2VuZGlzIiwgInNvdW5kcyBvbiBlbmFibGUvZGlzYWJsZSIpOwpjQ2hlY2tib3gocElkLCAic291bmRzb25zdGFydCIsICJzb3VuZHMgb24gc3RhcnQiKTsKCmZDb21ibygid2VhcG9uX2NvbWJvIiwgIndlYXBvbnMiKTsKZkNvbWJvKCJzY29wZV9jb21ibyIsICJzY29wZXMiKTsKZkNvbWJvKCJiYXJyZWxfY29tYm8iLCAiYmFycmVscyIpOwoKY29uc3QgYmluZEVsZW1lbnRzID0gWwoJeyBpZDogIm1haW5fdG9nZ2xlIiwgdGFyZ2V0OiAibWFpbl90b2dnbGUiIH0sCgl7IGlkOiAid2VhcG9uX2N5Y2xlIiwgdGFyZ2V0OiAid2VhcG9uX2N5Y2xlIiB9LAoJeyBpZDogInNjb3BlX2N5Y2xlIiwgdGFyZ2V0OiAic2NvcGVfY3ljbGUiIH0sCgl7IGlkOiAiYmFycmVsX2N5Y2xlIiwgdGFyZ2V0OiAiYmFycmVsX2N5Y2xlIiB9LAoJeyBpZDogImNyb3NzX3RvZ2dsZSIsIHRhcmdldDogImNyb3NzX3RvZ2dsZSIgfSwKXTsKCi8qRU5EIEZFQVRVUkVTKi8KCmZDb21ibygiYWxsX3Byb2ZpbGVzIiwgImFsbF9wcm9maWxlcyIpOwoKcElkID0gImVsZW1lbnRzX2NmZ2IiOwoKY0NoZWNrYm94KHBJZCwgImF1dG9fdXBkYXRlX21lbnUiLCAiQXV0by11cGRhdGUgbWVudSIsICJTZSBhY3R1YWxpemFyYSBsYSBwYWdpbmEgYXV0b21hdGljYW1lbnRlIGNhZGEgNSBzZWd1bmRvcyBlbiBjYXNvIGRlIHF1ZSBoYXlhIGNhbWJpb3MgZGVzZGUgb3RyYSBwYWdpbmEuIiwKCShjRWwpID0+IHsKCQlhVXBkYXRlID0gY0VsLmNoZWNrZWQ7Cgl9KTsKCmNIcigpOwpjVGV4dChwSWQsICJybmQiLCAiJiM5Njc5OyBjbG91ZCBwcm9maWxlcyIsIHsKCXN0OiBjU3R5bGVzLnN1YnRpdGxlcywgZm46IChjRWwpID0+IHsKCQljVG9vbHRpcChjRWwuaWQsICJwZXJmaWxlcyBjbG91ZCwgc2UgZ3VhcmRhbiBkZSBmb3JtYSBzZWd1cmEgZW4gZWwgc2Vydmlkb3IgZGUgemluYy4iKTsKCQljQnIoKTsKCX0KfSk7CgpjQnRuKHBJZCwgImJ0bl9zdl9wcm9maWxlIiwgImNyZWF0ZSBwcm9maWxlIiwgKCkgPT4gewoJc2hvd0RsZygiZGxnX2NyZWF0ZV9wcm9mIik7Cn0sICJHdWFyZGEgdHUgcGVyZmlsIGFjdHVhbCBlbiBlbCBzZXJ2aWRvciwgZWwgY3VhbCBwdWVkZXMgY2FyZ2FyIiwgeyBtYXJnaW5SaWdodDogIjVweCIgfSk7CgpjRGxnKCdlbGVtZW50X2NvbmZpZycsICdkbGdfY3JlYXRlX3Byb2YnLCB7fSwge30sIChjRWwpID0+IHsKCWNUZXh0KGNFbC5pZCwgInJuZCIsICJDbG91ZCBwcm9maWxlIGNyZWF0b3IuIiwgY1N0eWxlcy5kbGdUaXRsZXMpOwoKCWNUeHRib3goY0VsLmlkLCAiY3Byb2ZpbGVuYW1lIiwgZmFsc2UsICJwcm9maWxlIG5hbWUgIiwgIiIsIHsKCQlyZXNpemU6ICdub25lJywKCQlvdmVyZmxvdzogJ2hpZGRlbicsCgkJd2hpdGVTcGFjZTogJ3ByZS13cmFwJywKCQltYXJnaW5Ub3A6ICI1cHgiLAoJCWNvbG9yOiAid2hpdGUiLCBsYWJlbHo6IHsgY29sb3I6ICJ3aGl0ZSIgfQoJfSwgewoJCXBhdHRlcm46ICJeW2EtekEtWjAtOV0qJCIsCgkJbWluTGVuZ3RoOiAxLAoJCW1heExlbmd0aDogMTYsCgkJcGxhY2Vob2xkZXI6ICJuYW1lIiwKCQlyZXF1aXJlZDogdHJ1ZSwKCX0pOwoJY0J0bihjRWwuaWQsICJybmQiLCAiY3JlYXRlIiwgKCkgPT4gewoJCWlmIChjVHh0VmFsaWQoJ2Nwcm9maWxlbmFtZScpKSB7CgkJCXZhciB2YWwgPSBieUlkKCJjcHJvZmlsZW5hbWUiKS52YWx1ZTsKCgkJCXNCdG4oInNhdmVfcHJvZmlsZSIsIHZhbCArICItIiArIHZhbCkKCQkJCS50aGVuKChyVHh0KSA9PiB7CgkJCQkJbm90aWZ5KHJUeHQucmVwbGFjZSgvXy9nLCAiICIpLCA3MDAwKTsKCQkJCX0pCgkJCQkuY2F0Y2goKGVycm9yKSA9PiB7CgkJCQkJY0xvZyhlcnJvcik7CgkJCQl9KTsKCQl9CgkJZWxzZSB7CgkJCW5vdGlmeSgiTm8gc2UgYWNlcHRhbiBjYXJhY3RlcmVzIGVzcGVjaWFsZXMsIGRlIDEgYSAxNiBjYXJhY3RlcmVzIHNvbGFtZW50ZS4iLCA1MDAwLCAiUkVEIik7CgkJfQoJfSwgIiIsIHsgd2lkdGg6ICIxMDAlIiB9KTsKCWNCdG4oY0VsLmlkLCAicm5kIiwgImNhbmNlbCIsICgpID0+IHsKCQljbG9zZURsZyhjRWwuaWQpOwoJfSwgIiIsIHsgd2lkdGg6ICIxMDAlIiB9KTsKfSk7CgpjQnRuKHBJZCwgImJ0bl9wcm9maWxlX2xpc3QiLCAicHJvZmlsZSBsaXN0IiwgKCkgPT4gewoJc2hvd0RsZygiZGxnX3Byb2ZfbGlzdCIpOwoKCXNCdG4oInByb2ZpbGVfbGlzdCIpCgkJLnRoZW4oKHJUeHQpID0+IHsKCQkJdHJ5IHsKCQkJCXZhciBySnNvbiA9IEpTT04ucGFyc2UoclR4dCk7CgoJCQkJaWYgKHJKc29uLmxlbmd0aCA9PSAwKSB7CgkJCQkJYnlJZCgidV9wcm9maWxlX2xpc3RkdiIpLmlubmVySFRNTCA9ICJubyBwcm9maWxlcyI7CgkJCQkJbm90aWZ5KCJ1c2VyIGhhcyBubyBwcm9maWxlcyIsIDcwMDApOwoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQl2YXIgdG9SZXQgPSAiIjsKCQkJCWZvciAoY29uc3Qga2V5IGluIHJKc29uKSB7CgkJCQkJaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHJKc29uLCBrZXkpKSB7CgkJCQkJCWNvbnN0IGVsZW1lbnQgPSBySnNvbltrZXldOwoJCQkJCQl0b1JldCArPSAiPC90cj4iOwoJCQkJCQl0b1JldCArPSAiPHRkPiIgKyBrZXkgKyAiPC90ZD4iOwoJCQkJCQl0b1JldCArPSAiPHRkPiIgKyBnVG1TdHIoZWxlbWVudFsidGltZXN0YW1wIl0sIDIpICsgIjwvdGQ+IjsKCQkJCQkJLyp0b190aWNrZXRzICs9ICI8dGQ+IiArIGVsZW1lbnRbInN0YXR1cyJdICsgIjwvdGQ+IjsqLwoJCQkJCQkvLyovCgkJCQkJCXRvUmV0ICs9ICI8dGQ+IjsKCQkJCQkJdG9SZXQgKz0gIjxidXR0b24gY2xhc3M9J25ld2J1dHRvbicgdGl0bGU9J2xvYWQgcHJvZmlsZScgc3R5bGU9J2hlaWdodDozMHB4O3dpZHRoOmF1dG87ZGlzcGxheTppbmxpbmUtYmxvY2s7JyBvbmNsaWNrPVwic0J0bignZ2V0X3Byb2ZpbGUnLCAnIiArIGtleSArICInKS50aGVuKGFzeW5jIChyVHh0KT0+IHsgbm90aWZ5KHJUeHQucmVwbGFjZSgvXy9nLCAnICcpLCA3MDAwKTthd2FpdCBsU2VydmVyKCk7ZkNvbWJvKCdhbGxfcHJvZmlsZXMnLCAnYWxsX3Byb2ZpbGVzJyk7fSkuY2F0Y2goIChlcnJvcik9PiB7Y0xvZyhlcnJvcik7fSk7XCI+PGkgY2xhc3M9J2ZhIGZhLXBsYXknIGFyaWEtaGlkZGVuPSd0cnVlJz48L2k+PC9idXR0b24+IjsKCQkJCQkJdG9SZXQgKz0gIjxidXR0b24gY2xhc3M9J25ld2J1dHRvbicgdGl0bGU9J3NhdmUvb3ZlcnJpZGUgcHJvZmlsZScgc3R5bGU9J21hcmdpbi1sZWZ0OjJweDtoZWlnaHQ6MzBweDt3aWR0aDphdXRvO2Rpc3BsYXk6aW5saW5lLWJsb2NrOycgb25jbGljaz1cImlmKCFjb25maXJtKCdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gb3ZlcnJpZGUgdGhpcyBjbG91ZCBwcm9maWxlIHdpdGggeW91ciBjdXJyZW50IHByb2ZpbGU/JykpIHJldHVybjsgc0J0bignc2F2ZV9wcm9maWxlJywgJyIgKyBrZXkgKyAiJykudGhlbihhc3luYyAgKHJUeHQpPT4geyBub3RpZnkoclR4dC5yZXBsYWNlKC9fL2csICcgJyksIDcwMDApO30pLmNhdGNoKCAoZXJyb3IpID0+e2NMb2coZXJyb3IpfSlcIj48aSBjbGFzcz0nZmEgZmEtZmxvcHB5LW8nIGFyaWEtaGlkZGVuPSd0cnVlJz48L2k+PC9idXR0b24+IjsKCQkJCQkJLyp0b190aWNrZXRzICs9ICI8YnV0dG9uIGNsYXNzPSduZXdidXR0b24nIHRpdGxlPSdjaGFuZ2Ugc3RhdHVzJyBzdHlsZT0nbWFyZ2luLWxlZnQ6MnB4O2hlaWdodDozMHB4O3dpZHRoOmF1dG87ZGlzcGxheTppbmxpbmUtYmxvY2s7JyBvbmNsaWNrPVwic0J0bignY3ByX3N0YXR1cycsICciICsga2V5ICsgIicpLnRoZW4oYXN5bmMgIChyVHh0KT0+IHsgbm90aWZ5KHJUeHQucmVwbGFjZSgvXy9nLCAnICcpLCA3MDAwKTt9KS5jYXRjaCggKGVycm9yKT0+IHtjTG9nKGVycm9yKTt9KTtcIj48aSBjbGFzcz0nZmEgZmEtZXllJyBhcmlhLWhpZGRlbj0ndHJ1ZSc+PC9pPjwvYnV0dG9uPiI7Ki8KCgkJCQkJCXRvUmV0ICs9ICI8L3RkPiI7CgkJCQkJCS8vKi8KCQkJCQkJdG9SZXQgKz0gIjwvdHI+IjsKCQkJCQl9CgkJCQl9CgoJCQkJYnlJZCgidV9wcm9maWxlX2xpc3QiKS5pbm5lckhUTUwgPSBgPGJyPgoJCQkJPHRyPgoJCQkJPHRoPjwvdGg+CgkJCQk8dGg+PC90aD4KCQkJCTx0aD48L3RoPgoJCQkJPC90cj4KCQkJCWA7CgoJCQkJYnlJZCgidV9wcm9maWxlX2xpc3QyIikuaW5uZXJIVE1MID0gYDxicj4KCQkJCTx0cj4KCQkJCTx0aD5uYW1lPC90aD4KCQkJCTx0aCBzdHlsZT0iY3Vyc29yOnBvaW50ZXI7IiBvbmNsaWNrPSJzb3J0VGFibGUoMSwgJ3VfcHJvZmlsZV9saXN0JykiPmxhc3Qgc2F2ZWQ8L3RoPgoJCQkJPCEtLTx0aD5zdGF0dXM8L3RoPi0tPgoJCQkJPHRoPm9wdGlvbnM8L3RoPgoJCQkJPC90cj4KCQkJCWA7CgkJCQlieUlkKCJ1X3Byb2ZpbGVfbGlzdCIpLmlubmVySFRNTCArPSB0b1JldDsKCQkJfSBjYXRjaCAoZXJyb3IpIHsKCQkJCWNMb2coZXJyb3IpOwoJCQkJaWYgKHJUeHQuaW5jbHVkZXMoIl8iKSkgewoJCQkJCW5vdGlmeShyVHh0LnJlcGxhY2UoL18vZywgIiAiKSwgNzAwMCk7CgkJCQkJcmV0dXJuOwoJCQkJfQoJCQl9CgkJfSkKCQkuY2F0Y2goKGVycm9yKSA9PiB7CgkJCWNMb2coZXJyb3IpOwoJCX0pOwp9LCAiTXVlc3RyYSB0dXMgcGVyZmlsZXMgY3JlYWRvcyIpOwoKY0RsZygnZWxlbWVudF9jb25maWcnLCAnZGxnX3Byb2ZfbGlzdCcsIHt9LCB7fSwgKGNFbCkgPT4gewoJY1RleHQoY0VsLmlkLCAicm5kIiwgIkNsb3VkIHByb2ZpbGVzLiIsIGNTdHlsZXMuZGxnVGl0bGVzKTsKCWNUeHRib3goY0VsLmlkLCAiZmluZF9wcl90Ymxpc3QiLCBmYWxzZSwgIiIsICIiLCB7fSwgewoJCXJlcXVpcmVkOiBmYWxzZSwKCQlwbGFjZWhvbGRlcjogInNlYXJjaCBwcm9maWxlIiwKCQlldmVudExpc3RlbmVyOiB7CgkJCWlucHV0OiAoKSA9PiB7CgkJCQlzZWFyY2hUYWJsZSgnZmluZF9wcl90Ymxpc3QnLCAndV9wcm9maWxlX2xpc3QnKTsKCQkJfQoJCX0KCX0sIHRydWUpOwoKCWNUYWJsZShjRWwuaWQsICJ1X3Byb2ZpbGVfbGlzdDIiLCAiIiwgeyBjb2xvcjogIndoaXRlIiwgd2lkdGg6ICIxMDAlIiB9KTsKCWNEaXYoY0VsLmlkLCAidV9wcm9maWxlX2xpc3RkdiIsIHsgbWF4SGVpZ2h0OiAiMzUwcHgiLCBvdmVyZmxvdzogImF1dG8iIH0sIHt9LCAoY0VsMikgPT4gewoKCQljVGFibGUoY0VsMi5pZCwgInVfcHJvZmlsZV9saXN0IiwgIiIsIHsgY29sb3I6ICJ3aGl0ZSIsIHdpZHRoOiAiMTAwJSIgfSk7Cgl9KTsKCgljQnRuKGNFbC5pZCwgInJuZCIsICJjbG9zZSIsICgpID0+IHsKCQljbG9zZURsZyhjRWwuaWQpOwoJfSwgIiIsIHsgd2lkdGg6ICIxMDAlIiB9KTsKfSk7CgpjSHIoKTsKCmNUZXh0KHBJZCwgInJuZCIsICImIzk2Nzk7IGxvY2FsIHByb2ZpbGVzIiwgewoJc3Q6IGNTdHlsZXMuc3VidGl0bGVzLAoJZm46IChjRWwpID0+IHsKCQljVG9vbHRpcChjRWwuaWQsICJwZXJmaWxlcyBsb2NhbGVzLCBzZSBndWFyZGFuIGVuIGxhIGNmZyBsb2NhbCwgc2UgcHVlZGVuIGJvcnJhci9wZXJkZXIgZW4gY2FzbyBkZSBsaW1waWFyIFRFTVAuIik7CgkJY0JyKCk7Cgl9Cn0pOwoKY0NvbWJvQm94KHBJZCwgImFsbF9wcm9maWxlcyIsICJwcm9maWxlIiwgMCwgMjAsIGZhbHNlLCAiIiwgYXN5bmMgKGNFbCkgPT4gewoJYXdhaXQgbFNlcnZlcigpOwp9LCB7IG1pbldpZHRoOiAiMTgwcHgiIH0pOwoKY1R4dGJveChwSWQsICJwcm9maWxlX25hbWVfYyIsIGZhbHNlLCAiIiwgIjQtOSBjaGFyYWN0ZXJzLiIsIHsgbWFyZ2luTGVmdDogIjVweCIsIHdpZHRoOiAiMTUwcHgiIH0sIHsKCXBhdHRlcm46ICJeW2EtekEtWjAtOV0qJCIsCgltaW5MZW5ndGg6IDMsCgltYXhMZW5ndGg6IDksCglyZXF1aXJlZDogZmFsc2UsCn0sIHRydWUpOwoKY0J0bihwSWQsICJidG5fcHJvZmlsZV9jaGFuZ2UiLCAiY2hhbmdlIG5hbWUiLCBhc3luYyAoKSA9PiB7CglpZiAoY1R4dFZhbGlkKCdwcm9maWxlX25hbWVfYycpKSB7CgkJdmFyIHByb2ZfdmFsdWUgPSBieUlkKCJwcm9maWxlX25hbWVfYyIpLnZhbHVlOwoJCXNJbmZvKCJwcm9maWxlX25hbWUiLCBwcm9mX3ZhbHVlKTsKCQlieUlkKCJwcm9maWxlX25hbWVfYyIpLnZhbHVlID0gIiI7CgkJYXdhaXQgbFNlcnZlcigpOwoJCWZDb21ibygiYWxsX3Byb2ZpbGVzIiwgImFsbF9wcm9maWxlcyIpOwoJfQoJZWxzZSB7CgkJbm90aWZ5KCJObyBzZSBhY2VwdGFuIGVzcGFjaW9zIG8gY2FyYWN0ZXJlcyBlc3BlY2lhbGVzLCB7My05IGNoYXJzfS4iLCA1MDAwLCAiUkVEIik7Cgl9Cn0sICJDYW1iaWEgZWwgbm9tYnJlIGRlbCBwcm9maWxlIiwgeyBtYXJnaW5SaWdodDogIjEwcHgiIH0pOwoKY0J0bihwSWQsICJidG5fcHJvZmlsZV9leHBvcnQiLCAiZXhwb3J0IHByb2ZpbGUiLCAoKSA9PiB7CglzaG93RGxnKCJjb25maXJtX2V4cF9wciIpOwp9LCAiRXhwb3J0YSBlbCBwZXJmaWwgYWN0dWFsIGFsIENMSVBCT0FSRC4iLCB7IG1hcmdpblJpZ2h0OiAiMTBweCIgfSk7CgpjRGxnKCdlbGVtZW50X2NvbmZpZycsICdjb25maXJtX2V4cF9wcicsIHt9LCB7fSwgKGNFbCkgPT4gewoJY1RleHQoY0VsLmlkLCAicm5kIiwgIllvdSBhcmUgYWJvdXQgdG8gPHU+RVhQT1JUPC91PiB5b3VyIGN1cnJlbnQgcHJvZmlsZS4iLCBjU3R5bGVzLmRsZ1RpdGxlcyk7CgljQnRuKGNFbC5pZCwgInJuZCIsICJDT05GSVJNIiwgYXN5bmMgKCkgPT4gewoJCXNCdG4oImV4cG9ydF9wcm9maWxlIik7CgkJY2xvc2VEbGcoY0VsLmlkKTsKCX0sICIiLCB7IHdpZHRoOiAiMTAwJSIsIGZvbnRXZWlnaHQ6ICJib2xkIiB9KTsKCgljQnRuKGNFbC5pZCwgInJuZCIsICJjYW5jZWwiLCAoKSA9PiB7CgkJY2xvc2VEbGcoY0VsLmlkKTsKCX0sICIiLCB7IHdpZHRoOiAiMTAwJSIgfSk7Cn0pOwoKY0J0bihwSWQsICJybmQiLCAiaW1wb3J0IHByb2ZpbGUiLCBhc3luYyAoKSA9PiB7CglzaG93RGxnKCJjb25maXJtX2ltcF9wciIpOwp9KTsKCmNEbGcoJ2VsZW1lbnRfY29uZmlnJywgJ2NvbmZpcm1faW1wX3ByJywge30sIHt9LCAoY0VsKSA9PiB7CgljVGV4dChjRWwuaWQsICJybmQiLCAiWW91IGFyZSBhYm91dCB0byBpbXBvcnQgYW4gPHU+VU5LTk9XTiBQUk9GSUxFPC91Pjxicj5UaGlzIHdpbGwgPHU+b3ZlcnJpZGU8L3U+IHlvdXIgY3VycmVudCBwcm9maWxlLiIsIGNTdHlsZXMuZGxnVGl0bGVzKTsKCWNCdG4oY0VsLmlkLCAicm5kIiwgIkNPTkZJUk0iLCBhc3luYyAoKSA9PiB7CgkJc0J0bigiaW1wb3J0X3Byb2ZpbGUiKTsKCQlhd2FpdCBsU2VydmVyKCk7CgkJZkNvbWJvKCdhbGxfcHJvZmlsZXMnLCAnYWxsX3Byb2ZpbGVzJyk7CgkJY2xvc2VEbGcoY0VsLmlkKTsKCX0sICIiLCB7IHdpZHRoOiAiMTAwJSIsIGZvbnRXZWlnaHQ6ICJib2xkIiB9KTsKCgljQnRuKGNFbC5pZCwgInJuZCIsICJjYW5jZWwiLCAoKSA9PiB7CgkJY2xvc2VEbGcoY0VsLmlkKTsKCX0sICIiLCB7IHdpZHRoOiAiMTAwJSIgfSk7Cn0pOwoKY0J0bihwSWQsICJybmQiLCAic2V0IGRlZmF1bHQiLCAoKSA9PiB7CglzaG93RGxnKCJjZnJfc2V0ZGVmYXVsdCIpOwp9LCAiRGV2dWVsdmUgZWwgcGVyZmlsIGEgdmFsb3JlcyBkZWZhdWx0LCB0YW1iaWVuIGVsIG5vbWJyZS4iKTsKCmNEbGcocElkLCAnY2ZyX3NldGRlZmF1bHQnLCB7fSwge30sIChjRWwpID0+IHsKCWNUZXh0KGNFbC5pZCwgInJuZCIsICJZb3UgYXJlIGFib3V0IHRvIHNldCB0aGUgY3VycmVudDxicj5wcm9maWxlIHRvIGRlZmF1bHQgVkFMVUVTIiwgY1N0eWxlcy5kbGdUaXRsZXMpOwoJY0J0bihjRWwuaWQsICJybmQiLCAiQ09ORklSTSIsIGFzeW5jICgpID0+IHsKCQlzQnRuKCdkZWZhdWx0X3Byb2ZpbGUnKTsKCQlhd2FpdCBsU2VydmVyKCk7CgkJZkNvbWJvKCJhbGxfcHJvZmlsZXMiLCAiYWxsX3Byb2ZpbGVzIik7CgkJY2xvc2VEbGcoY0VsLmlkKTsKCX0sICIiLCB7IHdpZHRoOiAiMTAwJSIsIGZvbnRXZWlnaHQ6ICJib2xkIiB9KTsKCgljQnRuKGNFbC5pZCwgInJuZCIsICJjYW5jZWwiLCAoKSA9PiB7CgkJY2xvc2VEbGcoY0VsLmlkKTsKCX0sICIiLCB7IHdpZHRoOiAiMTAwJSIgfSk7Cn0pOwoKY0hyKCk7CgpjVGV4dChwSWQsICJybmQiLCAiJiM5Njc5OyBsb2NhbCBjb25maWciLCB7CglzdDogY1N0eWxlcy5zdWJ0aXRsZXMsIGZuOiAoY0VsKSA9PiB7CgkJY1Rvb2x0aXAoY0VsLmlkLCAiY29uZmlnIGxvY2FsIHF1ZSBjb250aWVuZSB0b2RvcyBsb3MgcGVyZmlsZXMgY3JlYWRvcywgc2UgcHVlZGVuIGJvcnJhci9wZXJkZXIgZW4gY2FzbyBkZSBsaW1waWFyIFRFTVAuIik7CgkJY0JyKCk7Cgl9Cn0pOwoKY0RsZygnZWxlbWVudF9jb25maWcnLCAnY29uZmlybV9sb2FkY2ZnJywge30sIHt9LCAoY0VsKSA9PiB7CgljVGV4dChjRWwuaWQsICJybmQiLCAiWW91IGFyZSBhYm91dCB0byBsb2FkIHlvdXIgPHU+bG9jYWw8L3U+IENGRyIsIGNTdHlsZXMuZGxnVGl0bGVzKTsKCWNCdG4oY0VsLmlkLCAicm5kIiwgIkNPTkZJUk0iLCBhc3luYyAoKSA9PiB7CgkJc0J0bignbG9hZF9jJyk7CgkJYXdhaXQgbFNlcnZlcigpOwoJCWZDb21ibygnYWxsX3Byb2ZpbGVzJywgJ2FsbF9wcm9maWxlcycpOwoJCWNsb3NlRGxnKGNFbC5pZCk7Cgl9LCAiIiwgeyB3aWR0aDogIjEwMCUiLCBmb250V2VpZ2h0OiAiYm9sZCIgfSk7CgoJY0J0bihjRWwuaWQsICJybmQiLCAiY2FuY2VsIiwgKCkgPT4gewoJCWNsb3NlRGxnKGNFbC5pZCk7Cgl9LCAiIiwgeyB3aWR0aDogIjEwMCUiIH0pOwp9KTsKCmNEbGcoJ2VsZW1lbnRfY29uZmlnJywgJ2NvbmZpcm1fc2F2ZWNmZycsIHt9LCB7fSwgKGNFbCkgPT4gewoJY1RleHQoY0VsLmlkLCAicm5kIiwgIllvdSBhcmUgYWJvdXQgdG8gc2F2ZSB5b3VyIGxvY2FsIENGRyIsIGNTdHlsZXMuZGxnVGl0bGVzKTsKCgljQnRuKGNFbC5pZCwgInJuZCIsICJDT05GSVJNIiwgKCkgPT4gewoJCXNCdG4oJ3NhdmVfYycpOwoJCWNsb3NlRGxnKGNFbC5pZCk7Cgl9LCAiIiwgeyB3aWR0aDogIjEwMCUiLCBmb250V2VpZ2h0OiAiYm9sZCIgfSk7CgoJY0J0bihjRWwuaWQsICJybmQiLCAiY2FuY2VsIiwgKCkgPT4gewoJCWNsb3NlRGxnKGNFbC5pZCk7Cgl9LCAiIiwgeyB3aWR0aDogIjEwMCUiIH0pOwp9KTsKCmNEbGcoJ2VsZW1lbnRfY29uZmlnJywgJ2NvbmZpcm1faW1wb3J0Y2ZnJywge30sIHt9LCAoY0VsKSA9PiB7CgljVGV4dChjRWwuaWQsICJybmQiLCAiWW91IGFyZSBhYm91dCB0byBJTVBPUlQgYW5vdGhlciBDRkciLCBjU3R5bGVzLmRsZ1RpdGxlcyk7CgljQnRuKGNFbC5pZCwgInJuZCIsICJDT05GSVJNIiwgKCkgPT4gewoJCXNCdG4oJ2ltcG9ydF9jJyk7CgkJY2xvc2VEbGcoY0VsLmlkKTsKCX0sICIiLCB7IHdpZHRoOiAiMTAwJSIsIGZvbnRXZWlnaHQ6ICJib2xkIiB9KTsKCgljQnRuKGNFbC5pZCwgInJuZCIsICJjYW5jZWwiLCAoKSA9PiB7CgkJY2xvc2VEbGcoY0VsLmlkKTsKCX0sICIiLCB7IHdpZHRoOiAiMTAwJSIgfSk7Cn0pOwoKY0RsZygnZWxlbWVudF9jb25maWcnLCAnY29uZmlybV9leHBvcnRjZmcnLCB7fSwge30sIChjRWwpID0+IHsKCWNUZXh0KGNFbC5pZCwgInJuZCIsICJZb3UgYXJlIGFib3V0IHRvIEVYUE9SVCB0aGUgZW50aXJlIGxvY2FsIENGRyw8YnI+IHdoaWNoIGluY2x1ZGUgYWxsIHlvdXIgcHJvZmlsZXMiLCBjU3R5bGVzLmRsZ1RpdGxlcyk7CgljQnRuKGNFbC5pZCwgInJuZCIsICJDT05GSVJNIiwgKCkgPT4gewoJCXNCdG4oJ2V4cG9ydF9jJyk7CgkJY2xvc2VEbGcoY0VsLmlkKTsKCX0sICIiLCB7IHdpZHRoOiAiMTAwJSIsIGZvbnRXZWlnaHQ6ICJib2xkIiB9KTsKCgljQnRuKGNFbC5pZCwgInJuZCIsICJjYW5jZWwiLCAoKSA9PiB7CgkJY2xvc2VEbGcoY0VsLmlkKTsKCX0sICIiLCB7IHdpZHRoOiAiMTAwJSIgfSk7Cn0pOwoKY0RsZygnZWxlbWVudF9jb25maWcnLCAnY29uZmlybV9leGl0Jywge30sIHt9LCAoY0VsKSA9PiB7CgljVGV4dChjRWwuaWQsICJybmQiLCAiWW91IGFyZSBhYm91dCB0byBleGl0IiwgY1N0eWxlcy5kbGdUaXRsZXMpOwoJY0J0bihjRWwuaWQsICJybmQiLCAiQ09ORklSTSIsICgpID0+IHsKCQljRXhpdCgpOwoJCWNsb3NlRGxnKGNFbC5pZCk7Cgl9LCAiIiwgeyB3aWR0aDogIjEwMCUiLCBmb250V2VpZ2h0OiAiYm9sZCIgfSk7CgoJY0J0bihjRWwuaWQsICJybmQiLCAiY2FuY2VsIiwgKCkgPT4gewoJCWNsb3NlRGxnKGNFbC5pZCk7Cgl9LCAiIiwgeyB3aWR0aDogIjEwMCUiIH0pOwp9KTsKCnBJZCA9ICJwYW5lbF90aWNrZXRzIjsKCmNUZXh0KHBJZCwgInRpY2tldGNlbnRlciIsICJUaWNrZXQgQ2VudGVyIiwgewoJc3Q6IHsKCQl0ZXh0QWxpZ246ICdjZW50ZXInLAoJCXRleHREZWNvcmF0aW9uOiAndW5kZXJsaW5lJywKCQlmb250U2l6ZTogJzE4cHgnLAoJCW1hcmdpbkJvdHRvbTogJzEwcHgnLAoJCW1hcmdpblRvcDogIjBweCIsCgl9Cn0pOwoKdmFyIHN0VGlja2V0c0ZhcSA9IHsKCXRleHRBbGlnbjogJ2NlbnRlcicsCglmb250U2l6ZTogJzE0cHgnLAoJbWFyZ2luQm90dG9tOiAnMTBweCcsCn0KCmNUZXh0KHBJZCwgInJuZCIsICItIERvIG5vdCBzcGFtIHRoZSB0aWNrZXQgc3lzdGVtLjxicj4tIE9ubHkgY3JlYXRlIHRpY2tldHMgaWYgeW91IGhhdmUgYW4gaXNzdWUuPGJyPi0gT25seSBjcmVhdGUgdGlja2V0cyBpZiB5b3UgaGF2ZSBhIGZlYXR1cmUgcmVxdWVzdC48YnI+IiwgeyBzdDogc3RUaWNrZXRzRmFxIH0pOwpjVGV4dChwSWQsICJybmQiLCAiLSBPbmx5IGNyZWF0ZSB0aWNrZXRzIGlmIHlvdSBuZWVkIDx1PmhlbHA8L3U+Ljxicj4tIEFsbCB0aWNrZXRzIGFyZSA8dT5wcml2YXRlPC91Pi48YnI+LSBEbyBub3QgcG9zdCBpcnJlbGV2YW50IGNvbW1lbnRzIGluIHRpY2tldHMgb3IgeW91IG1heSBiZSA8dT5iYW5uZWQ8L3U+LiIsIHsgc3Q6IHN0VGlja2V0c0ZhcSB9KTsKCmNDb21ib0JveDIocElkLCAidGlja2V0X2JlaGF2aW9yIiwgWyJCdWciLCAiRmVhdHVyZSIsICJPdGhlciJdLCB0cnVlLCAiU2VsZWNjaW9uYSB1bmEgcmF6b24gZGVsIHRpY2tldC4iKTsKCmNUZXh0QXJlYShwSWQsICJ0aWNrZXRfY29udGVudCIsIHRydWUsICIiLCB7CgloZWlnaHQ6ICcxMDBweCcsCglyZXNpemU6ICdub25lJywKCW92ZXJmbG93OiAnaGlkZGVuJywKCXdoaXRlU3BhY2U6ICdwcmUtd3JhcCcsCgltYXJnaW5Ub3A6ICI1cHgiLAp9LCB7CglwYXR0ZXJuOiAiXlthLXpBLVowLTkgXSokezV9IiwKCW1pbkxlbmd0aDogNSwKCW1heExlbmd0aDogMjU2LAoJcGxhY2Vob2xkZXI6ICJpbmZvIiwKCXJlcXVpcmVkOiB0cnVlLAp9KTsKCnZhciBzaG93X3RpY2tldF9jID0gZmFsc2U7CmNCdG4ocElkLCAicm5kIiwgImNyZWF0ZSB0aWNrZXQiLCAoKSA9PiB7CglpZiAoIXNob3dfdGlja2V0X2MpIHsKCQlieUlkKCJ0aWNrZXRfY29udGVudCIpLnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lLWJsb2NrIjsKCQlieUlkKCJ0aWNrZXRfYmVoYXZpb3IiKS5zdHlsZS5kaXNwbGF5ID0gImlubGluZS1ibG9jayI7CgkJc2hvd190aWNrZXRfYyA9IHRydWU7CgkJcmV0dXJuOwoJfQoKCWlmIChjVHh0VmFsaWQoJ3RpY2tldF9jb250ZW50JykpIHsKCQl2YXIgdGlja2V0X2luZm8gPSBieUlkKCJ0aWNrZXRfY29udGVudCIpLnZhbHVlOwoJCXZhciB0aWNrZXRfcmVhc29uID0gYnlJZCgidGlja2V0X2JlaGF2aW9yIikudmFsdWU7CgoJCXNCdG4oImNyZWF0ZV90aWNrZXQiLCB0aWNrZXRfcmVhc29uICsgIi0iICsgdGlja2V0X2luZm8pCgkJCS50aGVuKChyVHh0KSA9PiB7CgkJCQlub3RpZnkoclR4dC5yZXBsYWNlKC9fL2csICIgIiksIDcwMDApOwoJCQl9KQoJCQkuY2F0Y2goKGVycm9yKSA9PiB7CgkJCQljTG9nKGVycm9yKTsKCQkJfSk7Cgl9CgllbHNlIHsKCQlub3RpZnkoIk5vIHNlIGFjZXB0YW4gY2FyYWN0ZXJlcyBlc3BlY2lhbGVzLCBkZSA1IGEgMjU2IGNhcmFjdGVyZXMgc29sYW1lbnRlLiIsIDUwMDAsICJSRUQiKTsKCX0KfSwgIkNyZWEgdW4gdGlja2V0IGVsIGN1YWwgc2VyYSBhdGVuZGlkby92aXN0byBwb3IgbG9zIGFkbWluaXN0cmFkb3Jlcy4iKTsKCmNIcihwSWQsIGZhbHNlLCB7IHdpZHRoOiAiMjAwcHgiIH0pOwpjQnRuKHBJZCwgInJuZCIsICJ2aWV3IHRpY2tldHMiLCAoKSA9PiB7CglpZiAoc2hvd190aWNrZXRfYykgewoJCWJ5SWQoInRpY2tldF9jb250ZW50Iikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKCQlieUlkKCJ0aWNrZXRfYmVoYXZpb3IiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwoJCXNob3dfdGlja2V0X2MgPSBmYWxzZTsKCX0KCglzQnRuKCJnZXRfdGlja2V0cyIpCgkJLnRoZW4oKHJUeHQpID0+IHsKCQkJaWYgKHJUeHQuc3BsaXQoIl8iKS5sZW5ndGggLSAxID4gMikgewoJCQkJbm90aWZ5KHJUeHQucmVwbGFjZSgvXy9nLCAiICIpLCA3MDAwKTsKCQkJCXJldHVybjsKCQkJfQoKCQkJdmFyIHJlc0pzb24gPSBKU09OLnBhcnNlKHJUeHQpOwoKCQkJaWYgKHJlc0pzb24ubGVuZ3RoID09IDApIHsKCQkJCWJ5SWQoInVzZXJfdGlja2V0cyIpLmlubmVySFRNTCA9ICJubyB0aWNrZXRzIjsKCQkJCW5vdGlmeSgidXNlciBoYXMgbm8gdGlja2V0cyIsIDcwMDApOwoJCQkJcmV0dXJuOwoJCQl9CgoJCQlieUlkKCJ1c2VyX3RpY2tldHMiKS5pbm5lckhUTUwgPSAibm8gdGlja2V0cyI7CgoJCQl2YXIgdG9UaWNrZXRzID0gIiI7CgkJCWZvciAoY29uc3Qga2V5IGluIHJlc0pzb24pIHsKCQkJCWlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChyZXNKc29uLCBrZXkpKSB7CgkJCQkJY29uc3QgZWxlbWVudCA9IHJlc0pzb25ba2V5XTsKCQkJCQl0b1RpY2tldHMgKz0gIjxzdHJvbmc+PHU+IiArIGVsZW1lbnRbInJlYXNvbiJdICsgIiBbIiArIGVsZW1lbnRbImlkIl0gKyAiXTwvdT4gfCA8YnV0dG9uIGNsYXNzPSduZXdidXR0b24nIGRhdGEtdHRpcD0nRGVsZXRlIHRpY2tldCcgc3R5bGU9J2hlaWdodDozMHB4O3dpZHRoOmF1dG87ZGlzcGxheTppbmxpbmUtYmxvY2s7Y29sb3I6cmVkOycgb25jbGljaz1cInNCdG4oJ2RlbGV0ZV90aWNrZXQnLCAnIiArIGVsZW1lbnRbImlkIl0gKyAiJykudGhlbiggKHJUeHQpID0+eyBub3RpZnkoclR4dC5yZXBsYWNlKC9fL2csICcgJyksIDcwMDApO30pLmNhdGNoKCAoZXJyb3IpID0+e2NMb2coZXJyb3IpO30pO1wiPiZ0aW1lczs8L2J1dHRvbj48L3N0cm9uZz48YnI+IjsKCQkJCQl0b1RpY2tldHMgKz0gIjxwPiIgKyBlbGVtZW50WyJjb250ZW50Il0gKyAiPC9wPiI7CgkJCQkJdG9UaWNrZXRzICs9ICI8YnI+PGJyPiI7CgkJCQl9CgkJCX0KCgkJCWJ5SWQoInVzZXJfdGlja2V0cyIpLmlubmVySFRNTCA9IHRvVGlja2V0czsKCQl9KQoJCS5jYXRjaCgoZXJyb3IpID0+IHsKCQkJY0xvZyhlcnJvcik7CgkJfSk7Cn0sICJNdWVzdHJhIHR1cyB0aWNrZXRzIGNyZWFkb3MiKTsKCmNUZXh0KHBJZCwgInVzZXJfdGlja2V0cyIsICIiLCB7IHN0OiB7IHRleHRBbGlnbjogImNlbnRlciIgfSB9KTsKCmNCcihwSWQpOwoKcElkID0gInBhbmVsX3Byb2ZpbGVzIjsKCmNUZXh0KHBJZCwgInJuZCIsICJQcm9maWxlIiwgewoJc3Q6IHsKCQl0ZXh0QWxpZ246ICdjZW50ZXInLAoJCWZvbnRXZWlnaHQ6ICdib2xkJywKCQl0ZXh0RGVjb3JhdGlvbjogJ3VuZGVybGluZScsCgkJZm9udFNpemU6ICcyMHB4JywKCQltYXJnaW5Cb3R0b206ICcxMHB4JywKCQltYXJnaW5Ub3A6ICcwcHgnCgl9Cn0pOwoKY0RpdihwSWQsICJ1c2VyaW5mbyIsIHsKCWRpc3BsYXk6ICJpbmxpbmUtZ3JpZCIsCglncmlkVGVtcGxhdGVDb2x1bW5zOiAicmVwZWF0KDMsIDFmcikiLAoJZ3JpZEdhcDogIjEwcHgiCn0pOwoKY0xvYWRpbmcocElkLCAibG9hZGluZ2F2YXRhciIsIHsgcG9zaXRpb246ICJyZWxhdGl2ZSIsIGRpc3BsYXk6ICJibG9jayIsIGxlZnQ6ICI0OHB4IiwgdG9wOiAiLTU5cHgiLCB9KTsKCnBJZCA9ICJ1c2VyaW5mbyI7CmNJbWcocElkLCAidXNlcl9hdmF0YXIiLCBkQXZhdGFyLCA5MCwgOTAsCgl7CgkJanVzdGlmeVNlbGY6ICJzdGFydCIsCgkJbWFyZ2luTGVmdDogIjEwcHgiLAoJCW9iamVjdEZpdDogImNvdmVyIiwKCQlib3JkZXJSYWRpdXM6ICI1cHgiCgl9KTsKCmNUZXh0KHBJZCwgInVzZXJfaW5mbyIsICJub25lIiwgeyBzdDogeyBkaXNwbGF5OiAiZ3JpZCIsIGdyaWRUZW1wbGF0ZUNvbHVtbnM6ICIxNjBweCIsIG1hcmdpblRvcDogIjBweCIgfSB9KTsKCmZ1bmN0aW9uIG93bkluZm8oKSB7CgoJem5HZXQoImdldF91c2VyX2luZm8iLCAieiIpCgkJLnRoZW4oKHJUeHQpID0+IHsKCQkJbGV0IHVJbmYgPSBKU09OLnBhcnNlKHJUeHQpOwoKCQkJaWYgKHVJbmZbImF2YXRhciJdKSB7CgkJCQlieUlkKCJ1c2VyX2F2YXRhciIpLnNyYyA9IHdpbmRvdy5hdG9iKHVJbmZbImF2YXRhciJdKTsKCQkJCWJ5SWQoImF2dHJfcHJldmlldyIpLnNyYyA9IHdpbmRvdy5hdG9iKHVJbmZbImF2YXRhciJdKTsKCQkJfQoKCQkJdmFyIHVEYXRhID0gIiI7CgkJCXVEYXRhICs9ICI8cCBzdHlsZT0nbWFyZ2luLXRvcDowcHg7bWFyZ2luLWJvdHRvbTowcHg7Jz48c3Ryb25nPkAiICsgdUluZlsiYWxpYXMiXTsKCgkJCWlmICghdUluZlsiYWxpYXMiXS5pbmNsdWRlcygiWlVzZXIiKSkKCQkJCWhBbGlhcyA9IHRydWU7CgoJCQlpZiAodUluZlsicm9sZSJdKQoJCQkJdURhdGEgKz0gIjxzcGFuIHN0eWxlPSdkaXNwbGF5OmlubGluZTtmb250LXNpemU6MTBweDtjb2xvcjoiICsgcm9sZWNsclt1SW5mWyJyb2xlIl0udG9Mb3dlckNhc2UoKV0gKyAiOyc+ICgiICsgdUluZlsicm9sZSJdICsgIik8L3NwYW4+PGJyPjwvc3Ryb25nPjwvcD4iOwoKCQkJaWYgKHVJbmZbInVzZXJfaWQiXSkKCQkJCXVEYXRhICs9ICI8cCBzdHlsZT0nZm9udC1zaXplOjEwcHg7bWFyZ2luLXRvcDowcHg7Jz51aWQ6ICIgKyB1SW5mWyJ1c2VyX2lkIl07CgkJCWVsc2UKCQkJCXVEYXRhICs9ICI8cCBzdHlsZT0nZm9udC1zaXplOjEwcHg7bWFyZ2luLXRvcDowcHg7Jz51aWQ6IE5PIjsKCgkJCWlmICh1SW5mWyJyZWdpc3Rlcl90aW1lIl0pCgkJCQl1RGF0YSArPSAiIC0gam9pbmVkOiAiICsgZ1RtU3RyKHVJbmZbInJlZ2lzdGVyX3RpbWUiXSwgMCkgKyAiPC9wPiI7CgkJCWVsc2UKCQkJCXVEYXRhICs9ICI8L3A+IjsKCgkJCWlmICh1SW5mWyJkZXNjcmlwdGlvbiJdKQoJCQkJdURhdGEgKz0gIjxwIHN0eWxlPSdmb250LXNpemU6MTJweDttYXJnaW4tdG9wOiAwcHg7Jz5pbmZvOiAiICsgd2luZG93LmF0b2IodUluZlsiZGVzY3JpcHRpb24iXSkgKyAiPC9wPiI7CgkJCWVsc2UKCQkJCXVEYXRhICs9ICI8cD48L3A+IgoKCQkJYnlJZCgidXNlcl9pbmZvIikuaW5uZXJIVE1MID0gdURhdGE7CgoJCQlzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsKCQkJCWJ5SWQoImxvYWRpbmdhdmF0YXIiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwoJCQl9LCAxMjUwKTsKCQl9KQoJCS5jYXRjaCgoZXJyb3IpID0+IHsKCQkJY0xvZyhlcnJvcik7CgkJfSk7Cn0KCm93bkluZm8oKTsKCnBJZCA9ICJwYW5lbF9wcm9maWxlcyI7CmNIcihwSWQsIGZhbHNlLCB7IHdpZHRoOiAiMjAwcHgiIH0pOwoKY0J0bihwSWQsICJybmQiLCAiY3JlYXRlIHBhc3N3b3JkIiwgKCkgPT4gewoJc2hvd0RsZygicGFzc3dvcmRfZGxnIik7Cn0sICJQZXJtaXRlIGNyZWFyIHVuYSBwYXNzd29yZCB1bmljYSBwYXJhIHR1IHVzdWFyaW8sIHRlIHNlcnZpcmEgcGFyYSBsb2d1ZWFydGUgZW4gbGEgcGFnaW5hIHdlYi4iLCB7IGp1c3RpZnlTZWxmOiAiY2VudGVyIiB9KTsKCmNEbGcocElkLCAicGFzc3dvcmRfZGxnIiwge30sIHt9LCAoY0VsKSA9PiB7CgljVGV4dChjRWwuaWQsICJybmQiLCAiQ3JlYXRlIFBhc3N3b3JkIiwgY1N0eWxlcy5kbGdUaXRsZXMpOwoKCWNUeHRib3goY0VsLmlkLCAicGZfcGFzc3dvcmRfdGV4dGJveCIsIGZhbHNlLCAiIiwgIiIsIHsKCQltYXJnaW5Ub3A6ICI1cHgiLAoJfSwgewoJCXBhdHRlcm46ICJeW2EtekEtWjAtOV0qJCIsCgkJbWluTGVuZ3RoOiA0LAoJCW1heExlbmd0aDogMjAsCgkJcmVxdWlyZWQ6IHRydWUsCgl9KTsKCgljQnIoY0VsLmlkKTsKCgljQnRuKGNFbC5pZCwgInJuZCIsICJjcmVhdGUiLCAoKSA9PiB7CgkJY29uc3QgaXRlbUVsZW0gPSBieUlkKCJwZl9wYXNzd29yZF90ZXh0Ym94Iik7CgoJCWlmIChjVHh0VmFsaWQoaXRlbUVsZW0uaWQpKSB7CgkJCWxldCB2YWwgPSBpdGVtRWxlbS52YWx1ZTsKCQkJc0J0bigiY3JlYXRlX3Bhc3N3b3JkIiwgdmFsKQoJCQkJLnRoZW4oKHJUeHQpID0+IHsKCQkJCQlub3RpZnkoclR4dC5yZXBsYWNlKC9fL2csICIgIiksIDcwMDApOwoKCQkJCQlpZiAoclR4dC5pbmNsdWRlcygiY3JlYXRlZCIpKSB7CgkJCQkJCWNsb3NlRGxnKGNFbC5pZCk7CgkJCQkJfQoJCQkJfSkKCQkJCS5jYXRjaCgoZXJyb3IpID0+IHsKCQkJCQljTG9nKGVycm9yKTsKCQkJCX0pOwoJCX0KCQllbHNlIHsKCQkJbm90aWZ5KGl0ZW1FbGVtLm1pbkxlbmd0aCArICIgYSAiICsgaXRlbUVsZW0ubWF4TGVuZ3RoICsgIiBjYXJhY3RlcmVzLiBTaW4gY2FyYWN0ZXJlcy9zaW1ib2xvcyBlc3BlY2lhbGVzLiIsIDUwMDAsICJSRUQiKTsKCQl9Cgl9LCAiIiwgeyB3aWR0aDogIjEwMCUiIH0pOwoKCWNCcihjRWwuaWQpOwoKCWNCdG4oY0VsLmlkLCAicm5kIiwgImNhbmNlbCIsICgpID0+IHsKCQljbG9zZURsZyhjRWwuaWQpOwoJfSwgIiIsIHsgd2lkdGg6ICIxMDAlIiB9KTsKfSk7CgpjQnRuKHBJZCwgInJuZCIsICJjaGFuZ2UgYWxpYXMiLCAoKSA9PiB7CglzaG93RGxnKCJhbGlhc19kbGciKTsKfSwgIlBlcm1pdGUgY2FtYmlhciBlbCBhbGlhcyAxIHZleiBjYWRhIDMwIGRpYXMuIiwgeyBqdXN0aWZ5U2VsZjogImNlbnRlciIgfSk7CgpjRGxnKHBJZCwgImFsaWFzX2RsZyIsIHt9LCB7fSwgKGNFbCkgPT4gewoJY1RleHQoY0VsLmlkLCAicm5kIiwgIkNoYW5nZSBhbGlhcyIsIGNTdHlsZXMuZGxnVGl0bGVzKTsKCgljVHh0Ym94KGNFbC5pZCwgInBmX2FsaWFzX3RleHRib3giLCBmYWxzZSwgIiIsICIiLCB7CgkJbWFyZ2luVG9wOiAiNXB4IiwKCX0sIHsKCQlwYXR0ZXJuOiAiXlthLXpBLVowLTldKiQiLAoJCW1pbkxlbmd0aDogMywKCQltYXhMZW5ndGg6IDIwLAoJCXJlcXVpcmVkOiB0cnVlLAoJfSk7CgoJY0JyKGNFbC5pZCk7CgoJY0J0bihjRWwuaWQsICJybmQiLCAiY2hhbmdlIiwgKCkgPT4gewoJCWNvbnN0IGl0ZW1FbGVtID0gYnlJZCgicGZfYWxpYXNfdGV4dGJveCIpOwoKCQlpZiAoY1R4dFZhbGlkKGl0ZW1FbGVtLmlkKSkgewoJCQlsZXQgdmFsID0gaXRlbUVsZW0udmFsdWU7CgkJCXNCdG4oImNoYW5nZV9hbGlhcyIsIHZhbCkKCQkJCS50aGVuKChyVHh0KSA9PiB7CgkJCQkJbm90aWZ5KHJUeHQucmVwbGFjZSgvXy9nLCAiICIpLCA3MDAwKTsKCgkJCQkJaWYgKHJUeHQuaW5jbHVkZXMoImNoYW5nZWQiKSAmJiAhclR4dC5pbmNsdWRlcygid2FpdCIpKSB7CgkJCQkJCW93bkluZm8oKTsKCQkJCQkJaEFsaWFzID0gdHJ1ZTsKCQkJCQkJY2xvc2VEbGcoY0VsLmlkKTsKCQkJCQl9CgkJCQl9KQoJCQkJLmNhdGNoKChlcnJvcikgPT4gewoJCQkJCWNMb2coZXJyb3IpOwoJCQkJfSk7CgkJfQoJCWVsc2UgewoJCQlub3RpZnkoaXRlbUVsZW0ubWluTGVuZ3RoICsgIiBhICIgKyBpdGVtRWxlbS5tYXhMZW5ndGggKyAiIGNhcmFjdGVyZXMuIFNpbiBjYXJhY3RlcmVzL3NpbWJvbG9zIGVzcGVjaWFsZXMuIiwgNTAwMCwgIlJFRCIpOwoJCX0KCX0sICIiLCB7IHdpZHRoOiAiMTAwJSIgfSk7CgoJY0JyKGNFbC5pZCk7CgoJY0J0bihjRWwuaWQsICJybmQiLCAiY2FuY2VsIiwgKCkgPT4gewoJCWNsb3NlRGxnKGNFbC5pZCk7Cgl9LCAiIiwgeyB3aWR0aDogIjEwMCUiIH0pOwp9KTsKcElkID0gInBhbmVsX3Byb2ZpbGVzIjsKCmNCdG4ocElkLCAicm5kIiwgImNoYW5nZSBhdmF0YXIiLCAoKSA9PiB7CglzaG93RGxnKCJhdnRyX2RsZyIpOwp9LCAiQ2FtYmlhIGVsIGF2YXRhciBhIHVuYSBpbWFnZW4sIHNvbG8gVVJMUy4iLCB7IGp1c3RpZnlTZWxmOiAiY2VudGVyIiB9KTsKCmNEbGcocElkLCAiYXZ0cl9kbGciLCB7fSwge30sIChjRWwpID0+IHsKCWNUZXh0KGNFbC5pZCwgInJuZCIsICJDaGFuZ2UgYXZhdGFyIiwgY1N0eWxlcy5kbGdUaXRsZXMpOwoKCWNJbWcoY0VsLmlkLCAiYXZ0cl9wcmV2aWV3IiwgZEF2YXRhciwgOTAsIDkwLCB7CgkJZGlzcGxheTogImJsb2NrIiwKCQltYXJnaW46ICIwIGF1dG8iLAoJCW9iamVjdEZpdDogImNvdmVyIgoJfSk7CgoJY0JyKGNFbC5pZCk7CgoJY1RleHQoY0VsLmlkLCAicm5kIiwgIkltZ3VyIFVSTCBvbmx5LCBleGFtcGxlLiIsIHsKCQlzdDogewoJCQl0ZXh0QWxpZ246ICJjZW50ZXIiLAoJCQljb2xvcjogIndoaXRlIgoJCX0KCX0pOwoJY1RleHQoY0VsLmlkLCAicm5kIiwgImh0dHBzOi8vaS5pbWd1ci5jb20vR25KYUVaTC5wbmciLCB7CgkJc3Q6IHsKCQkJdGV4dEFsaWduOiAiY2VudGVyIiwKCQkJY29sb3I6ICJ3aGl0ZSIKCQl9Cgl9KTsKCgljVHh0Ym94KGNFbC5pZCwgInBmX2F2YXRhcl90ZXh0Ym94IiwgZmFsc2UsICIiLCAiMTAgYSAxMzAgY2FyYWN0ZXJlcy4gRXZpdGFyIHVzYXIgVVJMJ3MgZGUgZ2lmcy92aWRlb3MuIiwgewoJCW1hcmdpblRvcDogIjVweCIsCgkJd2lkdGg6ICI5NSUiCgl9LCB7CgkJcGF0dGVybjogIl4oaHR0cHM/OlwvXC8pPyhpXC5pbWd1clwuY29tXC8pKFthLXpBLVowLTldKykoXC5qcGd8XC5qcGVnfFwucG5nKSQiLAoJCW1pbkxlbmd0aDogMjAsCgkJbWF4TGVuZ3RoOiA0MCwKCQlyZXF1aXJlZDogdHJ1ZSwKCX0pOwoKCWNCcihjRWwuaWQpOwoKCWNCdG4oY0VsLmlkLCAicm5kIiwgInByZXZpZXciLCAoKSA9PiB7CgkJY29uc3QgaXRlbUVsZW0gPSBieUlkKCJwZl9hdmF0YXJfdGV4dGJveCIpOwoKCQlpZiAoY1R4dFZhbGlkKGl0ZW1FbGVtLmlkKSkgewoJCQlieUlkKCJhdnRyX3ByZXZpZXciKS5zcmMgPSBpdGVtRWxlbS52YWx1ZTsKCQl9CgkJZWxzZSB7CgkJCW5vdGlmeShpdGVtRWxlbS5taW5MZW5ndGggKyAiIGEgIiArIGl0ZW1FbGVtLm1heExlbmd0aCArICIgY2FyYWN0ZXJlcy4gU2luIGNhcmFjdGVyZXMvc2ltYm9sb3MgZXNwZWNpYWxlcy4iLCA1MDAwLCAiUkVEIik7CgkJfQoJfSwgIiIsIHsgd2lkdGg6ICIxMDAlIiB9KTsKCgljQnIoY0VsLmlkKTsKCWNIcihjRWwuaWQsIGZhbHNlKTsKCgljQnRuKGNFbC5pZCwgInJuZCIsICJjaGFuZ2UiLCAoKSA9PiB7CgkJY29uc3QgaXRlbUVsZW0gPSBieUlkKCJwZl9hdmF0YXJfdGV4dGJveCIpOwoKCQlpZiAoY1R4dFZhbGlkKGl0ZW1FbGVtLmlkKSkgewoJCQlsZXQgdmFsID0gaXRlbUVsZW0udmFsdWU7CgoJCQlzQnRuKCdjaGFuZ2VfYXZhdGFyJywgdmFsKQoJCQkJLnRoZW4oKHJUeHQpID0+IHsKCQkJCQlub3RpZnkoclR4dC5yZXBsYWNlKC9fL2csICIgIiksIDcwMDApOwoKCQkJCQlpZiAoclR4dC5pbmNsdWRlcygiY2hhbmdlZCIpICYmICFyVHh0LmluY2x1ZGVzKCJ3YWl0IikpIHsKCQkJCQkJYnlJZCgiYXZ0cl9wcmV2aWV3Iikuc3JjID0gdmFsOwoJCQkJCQlieUlkKCJ1c2VyX2F2YXRhciIpLnNyYyA9IHZhbDsKCgkJCQkJCWNsb3NlRGxnKGNFbC5pZCk7CgkJCQkJfQoJCQkJfSkKCQkJCS5jYXRjaCgoZXJyb3IpID0+IHsKCQkJCQljTG9nKGVycm9yKTsKCQkJCX0pOwoJCX0KCQllbHNlIHsKCQkJbm90aWZ5KGl0ZW1FbGVtLm1pbkxlbmd0aCArICIgYSAiICsgaXRlbUVsZW0ubWF4TGVuZ3RoICsgIiBjYXJhY3RlcmVzLiBTaW4gY2FyYWN0ZXJlcy9zaW1ib2xvcyBlc3BlY2lhbGVzLiIsIDUwMDAsICJSRUQiKTsKCQl9Cgl9LCAiIiwgeyB3aWR0aDogIjEwMCUiIH0pOwoKCWNCcihjRWwuaWQpOwoKCWNCdG4oY0VsLmlkLCAicm5kIiwgImNhbmNlbCIsICgpID0+IHsKCQljbG9zZURsZyhjRWwuaWQpOwoJfSwgIiIsIHsgd2lkdGg6ICIxMDAlIiB9KTsKfSk7CgpwSWQgPSAicGFuZWxfcHJvZmlsZXMiOwoKY0J0bihwSWQsICJvcGVuZGxnZGVzYyIsICJjaGFuZ2UgZGVzY3JpcHRpb24iLCAoKSA9PiB7CglzaG93RGxnKCJkZXNjX2RsZyIpOwp9LCAiQ2FtYmlhIGxhIGRlc2NyaXBjaW9uIGRlIHR1IHBlcmZpbC4iLCB7IGp1c3RpZnlTZWxmOiAiY2VudGVyIiB9KTsKCmNCcigpOwoKY0RsZyhwSWQsICJkZXNjX2RsZyIsIHt9LCB7fSwgKGNFbCkgPT4gewoJY1RleHQoY0VsLmlkLCAicm5kIiwgIkNoYW5nZSBkZXNjcmlwdGlvbiIsIGNTdHlsZXMuZGxnVGl0bGVzKTsKCgljVGV4dEFyZWEoY0VsLmlkLCAiZGVzY3JpcHRpb25fY29udGVudCIsIGZhbHNlLCAiIiwgewoJCWhlaWdodDogJzEwMHB4JywKCQlyZXNpemU6ICdub25lJywKCQlvdmVyZmxvdzogJ2hpZGRlbicsCgkJd2hpdGVTcGFjZTogJ3ByZS13cmFwJywKCQltYXJnaW5Ub3A6ICI1cHgiLAoJCWp1c3RpZnlTZWxmOiAiY2VudGVyIiwKCQl3aWR0aDogIjEwMCUiLAoJCXRleHRib3g6IHsKCQkJZGlzcGxheTogImluaGVyaXQiCgkJfQoJfSwgewoJCXBhdHRlcm46ICJeW2EtekEtWjAtOSBdKiQiLAoJCW1pbkxlbmd0aDogNCwKCQltYXhMZW5ndGg6IDI1NiwKCQlwbGFjZWhvbGRlcjogImRlc2NyaXB0aW9uIiwKCQlyZXF1aXJlZDogdHJ1ZSwKCX0pOwoKCWNCcihjRWwuaWQpOwoKCWNCdG4oY0VsLmlkLCAicm5kIiwgImNoYW5nZSIsICgpID0+IHsKCQljb25zdCBpdGVtRWxlbSA9IGJ5SWQoImRlc2NyaXB0aW9uX2NvbnRlbnQiKTsKCgkJaWYgKGNUeHRWYWxpZChpdGVtRWxlbS5pZCkpIHsKCQkJbGV0IHZhbCA9IGl0ZW1FbGVtLnZhbHVlOwoKCQkJc0J0bigiY2hhbmdlX2Rlc2NyaXB0aW9uIiwgdmFsKQoJCQkJLnRoZW4oKHJUeHQpID0+IHsKCQkJCQlub3RpZnkoclR4dC5yZXBsYWNlKC9fL2csICIgIiksIDcwMDApOwoKCQkJCQlpZiAoclR4dC5pbmNsdWRlcygiY2hhbmdlZCIpICYmICFyVHh0LmluY2x1ZGVzKCJ3YWl0IikpIHsKCQkJCQkJb3duSW5mbygpOwoJCQkJCQljbG9zZURsZyhjRWwuaWQpOwoJCQkJCX0KCQkJCX0pCgkJCQkuY2F0Y2goKGVycm9yKSA9PiB7CgkJCQkJY0xvZyhlcnJvcik7CgkJCQl9KTsKCQl9CgkJZWxzZSB7CgkJCW5vdGlmeShpdGVtRWxlbS5taW5MZW5ndGggKyAiIGEgIiArIGl0ZW1FbGVtLm1heExlbmd0aCArICIgY2FyYWN0ZXJlcy4gU2luIGNhcmFjdGVyZXMvc2ltYm9sb3MgZXNwZWNpYWxlcy4iLCA1MDAwLCAiUkVEIik7CgkJfQoJfSwgIiIsIHsgd2lkdGg6ICIxMDAlIiB9KTsKCgljQnIoY0VsLmlkKTsKCgljQnRuKGNFbC5pZCwgInJuZCIsICJjYW5jZWwiLCAoKSA9PiB7CgkJY2xvc2VEbGcoY0VsLmlkKTsKCX0sICIiLCB7IHdpZHRoOiAiMTAwJSIgfSk7Cn0pOwoKY29uc3QgdktleXMgPSBbXTsKCmZvciAobGV0IGkgPSAweDQxOyBpIDw9IDB4NUE7IGkrKykgewoJdktleXMucHVzaCh7IGNvZGU6IGksIG5hbWU6IFN0cmluZy5mcm9tQ2hhckNvZGUoaSkgfSk7Cn0KCmZvciAobGV0IGkgPSAweDMwOyBpIDw9IDB4Mzk7IGkrKykgewoJdktleXMucHVzaCh7IGNvZGU6IGksIG5hbWU6IFN0cmluZy5mcm9tQ2hhckNvZGUoaSkgfSk7Cn0KCmNvbnN0IHN2S2V5cyA9IFsKCXsgY29kZTogMCwgbmFtZTogJ05PTkUnIH0sCgl7IGNvZGU6IDB4MDgsIG5hbWU6ICdCYWNrc3BhY2UnIH0sCgl7IGNvZGU6IDB4MDksIG5hbWU6ICdUYWInIH0sCgl7IGNvZGU6IDB4MEQsIG5hbWU6ICdFbnRlcicgfSwKCXsgY29kZTogMHgxMCwgbmFtZTogJ1NoaWZ0JyB9LAoJeyBjb2RlOiAweDExLCBuYW1lOiAnQ3RybCcgfSwKCXsgY29kZTogMHgxMiwgbmFtZTogJ0FsdCcgfSwKCXsgY29kZTogMHhBNCwgbmFtZTogJ0xlZnQgQWx0JyB9LAoJeyBjb2RlOiAweEE1LCBuYW1lOiAnUmlnaHQgQWx0JyB9LAoJeyBjb2RlOiAweDEzLCBuYW1lOiAnUGF1c2UvQnJlYWsnIH0sCgl7IGNvZGU6IDB4NUIsIG5hbWU6ICdMZWZ0IFdpbmRvd3MnIH0sCgl7IGNvZGU6IDB4NUMsIG5hbWU6ICdSaWdodCBXaW5kb3dzJyB9LAoJeyBjb2RlOiAweDVELCBuYW1lOiAnQXBwbGljYXRpb25zJyB9LAoJeyBjb2RlOiAweDYwLCBuYW1lOiAnTnVtUGFkIDAnIH0sCgl7IGNvZGU6IDB4NjEsIG5hbWU6ICdOdW1QYWQgMScgfSwKCXsgY29kZTogMHg2MiwgbmFtZTogJ051bVBhZCAyJyB9LAoJeyBjb2RlOiAweDYzLCBuYW1lOiAnTnVtUGFkIDMnIH0sCgl7IGNvZGU6IDB4NjQsIG5hbWU6ICdOdW1QYWQgNCcgfSwKCXsgY29kZTogMHg2NSwgbmFtZTogJ051bVBhZCA1JyB9LAoJeyBjb2RlOiAweDY2LCBuYW1lOiAnTnVtUGFkIDYnIH0sCgl7IGNvZGU6IDB4NjcsIG5hbWU6ICdOdW1QYWQgNycgfSwKCXsgY29kZTogMHg2OCwgbmFtZTogJ051bVBhZCA4JyB9LAoJeyBjb2RlOiAweDY5LCBuYW1lOiAnTnVtUGFkIDknIH0sCgl7IGNvZGU6IDB4NzAsIG5hbWU6ICdGMScgfSwKCXsgY29kZTogMHg3MSwgbmFtZTogJ0YyJyB9LAoJeyBjb2RlOiAweDcyLCBuYW1lOiAnRjMnIH0sCgl7IGNvZGU6IDB4NzMsIG5hbWU6ICdGNCcgfSwKCXsgY29kZTogMHg3NCwgbmFtZTogJ0Y1JyB9LAoJeyBjb2RlOiAweDc1LCBuYW1lOiAnRjYnIH0sCgl7IGNvZGU6IDB4NzYsIG5hbWU6ICdGNycgfSwKCXsgY29kZTogMHg3NywgbmFtZTogJ0Y4JyB9LAoJeyBjb2RlOiAweDc4LCBuYW1lOiAnRjknIH0sCgl7IGNvZGU6IDB4NzksIG5hbWU6ICdGMTAnIH0sCgl7IGNvZGU6IDB4N0EsIG5hbWU6ICdGMTEnIH0sCgl7IGNvZGU6IDB4N0IsIG5hbWU6ICdGMTInIH0sCgl7IGNvZGU6IDB4MDEsIG5hbWU6ICdMQlVUVE9OJyB9LAoJeyBjb2RlOiAweDAyLCBuYW1lOiAnUkJVVFRPTicgfSwKCXsgY29kZTogMHgwNCwgbmFtZTogJ01CVVRUT04nIH0sCgl7IGNvZGU6IDB4MDUsIG5hbWU6ICdYQlVUVE9OMScgfSwKCXsgY29kZTogMHgwNiwgbmFtZTogJ1hCVVRUT04yJyB9LAoJeyBjb2RlOiAweEJCLCBuYW1lOiAnPScgfSwKCXsgY29kZTogMHhCQywgbmFtZTogJywnIH0sCgl7IGNvZGU6IDB4QkQsIG5hbWU6ICctJyB9LAoJeyBjb2RlOiAweEJFLCBuYW1lOiAnLicgfSwKXTsKCnZLZXlzLnB1c2goLi4uc3ZLZXlzKTsKdktleXMuc29ydCgoYSwgYikgPT4geyByZXR1cm4gYS5jb2RlIC0gYi5jb2RlOyB9KTsKCmZ1bmN0aW9uIGNCaW5kRWxtKGtleUVsZW1lbnQsIGlkKSB7Cgljb25zdCBvcHRpb25FbGVtZW50ID0gY0VsZW1lbnQoIm9wdGlvbiIpOwoJb3B0aW9uRWxlbWVudC52YWx1ZSA9IGtleUVsZW1lbnQuY29kZTsKCW9wdGlvbkVsZW1lbnQudGV4dCA9IGtleUVsZW1lbnQubmFtZTsKCW9wdGlvbkVsZW1lbnQuaWQgPSBpZCArICJfb3B0IjsKCXJldHVybiBvcHRpb25FbGVtZW50Owp9CgpiaW5kRWxlbWVudHMuZm9yRWFjaCgoZWxlbWVudCkgPT4gewoJY29uc3QgdGFyZ2V0RWxlbWVudCA9IGJ5SWQoZWxlbWVudC50YXJnZXQpOwoJdktleXMuZm9yRWFjaCgoa2V5KSA9PiB7CgkJdGFyZ2V0RWxlbWVudC5hcHBlbmRDaGlsZChjQmluZEVsbShrZXksIGVsZW1lbnQuaWQpKTsKCX0pOwp9KTsKCmZ1bmN0aW9uIHJJbmZvKCkgewoJZm9yIChjb25zdCBpIGluIHVCb29sKSB7CgkJZ0Jvb2wodUJvb2xbaV0pOwoJfQoKCWZvciAoY29uc3QgaSBpbiB1Rmx0KSB7CgkJZ0Zsb2F0KHVGbHRbaV0pOwoJfQoKCWZvciAoY29uc3QgaSBpbiB1SW50KSB7CgkJZ0ludCh1SW50W2ldKTsKCX0KCglmb3IgKGNvbnN0IGkgaW4gdUludDIpIHsKCQlnSW50KHVJbnQyW2ldLCBmYWxzZSk7Cgl9Cn0KCmZ1bmN0aW9uIHVTZXJ2ZXIoKSB7Cglmb3IgKGNvbnN0IGkgaW4gdUJvb2wpIHsKCQlzQm9vbCh1Qm9vbFtpXSk7Cgl9CgoJZm9yIChjb25zdCBpIGluIHVGbHQpIHsKCQlzRmxvYXQodUZsdFtpXSk7Cgl9Cn0KCmZ1bmN0aW9uIHRhYkZpeChpZCwgZHNwbCA9ICJpbmxpbmUtYmxvY2siKSB7Cgl2YXIgZWxlbWVudHMgPSBbJ2VsZW1lbnRfbWFpbicsICdlbGVtZW50X2tleXMnLCAnZWxlbWVudF9vdmVybGF5JywgJ2VsZW1lbnRfc2V0dGluZycsICdlbGVtZW50X3FyY29kZSddOwoKCWVsZW1lbnRzLmZvckVhY2goYXN5bmMgKGVsZW1lbnQpID0+IHsKCQlpZiAoYnlJZChlbGVtZW50KSkKCQkJYnlJZChlbGVtZW50KS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwoJfSk7CgoJaWYgKGJ5SWQoaWQpKQoJCWJ5SWQoaWQpLnN0eWxlLmRpc3BsYXkgPSBkc3BsOwp9CgpmdW5jdGlvbiB0YWJTd2l0Y2goaSwgcG5sID0gImNlbnRlciIsIGRzcGwgPSAiaW5saW5lLWJsb2NrIikgewoJc3dpdGNoIChwbmwpIHsKCQljYXNlIDI6CgkJY2FzZSAiMiI6CgkJY2FzZSAicmlnaHQiOgoJCQlsZXQgdGFiMkJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJbYy10YWIyLWJ0bl0iKTsKCQkJdGFiMkJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7CgkJCQlpZiAoYnV0dG9uLmlkID09PSBpKSB7CgkJCQkJYnV0dG9uLmNsYXNzTGlzdC5hZGQoImFjdGl2ZSIpOwoJCQkJfSBlbHNlIHsKCQkJCQlidXR0b24uY2xhc3NMaXN0LnJlbW92ZSgiYWN0aXZlIik7CgkJCQl9CgkJCX0pOwoJCQlzd2l0Y2ggKGkpIHsKCQkJCWNhc2UgJ3BfdXBkYXRlcyc6CgkJCQkJYnlJZCgncGFuZWxfdXBkYXRlcycpLnN0eWxlLmRpc3BsYXkgPSAiZmxleCI7CgkJCQkJYnlJZCgncGFuZWxfdGlja2V0cycpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CgkJCQkJYnlJZCgncGFuZWxfcHJvZmlsZXMnKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAncF90aWNrZXRzJzoKCQkJCQlieUlkKCdwYW5lbF91cGRhdGVzJykuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKCQkJCQlieUlkKCdwYW5lbF90aWNrZXRzJykuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsKCQkJCQlieUlkKCdwYW5lbF9wcm9maWxlcycpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CgkJCQkJYnJlYWs7CgkJCQljYXNlICdwX3Byb2ZpbGUnOgoJCQkJCWJ5SWQoJ3BhbmVsX3VwZGF0ZXMnKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwoJCQkJCWJ5SWQoJ3BhbmVsX3RpY2tldHMnKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwoJCQkJCWJ5SWQoJ3BhbmVsX3Byb2ZpbGVzJykuc3R5bGUuZGlzcGxheSA9ICJncmlkIjsKCQkJCQlicmVhazsKCQkJfQoJCQlicmVhazsKCQljYXNlIDE6CgkJY2FzZSAiMSI6CgkJY2FzZSAiY2VudGVyIjoKCQkJbGV0IHRhYkJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJbYy10YWItYnRuXSIpOwoJCQl0YWJCdXR0b25zLmZvckVhY2goKGJ1dHRvbikgPT4gewoJCQkJaWYgKGJ1dHRvbi5pZCA9PT0gaSkgewoJCQkJCWJ1dHRvbi5jbGFzc0xpc3QuYWRkKCJhY3RpdmUiKTsKCQkJCX0gZWxzZSB7CgkJCQkJYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoImFjdGl2ZSIpOwoJCQkJfQoJCQl9KTsKCgkJCXN3aXRjaCAoaSkgewoJCQkJY2FzZSAnbWFpbl90YWInOgoJCQkJCXRhYkZpeCgnZWxlbWVudF9tYWluJywgZHNwbCk7CgkJCQkJYnJlYWs7CgkJCQljYXNlICdrZXlzX3RhYic6CgkJCQkJdGFiRml4KCdlbGVtZW50X2tleXMnLCBkc3BsKTsKCQkJCQlicmVhazsKCQkJCWNhc2UgJ292ZXJsYXlfdGFiJzoKCQkJCQl0YWJGaXgoJ2VsZW1lbnRfb3ZlcmxheScsIGRzcGwpOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAnc2V0dGluZ3NfdGFiJzoKCQkJCQl0YWJGaXgoJ2VsZW1lbnRfc2V0dGluZycsIGRzcGwpOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAncXJjb2RlX3RhYic6CgkJCQkJdGFiRml4KCdlbGVtZW50X3FyY29kZScsIGRzcGwpOwoJCQkJCWJyZWFrOwoJCQl9CgkJCWJyZWFrOwoJfQp9Cgp0YWJTd2l0Y2goIm1haW5fdGFiIiwgImNlbnRlciIsICJub25lIik7Cgp2YXIgaXRlckZvdW5kID0gMDsKdmFyIHdHYW1lRm91bmQgPSBmYWxzZTsKdmFyIHNob3VsZFVwZGF0ZSA9IHRydWU7CnZhciBpc01vdXNlSW5zaWRlID0gZmFsc2U7Cgpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJtb3VzZWVudGVyIiwgKCkgPT4geyBpc01vdXNlSW5zaWRlID0gdHJ1ZTsgfSk7CmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlbGVhdmUiLCAoKSA9PiB7IGlzTW91c2VJbnNpZGUgPSBmYWxzZTsgfSk7CmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoInZpc2liaWxpdHljaGFuZ2UiLCAoZXZlbnQpID0+IHsgc2hvdWxkVXBkYXRlID0gKGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PSAidmlzaWJsZSIpOyB9KTsKCnZhciBzdlVwZGF0ZXIgPSBzZXRJbnRlcnZhbChhc3luYyAoKSA9PiB7CglpZiAoYVVwZGF0ZSAmJiBzaG91bGRVcGRhdGUgJiYgZG9jdW1lbnQuYm9keS5zdHlsZS5jdXJzb3IgIT0gIm5vbmUiICYmIGlzTW91c2VJbnNpZGUpIHsKCQlhd2FpdCBsU2VydmVyKCk7Cgl9Cn0sIDUwMDApOwoKc2V0SW50ZXJ2YWwoKCkgPT4gewoJaWYgKGRvY3VtZW50LmJvZHkuc3R5bGUuY3Vyc29yICE9ICJub25lIiAmJiBpc01vdXNlSW5zaWRlKSB7CgkJdUNoYXQoKTsKCQlnT25saW5lcygpOwoJfQp9LCAyMDAwKTsKCmFzeW5jIGZ1bmN0aW9uIHpuR2V0KGlkRiwgZXgpIHsKCXJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CgkJJC5nZXQoIi90b2dnbGU/ZmVhdHVyZT0iICsgaWRGICsgIiZ2YWw9IiArIGV4LCAoclR4dCkgPT4gewoJCQlyZXNvbHZlKHJUeHQpOwoJCX0pLmZhaWwoKGVycm9yKSA9PiB7CgkJCXJlamVjdChlcnJvcik7CgkJfSk7Cgl9KTsKfQoKZnVuY3Rpb24gem5JbmZvKGlkRiwgZXgpIHsKCSQuZ2V0KCIvZ19pbmZvP2luZm89IiArIGlkRiwgKHJUeHQpID0+IHsKCQlpZiAoYnlJZChpZEYpICE9IHVuZGVmaW5lZCkgewoJCQlieUlkKGlkRikuaW5uZXJIVE1MID0gZXggKyByVHh0OwoJCQlpZiAoYnlJZChpZEYpLnN0eWxlLmRpc3BsYXkgPT0gIm5vbmUiKQoJCQkJYnlJZChpZEYpLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwoJCX0KCX0pOwp9Cgp2YXIgd2FpdGluZyA9IHNldEludGVydmFsKCgpID0+IHsKCSQuZ2V0KCIvZ19pbmZvP2luZm89Z2FtZWZvdW5kIiwgKHJUeHQpID0+IHsKCQl3R2FtZUZvdW5kID0gcGFyc2VJbnQoclR4dCk7CgkJaWYgKCF3R2FtZUZvdW5kKSB7CgkJCXpuSW5mbygid2FpdGluZ19nYW1lIiwgImludGlhbGl6aW5nPGJyPmNsb3NpbmcgaW46ICIpOwoJCQlieUlkKCJ1c2VyX2RheXMiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwoJCQlieUlkKCJlbGVtZW50X2J1dHRvbnMiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwoJCQlieUlkKCJlbGVtZW50X21haW4iKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwoJCQlieUlkKCJlbGVtZW50X2NvbmZpZyIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CgkJCXRhYlN3aXRjaCgibWFpbl90YWIiLCAiY2VudGVyIiwgIm5vbmUiKTsKCQl9CgkJZWxzZSB7CgkJCWl0ZXJGb3VuZCsrOwoKCQkJaWYgKGl0ZXJGb3VuZCA+IDUpIHsKCQkJCXpuSW5mbygidXNlcl9kYXlzIiwgImRheXMgbGVmdDogIik7CgkJCQl6bkluZm8oImxhc3RfdXBkYXRlIiwgIjxzdHJvbmc+VXBkYXRlZDwvc3Ryb25nPjogIik7CgkJCQl6bkluZm8oImNoYW5nZWxvZ3MiLCAiPHN0cm9uZz5DaGFuZ2Vsb2dzPC9zdHJvbmc+OiAiKTsKCQkJCWJ5SWQoIndhaXRpbmdfZ2FtZSIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CgkJCQlieUlkKCJlbGVtZW50X2J1dHRvbnMiKS5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOwoJCQkJYnlJZCgiZWxlbWVudF9tYWluIikuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CgkJCQlieUlkKCJlbGVtZW50X2NvbmZpZyIpLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwoJCQkJdGFiU3dpdGNoKCJtYWluX3RhYiIpOwoJCQkJdGFiU3dpdGNoKCJwX3VwZGF0ZXMiLCAyKTsKCQkJCWNsZWFySW50ZXJ2YWwod2FpdGluZyk7CgkJCX0KCQl9Cgl9KQp9LCAyNTApOwoKdmFyIHJ1bm5pbmcgPSBzZXRJbnRlcnZhbCgoKSA9PiB7Cgl0cnkgewoJCSQuZ2V0KCIvZ19pbmZvP2luZm89cnVubmluZyIsIChyVHh0KSA9PiB7IH0pLmZhaWwoKGVycm9yKSA9PiB7CgkJCWNFeGl0KCk7CgkJfSk7Cgl9IGNhdGNoIChlcnJvcikgewoJCWNMb2coZXJyb3IpOwoJCWFsZXJ0KGVycm9yKTsKCQljRXhpdCgpOwoJfQp9LCA1MDAwKTsKCmZ1bmN0aW9uIGNEbGcoaWRXLCBpZEl0LCBzdHlsZXogPSB7fSwgZWxlbW50ID0ge30sIGZuYyA9IChjRWwpID0+IHsgfSkgewoJaWYgKGlkSXQgPT0gInJuZCIpCgkJaWRJdCA9IGdSbmRJZCgpOwoKCWlmIChjaGVja0VsbW50KGlkVywgaWRJdCkpCgkJcmV0dXJuOwoKCWNvbnN0IGRpYWxvZyA9IGNFbGVtZW50KCJkaWFsb2ciKTsKCWRpYWxvZy5pZCA9IGlkSXQ7CgoJaWYgKHN0eWxleikgewoJCU9iamVjdC5hc3NpZ24oZGlhbG9nLnN0eWxlLCBzdHlsZXopOwoJfQoKCWlmIChlbGVtbnQpIHsKCQlmb3IgKGxldCBrZXkgaW4gZWxlbW50KSB7CgkJCWNvbnN0IGVsZW1lbnQgPSBlbGVtbnRba2V5XTsKCQkJY29uc3QgZWwgPSBjRWxlbWVudChlbGVtZW50LnR5cGUpOwoJCQlPYmplY3QuYXNzaWduKGVsLCBlbGVtZW50LnByb3BzKTsKCQkJT2JqZWN0LmFzc2lnbihlbC5zdHlsZSwgZWxlbWVudC5zdHlsZXMpOwoJCQlkaWFsb2cuYXBwZW5kQ2hpbGQoZWwpOwoJCX0KCX0KCglieUlkKGlkVykuYXBwZW5kQ2hpbGQoZGlhbG9nKTsKCglmbmMoZGlhbG9nKTsKCgl1RGxncy5wdXNoKGlkSXQpOwp9CgpmdW5jdGlvbiBjVG9vbHRpcChpZFcsIHR4dCkgewoJaWYgKGNoZWNrRWxtbnQoaWRXKSkKCQlyZXR1cm47CgoJaWYgKCF0eHQpCgkJcmV0dXJuOwoKCWNvbnN0IGNudHIgPSBieUlkKGlkVyk7Cgljb25zdCBpVHRpcCA9IGNFbGVtZW50KCJpIik7CgoJaVR0aXAuY2xhc3NOYW1lID0gImZhIGZhLXF1ZXN0aW9uLWNpcmNsZSBmYS0yIjsKCWlUdGlwLnNldEF0dHJpYnV0ZSgiYXJpYS1oaWRkZW4iLCAidHJ1ZSIpOwoJaVR0aXAuc3R5bGUuZGlzcGxheSA9ICJpbmxpbmUtYmxvY2siOwoJaVR0aXAuc3R5bGUuZm9udFdlaWdodCA9ICI5MDAiOwoJaVR0aXAuc3R5bGUuZm9udFNpemUgPSAiMTVweCI7CglpVHRpcC5zdHlsZS5vcGFjaXR5ID0gIjAuNSI7CglpVHRpcC5zdHlsZS5tYXJnaW5MZWZ0ID0gIjhweCI7CgoJaVR0aXAuc2V0QXR0cmlidXRlKCJkYXRhLXR0aXAiLCB0eHQpOwoKCWNudHIuYXBwZW5kQ2hpbGQoaVR0aXApOwp9CgpmdW5jdGlvbiBjRGl2KGlkVywgaWRJdCwgc3R5bGV6ID0ge30sIGVsZW1udCA9IHt9LCBmbmMgPSAoY0VsKSA9PiB7IH0pIHsKCWlmIChpZEl0ID09ICJybmQiKQoJCWlkSXQgPSBnUm5kSWQoKTsKCglpZiAoY2hlY2tFbG1udChpZFcsIGlkSXQpKQoJCXJldHVybjsKCgljb25zdCBkaXYgPSBjRWxlbWVudCgiZGl2Iik7CglkaXYuaWQgPSBpZEl0OwoJaWYgKGVsZW1udCkgewoJCU9iamVjdC5hc3NpZ24oZGl2LCBlbGVtbnQpOwoKCQlpZiAoZWxlbW50LmV2ZW50TGlzdGVuZXIpIHsKCQkJZm9yIChsZXQgZXZlbnROYW1lIGluIGVsZW1udC5ldmVudExpc3RlbmVyKSB7CgkJCQlkaXYuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsICgpID0+IHsKCQkJCQllbGVtbnQuZXZlbnRMaXN0ZW5lcltldmVudE5hbWVdKHRoaXMpOwoJCQkJfSk7CgkJCX0KCQl9Cgl9CgoJaWYgKHN0eWxleikgewoJCU9iamVjdC5hc3NpZ24oZGl2LnN0eWxlLCBzdHlsZXopOwoJfQoKCWNvbnN0IGNudHIgPSBieUlkKGlkVyk7CgljbnRyLmFwcGVuZENoaWxkKGRpdik7CgoJZm5jKGRpdik7Cn0KCmZ1bmN0aW9uIGNUYWJCdG4oaWRXLCBidXR0b25zLCB0eXBleiA9IDEpIHsKCWNvbnN0IGNudHIgPSBieUlkKGlkVyk7CgoJYnV0dG9ucy5mb3JFYWNoKGFzeW5jIChidXR0b24sIGluZGV4KSA9PiB7CgkJdmFyIGJ0biA9IGNFbGVtZW50KCJidXR0b24iKTsKCQlidG4uY2xhc3NOYW1lID0gInRhYi1idXR0b24iOwoJCWJ0bi5zZXRBdHRyaWJ1dGUodHlwZXogPT0gMSA/ICJjLXRhYi1idG4iIDogKCJjLXRhYiIgKyB0eXBleiArICItYnRuIiksICIiKTsKCQlidG4uaWQgPSBidXR0b24uaWQ7CgkJYnRuLmlubmVySFRNTCA9IGJ1dHRvbi50ZXh0OwoKCQlpZiAoaW5kZXggPT09IDApIHsKCQkJYnRuLnN0eWxlLmJvcmRlclRvcFJpZ2h0UmFkaXVzID0gIjBweCI7CgkJfSBlbHNlIGlmIChpbmRleCA9PT0gYnV0dG9ucy5sZW5ndGggLSAxKSB7CgkJCWJ0bi5zdHlsZS5ib3JkZXJUb3BMZWZ0UmFkaXVzID0gIjBweCI7CgkJfSBlbHNlIHsKCQkJYnRuLnN0eWxlLmJvcmRlclRvcFJpZ2h0UmFkaXVzID0gIjBweCI7CgkJCWJ0bi5zdHlsZS5ib3JkZXJUb3BMZWZ0UmFkaXVzID0gIjBweCI7CgkJfQoKCQlidG4ub25jbGljayA9ICgpID0+IHsKCQkJdGFiU3dpdGNoKGJ0bi5pZCwgdHlwZXopOwoJCX07CgoJCWNudHIuYXBwZW5kQ2hpbGQoYnRuKTsKCX0pOwp9CgpmdW5jdGlvbiBjQnRuKGlkVywgaWRJdCwgdHh0LCBmbmMgPSAoY0VsKSA9PiB7IH0sIHR0aXAgPSAiIiwgc3R5bGV6ID0ge30sIGVsZW1udCA9IHt9KSB7CglpZiAoaWRJdCA9PSAicm5kIikKCQlpZEl0ID0gZ1JuZElkKCk7CgoJaWYgKGNoZWNrRWxtbnQoaWRXLCBpZEl0KSkKCQlyZXR1cm47CgoJY29uc3QgYnV0dG9uID0gY0VsZW1lbnQoImJ1dHRvbiIpOwoJYnV0dG9uLnR5cGUgPSAiYnV0dG9uIjsKCWJ1dHRvbi5jbGFzc0xpc3QuYWRkKCJuZXdidXR0b24iKTsKCWJ1dHRvbi5pZCA9IGlkSXQ7CglidXR0b24uaW5uZXJIVE1MID0gdHh0OwoKCWlmIChlbGVtbnQpIHsKCQlPYmplY3QuYXNzaWduKGJ1dHRvbiwgZWxlbW50KTsKCgkJaWYgKGVsZW1udC5ldmVudExpc3RlbmVyKSB7CgkJCWZvciAobGV0IGV2ZW50TmFtZSBpbiBlbGVtbnQuZXZlbnRMaXN0ZW5lcikgewoJCQkJYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCAoKSA9PiB7CgkJCQkJZWxlbW50LmV2ZW50TGlzdGVuZXJbZXZlbnROYW1lXSh0aGlzKTsKCQkJCX0pOwoJCQl9CgkJfQoJfQoKCWlmIChzdHlsZXopIHsKCQlPYmplY3QuYXNzaWduKGJ1dHRvbi5zdHlsZSwgc3R5bGV6KTsKCX0KCglidXR0b24ub25jbGljayA9ICgpID0+IHsKCQlmbmMoYnV0dG9uKTsKCX07CgoJaWYgKHR0aXAgIT0gIiIpIHsKCQlidXR0b24uc2V0QXR0cmlidXRlKCJkYXRhLXR0aXAiLCB0dGlwKTsKCX0KCgljb25zdCBjbnRyID0gYnlJZChpZFcpOwoJY250ci5hcHBlbmRDaGlsZChidXR0b24pOwp9CgpmdW5jdGlvbiBjSHIoaWRXID0gcElkLCBtYXJnaW4gPSB0cnVlLCBzdHlsZXogPSB7fSkgewoJY29uc3QgY250ciA9IGJ5SWQoaWRXKTsKCXZhciBociA9IGNFbGVtZW50KCJociIpOwoJaWYgKG1hcmdpbikKCQloci5zdHlsZS5tYXJnaW5MZWZ0ID0gIi0yMHB4IjsKCgloci5zdHlsZS5ib3JkZXIgPSAiMHB4IjsKCWhyLnN0eWxlLmJvcmRlclRvcCA9ICIxcHggc29saWQgdmFyKC0tYy1ocikiOwoKCWlmIChzdHlsZXopIHsKCQlPYmplY3QuYXNzaWduKGhyLnN0eWxlLCBzdHlsZXopOwoJfQoKCWNudHIuYXBwZW5kQ2hpbGQoaHIpOwp9CgpmdW5jdGlvbiBjQnIoaWRXID0gcElkLCBjb3VudCA9IDEpIHsKCWNvbnN0IGNudHIgPSBieUlkKGlkVyk7Cglmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgY291bnQ7IGluZGV4KyspIHsKCQljbnRyLmFwcGVuZENoaWxkKGNFbGVtZW50KCJiciIpKTsKCX0KfQoKZnVuY3Rpb24gY0NoZWNrYm94KGlkVywgaWRJdCwgbGJsLCB0dGlwID0gIiIsIGZuYyA9IChjRWwpID0+IHsgfSkgewoJaWYgKGlkSXQgPT0gInJuZCIpCgkJaWRJdCA9IGdSbmRJZCgpOwoKCWlmIChjaGVja0VsbW50KGlkVywgaWRJdCkpCgkJcmV0dXJuOwoKCWNvbnN0IGRpdiA9IGNFbGVtZW50KCdkaXYnKTsKCWRpdi5jbGFzc0xpc3QuYWRkKCdlbGVtaXRlbXNfYmcnKTsKCWRpdi5odG1sRm9yID0gaWRJdDsKCWRpdi5zdHlsZS5kaXNwbGF5ID0gImlubGluZS1mbGV4IjsKCgljb25zdCBjaGVja2JveCA9IGNFbGVtZW50KCJpbnB1dCIpOwoJY2hlY2tib3gudHlwZSA9ICJjaGVja2JveCI7CgljaGVja2JveC5pZCA9IGlkSXQ7CgljaGVja2JveC5vbmNoYW5nZSA9ICgpID0+IHsKCQl1U2VydmVyKCk7CgkJZm5jKGNoZWNrYm94KTsKCX07CgoJY29uc3QgbGFiZWwgPSBjRWxlbWVudCgibGFiZWwiKTsKCWxhYmVsLmh0bWxGb3IgPSBpZEl0OwoJbGFiZWwuaW5uZXJIVE1MID0gbGJsOwoJbGFiZWwuaWQgPSBpZEl0ICsgInp6enp6IjsKCgljb25zdCBjbnRyID0gYnlJZChpZFcpOwoKCWRpdi5hcHBlbmRDaGlsZChjaGVja2JveCk7CglkaXYuYXBwZW5kQ2hpbGQobGFiZWwpOwoKCWNvbnN0IGlUdGlwID0gY0VsZW1lbnQoImkiKTsKCWlmICh0dGlwICE9ICIiKSB7CgkJaVR0aXAuY2xhc3NOYW1lID0gImZhIGZhLXF1ZXN0aW9uLWNpcmNsZSBmYS0yIjsKCQlpVHRpcC5zZXRBdHRyaWJ1dGUoImFyaWEtaGlkZGVuIiwgInRydWUiKTsKCQlpVHRpcC5zdHlsZS5kaXNwbGF5ID0gImlubGluZS1ibG9jayI7CgkJaVR0aXAuc3R5bGUuZm9udFdlaWdodCA9ICI5MDAiOwoJCWlUdGlwLnN0eWxlLmZvbnRTaXplID0gIjE1cHgiOwoJCWlUdGlwLnN0eWxlLm9wYWNpdHkgPSAiMC41IjsKCQlpVHRpcC5zdHlsZS5tYXJnaW5MZWZ0ID0gIjhweCI7CgoJCWlUdGlwLnNldEF0dHJpYnV0ZSgiZGF0YS10dGlwIiwgdHRpcCk7Cgl9CgoJY250ci5hcHBlbmRDaGlsZChkaXYpOwoKCWlmICh0dGlwICE9ICIiKSB7CgkJY250ci5hcHBlbmRDaGlsZChpVHRpcCk7Cgl9CgoJdUJvb2wucHVzaChpZEl0KTsKfQoKZnVuY3Rpb24gY0N1c3RvbXMoaWRXLCBpZEl0LCB0dGlwID0gIiIsIGZuYyA9IChjRWwpID0+IHsgfSwgc3R5bGV6ID0ge30pIHsKCWlmIChpZEl0ID09ICJybmQiKQoJCWlkSXQgPSBnUm5kSWQoKTsKCglpZiAoY2hlY2tFbG1udChpZFcsIGlkSXQpKQoJCXJldHVybjsKCgljb25zdCBjbnRyID0gYnlJZChpZFcpOwoKCWNvbnN0IGlUdGlwID0gY0VsZW1lbnQoImkiKTsKCWlUdGlwLmNsYXNzTmFtZSA9ICJmYSBmYS1jb2ciOwoJaVR0aXAuc2V0QXR0cmlidXRlKCJhcmlhLWhpZGRlbiIsICJ0cnVlIik7CglpVHRpcC5zdHlsZS5kaXNwbGF5ID0gImlubGluZS1ibG9jayI7CglpVHRpcC5zdHlsZS5mb250V2VpZ2h0ID0gIjkwMCI7CglpVHRpcC5zdHlsZS5mb250U2l6ZSA9ICIxNXB4IjsKCWlUdGlwLnN0eWxlLm9wYWNpdHkgPSAiMC41IjsKCWlUdGlwLnN0eWxlLm1hcmdpbkxlZnQgPSAiOHB4IjsKCWlUdGlwLnN0eWxlLmN1cnNvciA9ICJwb2ludGVyIjsKCWlUdGlwLmNpZCA9IGlkSXQgKyAiX2RsZyI7CgoJaWYgKHR0aXAgIT0gIiIpCgkJaVR0aXAuc2V0QXR0cmlidXRlKCJkYXRhLXR0aXAiLCB0dGlwKTsKCglpVHRpcC5vbmNsaWNrID0gYXN5bmMgKCkgPT4gewoJCXNob3dEbGcoaVR0aXAuY2lkKTsKCX0KCgljRGxnKGlkVywgaVR0aXAuY2lkLCBzdHlsZXopOwoKCWZuYyhpVHRpcCk7CgoJY250ci5hcHBlbmRDaGlsZChpVHRpcCk7Cn0KCmZ1bmN0aW9uIGNTbHJGbG9hdChpZFcsIGlkSXQsIGxibCwgbWluLCBtYXgsIHN0ZXBWYWwsIGRlZlZhbCwgdHRpcCA9ICIiKSB7CglpZiAoaWRJdCA9PSAicm5kIikKCQlpZEl0ID0gZ1JuZElkKCk7CgoJaWYgKGNoZWNrRWxtbnQoaWRXLCBpZEl0KSkKCQlyZXR1cm47CgoJdmFyIHNWYWxDZXJvcyA9IChTdHJpbmcoc3RlcFZhbCkuc3BsaXQoIi4iKVsxXSB8fCAiIik7CglzVmFsQ2Vyb3MgPSBzVmFsQ2Vyb3MubGVuZ3RoOwoKCWNvbnN0IGRpdiA9IGNFbGVtZW50KCdkaXYnKTsKCWRpdi5jbGFzc0xpc3QuYWRkKCdsZW5ndGgnLCAnZl9zbGlkZXJfYmcnKTsKCWRpdi5zZXRBdHRyaWJ1dGUoJ2RhdGEtbWluJywgbWluKTsKCWRpdi5zZXRBdHRyaWJ1dGUoJ2RhdGEtbWF4JywgbWF4KTsKCWRpdi5zdHlsZS5kaXNwbGF5ID0gImlubGluZS1mbGV4IjsKCgljb25zdCB0aXRsZURpdiA9IGNFbGVtZW50KCdkaXYnKTsKCXRpdGxlRGl2LmNsYXNzTGlzdC5hZGQoJ2xfdGl0bGUnLCAnZl90aXRsZScpOwoJdGl0bGVEaXYuc2V0QXR0cmlidXRlKCdkYXRhLWxlbmd0aCcsIGRlZlZhbCk7Cgl0aXRsZURpdi50ZXh0Q29udGVudCA9IGxibCArICI6ICI7CgoJY29uc3QgbnVtSW5wdXQgPSBjRWxlbWVudCgiaW5wdXQiKTsKCW51bUlucHV0LmNsYXNzTGlzdC5hZGQoIm51bWJlcnNsaWRlciIpOwoJbnVtSW5wdXQudHlwZSA9ICJudW1iZXIiOwoJbnVtSW5wdXQucGF0dGVybiA9ICJbMC05XSoiOwoJbnVtSW5wdXQuaW5wdXRNb2RlID0gIm51bWVyaWMiOwoJbnVtSW5wdXQuaWQgPSBpZEl0OwoJbnVtSW5wdXQubWluID0gbWluOwoJbnVtSW5wdXQubWF4ID0gbWF4OwoJbnVtSW5wdXQuc3RlcCA9IHN0ZXBWYWw7CgludW1JbnB1dC52YWx1ZSA9IGRlZlZhbDsKCW51bUlucHV0Lm9uaW5wdXQgPSAoKSA9PiB7CgkJdVNlcnZlcigpOwoJCWFwcGx5RmlsbChudW1JbnB1dCwgdHJ1ZSwgc1ZhbENlcm9zLCBudW1JbnB1dC52YWx1ZSk7Cgl9OwoKCWNvbnN0IG1pbkJ0biA9IGNFbGVtZW50KCJidXR0b24iKTsKCW1pbkJ0bi5jbGFzc0xpc3QuYWRkKCJjb250cm9scy1udW1iZXIiKTsKCW1pbkJ0bi5zdHlsZS5kaXNwbGF5ID0gImlubGluZSI7CgltaW5CdG4uc3R5bGUubWFyZ2luTGVmdCA9ICI4cHgiOwoJbWluQnRuLnN0eWxlLm1hcmdpblJpZ2h0ID0gIjhweCI7CgltaW5CdG4uaW5uZXJIVE1MID0gKCImIzg3MjI7IikudHJpbSgpOwoJbWluQnRuLm9uY2xpY2sgPSAoKSA9PiB7CgkJc3VtUmVzdEJ0bihpZEl0LCAwLCBtaW4sIG1heCwgMSwgc1ZhbENlcm9zKTsKCQl1U2VydmVyKCk7CgkJYXBwbHlGaWxsKG51bUlucHV0LCB0cnVlLCBzVmFsQ2Vyb3MsIG51bUlucHV0LnZhbHVlKTsKCX07CgoJY29uc3QgcGx1c0J0biA9IGNFbGVtZW50KCJidXR0b24iKTsKCXBsdXNCdG4uY2xhc3NMaXN0LmFkZCgiY29udHJvbHMtbnVtYmVyIik7CglwbHVzQnRuLnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lIjsKCXBsdXNCdG4uc3R5bGUubWFyZ2luTGVmdCA9ICI4cHgiOwoJcGx1c0J0bi5zdHlsZS5tYXJnaW5SaWdodCA9ICI4cHgiOwoJcGx1c0J0bi5pbm5lckhUTUwgPSAoIiYjNDM7IikudHJpbSgpOwoJcGx1c0J0bi5vbmNsaWNrID0gKCkgPT4gewoJCXN1bVJlc3RCdG4oaWRJdCwgMSwgbWluLCBtYXgsIDEsIHNWYWxDZXJvcyk7CgkJdVNlcnZlcigpOwoJCWFwcGx5RmlsbChudW1JbnB1dCwgdHJ1ZSwgc1ZhbENlcm9zLCBudW1JbnB1dC52YWx1ZSk7Cgl9OwoKCWNvbnN0IGNudHIgPSBieUlkKGlkVyk7CglkaXYuYXBwZW5kQ2hpbGQodGl0bGVEaXYpOwoJZGl2LmFwcGVuZENoaWxkKG1pbkJ0bik7CglkaXYuYXBwZW5kQ2hpbGQobnVtSW5wdXQpOwoJZGl2LmFwcGVuZENoaWxkKHBsdXNCdG4pOwoKCWNvbnN0IGlUdGlwID0gY0VsZW1lbnQoImkiKTsKCWlmICh0dGlwICE9ICIiKSB7CgkJaVR0aXAuY2xhc3NOYW1lID0gImZhIGZhLXF1ZXN0aW9uLWNpcmNsZSBmYS0yIjsKCQlpVHRpcC5zZXRBdHRyaWJ1dGUoImFyaWEtaGlkZGVuIiwgInRydWUiKTsKCQlpVHRpcC5zdHlsZS5kaXNwbGF5ID0gImlubGluZS1ibG9jayI7CgkJaVR0aXAuc3R5bGUuZm9udFdlaWdodCA9ICI5MDAiOwoJCWlUdGlwLnN0eWxlLmZvbnRTaXplID0gIjE1cHgiOwoJCWlUdGlwLnN0eWxlLm9wYWNpdHkgPSAiMC41IjsKCQlpVHRpcC5zdHlsZS5tYXJnaW5MZWZ0ID0gIjhweCI7CgoJCWlUdGlwLnNldEF0dHJpYnV0ZSgiZGF0YS10dGlwIiwgdHRpcCk7Cgl9CgoJY250ci5hcHBlbmRDaGlsZChkaXYpOwoKCWlmICh0dGlwICE9ICIiKSB7CgkJY250ci5hcHBlbmRDaGlsZChpVHRpcCk7Cgl9CgoJdUZsdC5wdXNoKGlkSXQpOwp9CgpmdW5jdGlvbiBjSW1nKGlkVywgaWRJdCwgc3JjLCB3aWR0aCwgaGVpZ2h0LCBzdHlsZXogPSB7fSwgZWxlbW50ID0ge30pIHsKCWlmIChpZEl0ID09ICJybmQiKQoJCWlkSXQgPSBnUm5kSWQoKTsKCglpZiAoY2hlY2tFbG1udChpZFcsIGlkSXQpKQoJCXJldHVybjsKCgoJY29uc3QgY250ciA9IGJ5SWQoaWRXKTsKCWNvbnN0IGltZyA9IGNFbGVtZW50KCJpbWciKTsKCglpbWcuc2V0QXR0cmlidXRlKCdpZCcsIGlkSXQpOwoJaW1nLnNldEF0dHJpYnV0ZSgnc3JjJywgc3JjKTsKCWltZy5zZXRBdHRyaWJ1dGUoJ2FsdCcsICJ1X2F2YXRhciIpOwoJaW1nLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCB3aWR0aCk7CglpbWcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCBoZWlnaHQpOwoKCWlmIChlbGVtbnQpIHsKCQlPYmplY3QuYXNzaWduKGltZywgZWxlbW50KTsKCgkJaWYgKGVsZW1udC5ldmVudExpc3RlbmVyKSB7CgkJCWZvciAobGV0IGV2ZW50TmFtZSBpbiBlbGVtbnQuZXZlbnRMaXN0ZW5lcikgewoJCQkJaW1nLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCAoZXZlbnQpID0+IHsKCQkJCQllbGVtbnQuZXZlbnRMaXN0ZW5lcltldmVudE5hbWVdKHRoaXMsIGV2ZW50KTsKCQkJCX0pOwoJCQl9CgkJfQoJfQoKCWlmIChzdHlsZXopIHsKCQlPYmplY3QuYXNzaWduKGltZy5zdHlsZSwgc3R5bGV6KTsKCX0KCgljbnRyLmFwcGVuZENoaWxkKGltZyk7Cn0KCmZ1bmN0aW9uIGNUZXh0QXJlYShpZFcsIGlkSXQsIGhpZGRlbiA9IGZhbHNlLCBsYmwgPSAiIiwgc3R5bGV6ID0ge30sIGVsZW1udCA9IHt9KSB7CglpZiAoaWRJdCA9PSAicm5kIikKCQlpZEl0ID0gZ1JuZElkKCk7CgoJaWYgKGNoZWNrRWxtbnQoaWRXLCBpZEl0KSkKCQlyZXR1cm47CgoJY29uc3QgdGV4dGJveERpdiA9IGNFbGVtZW50KCJkaXYiKTsKCWlmIChsYmwgIT09ICIiKSB7CgkJdGV4dGJveERpdi5jbGFzc0xpc3QuYWRkKCJ0ZXh0Ym94Iik7CgoJCWNvbnN0IGxhYmVsRWxlbSA9IGNFbGVtZW50KCJsYWJlbCIpOwoJCWxhYmVsRWxlbS50ZXh0Q29udGVudCA9IGxibC50cmltKCk7CgkJbGFiZWxFbGVtLmlkID0gaWRJdCArICJsYmwiOwoJCWxhYmVsRWxlbS5zdHlsZS5kaXNwbGF5ID0gaGlkZGVuID8gIm5vbmUiIDogImlubGluZS1ibG9jayI7CgkJbGFiZWxFbGVtLnNldEF0dHJpYnV0ZSgiZm9yIiwgaWRJdCk7CgoJCWlmIChzdHlsZXogJiYgc3R5bGV6LmxhYmVseikgewoJCQlPYmplY3QuYXNzaWduKHRleHRib3hEaXYuc3R5bGUsIHN0eWxlei5sYWJlbHopOwoJCX0KCQl0ZXh0Ym94RGl2LmFwcGVuZENoaWxkKGxhYmVsRWxlbSk7Cgl9CgoJY29uc3QgdGV4dEFyZWEgPSBjRWxlbWVudCgidGV4dGFyZWEiKTsKCgl0ZXh0QXJlYS5pZCA9IGlkSXQ7CgoJaWYgKGVsZW1udCkgewoJCU9iamVjdC5hc3NpZ24odGV4dEFyZWEsIGVsZW1udCk7CgoJCWlmIChlbGVtbnQuZXZlbnRMaXN0ZW5lcikgewoJCQlmb3IgKGxldCBldmVudE5hbWUgaW4gZWxlbW50LmV2ZW50TGlzdGVuZXIpIHsKCQkJCXRleHRBcmVhLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCAoKSA9PiB7CgkJCQkJZWxlbW50LmV2ZW50TGlzdGVuZXJbZXZlbnROYW1lXSh0aGlzKTsKCQkJCX0pOwoJCQl9CgkJfQoJfQoKCXRleHRBcmVhLnN0eWxlLmRpc3BsYXkgPSBoaWRkZW4gPyAibm9uZSIgOiAiaW5saW5lLWJsb2NrIjsKCglpZiAoc3R5bGV6KSB7CgkJT2JqZWN0LmFzc2lnbih0ZXh0QXJlYS5zdHlsZSwgc3R5bGV6KTsKCgkJaWYgKHN0eWxlei50ZXh0Ym94KSB7CgkJCU9iamVjdC5hc3NpZ24odGV4dGJveERpdi5zdHlsZSwgc3R5bGV6LnRleHRib3gpOwoJCX0KCX0KCglpZiAobGJsICE9PSAiIikgewoJCXRleHRib3hEaXYuYXBwZW5kQ2hpbGQodGV4dEFyZWEpOwoJfSBlbHNlIHsKCQljb25zdCBjbnRyID0gYnlJZChpZFcpOwoJCWNudHIuYXBwZW5kQ2hpbGQodGV4dEFyZWEpOwoJfQoKCWNvbnN0IGNudHIgPSBieUlkKGlkVyk7CglpZiAobGJsID09PSAiIiAmJiBjbnRyKSB7CgkJY250ci5hcHBlbmRDaGlsZCh0ZXh0QXJlYSk7Cgl9IGVsc2UgaWYgKGNudHIpIHsKCQljbnRyLmFwcGVuZENoaWxkKHRleHRib3hEaXYpOwoJfQp9CgpmdW5jdGlvbiBjVHh0Ym94KGlkVywgaWRJdCwgaGlkZGVuID0gZmFsc2UsIGxibCA9ICIiLCB0dGlwID0gIiIsIHN0eWxleiA9IHt9LCBlbGVtbnQgPSB7fSwgZGlzU3R5bGUgPSBmYWxzZSkgewoJaWYgKGlkSXQgPT0gInJuZCIpCgkJaWRJdCA9IGdSbmRJZCgpOwoKCWlmIChjaGVja0VsbW50KGlkVywgaWRJdCkpCgkJcmV0dXJuOwoKCWNvbnN0IHRleHRib3hEaXYgPSBjRWxlbWVudCgiZGl2Iik7CglpZiAobGJsICE9PSAiIikgewoJCXRleHRib3hEaXYuY2xhc3NMaXN0LmFkZCgidGV4dGJveCIpOwoKCQljb25zdCBsYWJlbEVsZW0gPSBjRWxlbWVudCgibGFiZWwiKTsKCQlsYWJlbEVsZW0udGV4dENvbnRlbnQgPSBsYmwudHJpbSgpOwoJCWxhYmVsRWxlbS5pZCA9IGlkSXQgKyAibGJsIjsKCQlsYWJlbEVsZW0uc3R5bGUuZGlzcGxheSA9IGhpZGRlbiA/ICJub25lIiA6ICJpbmxpbmUtYmxvY2siOwoJCWxhYmVsRWxlbS5zZXRBdHRyaWJ1dGUoImZvciIsIGlkSXQpOwoKCQlpZiAoc3R5bGV6ICYmIHN0eWxlei5sYWJlbHopIHsKCQkJT2JqZWN0LmFzc2lnbih0ZXh0Ym94RGl2LnN0eWxlLCBzdHlsZXoubGFiZWx6KTsKCQl9CgoJCXRleHRib3hEaXYuYXBwZW5kQ2hpbGQobGFiZWxFbGVtKTsKCX0KCgljb25zdCBpbnB1dCA9IGNFbGVtZW50KCJpbnB1dCIpOwoJaW5wdXQuc2V0QXR0cmlidXRlKCJ0eXBlIiwgInRleHQiKTsKCWlucHV0LnNldEF0dHJpYnV0ZSgiaWQiLCBpZEl0KTsKCglpZiAoZGlzU3R5bGUpCgkJaW5wdXQuc2V0QXR0cmlidXRlKCdkYXRhLW5vdmFsaWRpbnZhbGlkJywgJycpOwoKCWlmICh0dGlwICE9ICIiKSB7CgkJaW5wdXQuc2V0QXR0cmlidXRlKCJkYXRhLXR0aXAiLCB0dGlwKQoJfQoKCWlmIChlbGVtbnQpIHsKCQlPYmplY3QuYXNzaWduKGlucHV0LCBlbGVtbnQpOwoKCQlpZiAoZWxlbW50LmV2ZW50TGlzdGVuZXIpIHsKCQkJZm9yIChsZXQgZXZlbnROYW1lIGluIGVsZW1udC5ldmVudExpc3RlbmVyKSB7CgkJCQlpbnB1dC5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgKGV2KSA9PiB7CgkJCQkJZWxlbW50LmV2ZW50TGlzdGVuZXJbZXZlbnROYW1lXShpbnB1dCwgZXYpOwoJCQkJfSk7CgkJCX0KCQl9Cgl9CgoJaW5wdXQuc3R5bGUuZGlzcGxheSA9IGhpZGRlbiA/ICJub25lIiA6ICJpbmxpbmUtYmxvY2siOwoKCWlmIChzdHlsZXopIHsKCQlPYmplY3QuYXNzaWduKGlucHV0LnN0eWxlLCBzdHlsZXopOwoKCQlpZiAoc3R5bGV6LnRleHRib3gpIHsKCQkJT2JqZWN0LmFzc2lnbih0ZXh0Ym94RGl2LnN0eWxlLCBzdHlsZXoudGV4dGJveCk7CgkJfQoJfQoKCWlmIChsYmwgIT09ICIiKSB7CgkJdGV4dGJveERpdi5hcHBlbmRDaGlsZChpbnB1dCk7Cgl9IGVsc2UgewoJCWNvbnN0IGNudHIgPSBieUlkKGlkVyk7CgkJY250ci5hcHBlbmRDaGlsZChpbnB1dCk7Cgl9CgoJY29uc3QgY250ciA9IGJ5SWQoaWRXKTsKCWlmIChsYmwgPT09ICIiICYmIGNudHIpIHsKCQljbnRyLmFwcGVuZENoaWxkKGlucHV0KTsKCX0gZWxzZSBpZiAoY250cikgewoJCWNudHIuYXBwZW5kQ2hpbGQodGV4dGJveERpdik7Cgl9Cn0KCmZ1bmN0aW9uIGNUYWJsZShpZFcsIGlkSXQsIHR4dCwgc3R5bGV6ID0ge30sIGVsZW1udCA9IHt9KSB7CglpZiAoaWRJdCA9PSAicm5kIikKCQlpZEl0ID0gZ1JuZElkKCk7CgoJaWYgKGNoZWNrRWxtbnQoaWRXLCBpZEl0KSkKCQlyZXR1cm47CgoJY29uc3QgdHh0RGl2ID0gY0VsZW1lbnQoInRhYmxlIik7CgoJaWYgKHR4dCAhPSAiIikKCQl0eHREaXYuaW5uZXJIVE1MID0gdHh0LnRyaW0oKTsKCgl0eHREaXYuaWQgPSBpZEl0OwoKCWlmIChlbGVtbnQpIHsKCQlPYmplY3QuYXNzaWduKHR4dERpdiwgZWxlbW50KTsKCgkJaWYgKGVsZW1udC5ldmVudExpc3RlbmVyKSB7CgkJCWZvciAobGV0IGV2ZW50TmFtZSBpbiBlbGVtbnQuZXZlbnRMaXN0ZW5lcikgewoJCQkJdHh0RGl2LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCAoKSA9PiB7CgkJCQkJZWxlbW50LmV2ZW50TGlzdGVuZXJbZXZlbnROYW1lXSh0aGlzKTsKCQkJCX0pOwoJCQl9CgkJfQoJfQoKCWlmIChzdHlsZXopIHsKCQlPYmplY3QuYXNzaWduKHR4dERpdi5zdHlsZSwgc3R5bGV6KTsKCX0KCgljb25zdCBjbnRyID0gYnlJZChpZFcpOwoJY250ci5hcHBlbmRDaGlsZCh0eHREaXYpOwp9CgpmdW5jdGlvbiBjVGV4dChpZFcsIGlkSXQsIHR4dCwgY3MgPSB7fSkgewoJaWYgKGlkSXQgPT0gInJuZCIpCgkJaWRJdCA9IGdSbmRJZCgpOwoKCWlmIChjaGVja0VsbW50KGlkVywgaWRJdCkpCgkJcmV0dXJuOwoKCWNvbnN0IHR4dERpdiA9IGNFbGVtZW50KCJwIik7Cgl0eHREaXYuY2xhc3NMaXN0LmFkZCgidGV4dCIpOwoKCWlmICh0eHQpCgkJdHh0RGl2LmlubmVySFRNTCA9IHR4dC50cmltKCk7CgoJdHh0RGl2LmlkID0gaWRJdDsKCglpZiAoY3MuZXZlbnRzKSB7CgkJZm9yIChsZXQgZXZlbnROYW1lIGluIGNzLmV2ZW50cykgewoJCQl0eHREaXYuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIChldikgPT4gewoJCQkJY3MuZXZlbnRzW2V2ZW50TmFtZV0odHh0RGl2LCBldik7CgkJCX0pOwoJCX0KCX0KCglpZiAoY3MuZWwpIHsKCQlPYmplY3QuYXNzaWduKHR4dERpdiwgY3MuZWwpOwoJfQoKCWlmIChjcy5zdCkgewoJCU9iamVjdC5hc3NpZ24odHh0RGl2LnN0eWxlLCBjcy5zdCk7Cgl9CgoJaWYgKGNzLnN0MikgewoJCU9iamVjdC5hc3NpZ24odHh0RGl2LnN0eWxlLCBjcy5zdDIpOwoJfQoKCWNvbnN0IGNudHIgPSBieUlkKGlkVyk7CgljbnRyLmFwcGVuZENoaWxkKHR4dERpdik7CgoJaWYgKGNzLmZuICE9IHVuZGVmaW5lZCkKCQljcy5mbih0eHREaXYpOwp9CgpmdW5jdGlvbiBjQ29tYm9Cb3gyKGlkVywgaWRJdCwgb3B0cywgaGlkZGVuID0gZmFsc2UsIHR0aXAgPSAiIiwgc3R5bGV6ID0ge30pIHsKCWlmIChpZEl0ID09ICJybmQiKQoJCWlkSXQgPSBnUm5kSWQoKTsKCglpZiAoY2hlY2tFbG1udChpZFcsIGlkSXQpKQoJCXJldHVybjsKCgljb25zdCBzZWxlY3RFbGVtID0gY0VsZW1lbnQoInNlbGVjdCIpOwoJc2VsZWN0RWxlbS5jbGFzc0xpc3QuYWRkKCJzZWxlY3QtZHJvcGRvd24iKTsKCXNlbGVjdEVsZW0uaWQgPSBpZEl0OwoKCWlmICh0dGlwICE9ICIiKSB7CgkJc2VsZWN0RWxlbS5zZXRBdHRyaWJ1dGUoImRhdGEtdHRpcCIsIHR0aXApOwoJfQoKCW9wdHMuZm9yRWFjaCgob3B0aW9uLCBpbmRleCkgPT4gewoJCWNvbnN0IG9wdEVsZW0gPSBjRWxlbWVudCgib3B0aW9uIik7CgkJb3B0RWxlbS52YWx1ZSA9IGluZGV4OwoJCW9wdEVsZW0udGV4dCA9IG9wdGlvbjsKCQlzZWxlY3RFbGVtLmFkZChvcHRFbGVtKTsKCX0pOwoKCXNlbGVjdEVsZW0uc3R5bGUuZGlzcGxheSA9ICgoaGlkZGVuID09IHRydWUpID8gKCJub25lIikgOiAoImlubGluZS1ibG9jayIpKTsKCglpZiAoc3R5bGV6KSB7CgkJT2JqZWN0LmFzc2lnbihzZWxlY3RFbGVtLnN0eWxlLCBzdHlsZXopOwoJfQoKCWNvbnN0IGNudHIgPSBieUlkKGlkVyk7CgljbnRyLmFwcGVuZENoaWxkKHNlbGVjdEVsZW0pOwp9CgpmdW5jdGlvbiBjQ29tYm9Cb3goaWRXLCBpZEl0LCB0eHQsIG1pbiwgbWF4LCBzYW1lbGluZSA9IGZhbHNlLCB0dGlwID0gIiIsIGZuYyA9IChjRWwpID0+IHsgfSwgc3R5bGV6ID0ge30pIHsKCWlmIChpZEl0ID09ICJybmQiKQoJCWlkSXQgPSBnUm5kSWQoKTsKCglpZiAoY2hlY2tFbG1udChpZFcsIGlkSXQpKQoJCXJldHVybjsKCgljb25zdCB0eHREaXYgPSBjRWxlbWVudCgiZGl2Iik7CglpZiAodHh0ICE9ICIiKSB7CgkJdHh0RGl2LmNsYXNzTGlzdC5hZGQoInRleHQiKTsKCQl0eHREaXYudGV4dENvbnRlbnQgPSB0eHQudHJpbSgpOwoJfQoKCWNvbnN0IHNlbGVjdEVsZW0gPSBjRWxlbWVudCgic2VsZWN0Iik7CglzZWxlY3RFbGVtLmNsYXNzTGlzdC5hZGQoInNlbGVjdC1kcm9wZG93biIpOwoJc2VsZWN0RWxlbS5pZCA9IGlkSXQ7CglzZWxlY3RFbGVtLnN0eWxlLmhlaWdodCA9ICI0MnB4IjsKCglpZiAoc2FtZWxpbmUpCgkJc2VsZWN0RWxlbS5zdHlsZS5tYXJnaW5SaWdodCA9ICIxMHB4IjsKCglzZWxlY3RFbGVtLm9uY2hhbmdlID0gKCkgPT4gewoJCXNJbnQoaWRJdCwgbWluLCBtYXgpOwoJCWZuYyhzZWxlY3RFbGVtKTsKCX07CgoJaWYgKHN0eWxleikgewoJCU9iamVjdC5hc3NpZ24oc2VsZWN0RWxlbS5zdHlsZSwgc3R5bGV6KTsKCgkJaWYgKHN0eWxlei50ZXh0X2RpdikgewoJCQlPYmplY3QuYXNzaWduKHR4dERpdi5zdHlsZSwgc3R5bGV6LnRleHRfZGl2KTsKCQl9Cgl9CgoJY29uc3QgY250ciA9IGJ5SWQoaWRXKTsKCWlmICh0eHQgIT0gIiIpIHsKCQljbnRyLmFwcGVuZENoaWxkKHR4dERpdik7Cgl9CgljbnRyLmFwcGVuZENoaWxkKHNlbGVjdEVsZW0pOwoKCWNvbnN0IGlUdGlwID0gY0VsZW1lbnQoImkiKTsKCWlmICh0dGlwICE9ICIiKSB7CgkJaVR0aXAuY2xhc3NOYW1lID0gImZhIGZhLXF1ZXN0aW9uLWNpcmNsZSBmYS0yIjsKCQlpVHRpcC5zZXRBdHRyaWJ1dGUoImFyaWEtaGlkZGVuIiwgInRydWUiKTsKCQlpVHRpcC5zdHlsZS5kaXNwbGF5ID0gImlubGluZSI7CgkJaVR0aXAuc3R5bGUucG9zaXRpb24gPSAicmVsYXRpdmUiOwoJCWlUdGlwLnN0eWxlLm1hcmdpbkxlZnQgPSAiOHB4IgoJCWlUdGlwLnN0eWxlLmZvbnRXZWlnaHQgPSAiOTAwIjsKCQlpVHRpcC5zdHlsZS5mb250U2l6ZSA9ICIxNXB4IjsKCQlpVHRpcC5zdHlsZS5vcGFjaXR5ID0gIjAuNSI7CgoJCWlUdGlwLnNldEF0dHJpYnV0ZSgiZGF0YS10dGlwIiwgdHRpcCk7CgkJY250ci5hcHBlbmRDaGlsZChpVHRpcCk7Cgl9CgoJdUludDIucHVzaChpZEl0KTsKfQoKZnVuY3Rpb24gY0xvYWRpbmcoaWRXID0gcElkLCBpZEl0LCBzdHlsZXogPSB7fSkgewoJY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CglkaXYuY2xhc3NMaXN0LmFkZCgnbG9hZGVyJywgJ2xvYWRlci0tc3R5bGU4Jyk7CglkaXYuaWQgPSBpZEl0OwoKCWNvbnN0IHN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnc3ZnJyk7Cglzdmcuc2V0QXR0cmlidXRlKCd2ZXJzaW9uJywgJzEuMScpOwoJc3ZnLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAnMjRweCcpOwoJc3ZnLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgJzMwcHgnKTsKCXN2Zy5zZXRBdHRyaWJ1dGUoJ3ZpZXdCb3gnLCAnMCAwIDI0IDMwJyk7Cglzdmcuc3R5bGUuY3NzVGV4dCA9ICdlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDUwIDUwOyc7CgoJZm9yIChsZXQgaSA9IDA7IGkgPCAzOyBpKyspIHsKCQljb25zdCByZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdyZWN0Jyk7CgkJcmVjdC5zZXRBdHRyaWJ1dGUoJ3gnLCBgJHtpICogOH1gKTsKCQlyZWN0LnNldEF0dHJpYnV0ZSgneScsICcxMCcpOwoJCXJlY3Quc2V0QXR0cmlidXRlKCd3aWR0aCcsICc0Jyk7CgkJcmVjdC5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICcxMCcpOwoJCXJlY3Quc2V0QXR0cmlidXRlKCdmaWxsJywgJ29yYW5nZScpOwoJCXJlY3Quc2V0QXR0cmlidXRlKCdvcGFjaXR5JywgJzAuMicpOwoKCQljb25zdCBhbmltYXRlT3BhY2l0eSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnYW5pbWF0ZScpOwoJCWFuaW1hdGVPcGFjaXR5LnNldEF0dHJpYnV0ZSgnYXR0cmlidXRlTmFtZScsICdvcGFjaXR5Jyk7CgkJYW5pbWF0ZU9wYWNpdHkuc2V0QXR0cmlidXRlKCdhdHRyaWJ1dGVUeXBlJywgJ1hNTCcpOwoJCWFuaW1hdGVPcGFjaXR5LnNldEF0dHJpYnV0ZSgndmFsdWVzJywgJzAuMjsgMTsgLjInKTsKCQlhbmltYXRlT3BhY2l0eS5zZXRBdHRyaWJ1dGUoJ2JlZ2luJywgYCR7aSAqIDAuMTV9c2ApOwoJCWFuaW1hdGVPcGFjaXR5LnNldEF0dHJpYnV0ZSgnZHVyJywgJzAuNnMnKTsKCQlhbmltYXRlT3BhY2l0eS5zZXRBdHRyaWJ1dGUoJ3JlcGVhdENvdW50JywgJ2luZGVmaW5pdGUnKTsKCgkJY29uc3QgYW5pbWF0ZUhlaWdodCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnYW5pbWF0ZScpOwoJCWFuaW1hdGVIZWlnaHQuc2V0QXR0cmlidXRlKCdhdHRyaWJ1dGVOYW1lJywgJ2hlaWdodCcpOwoJCWFuaW1hdGVIZWlnaHQuc2V0QXR0cmlidXRlKCdhdHRyaWJ1dGVUeXBlJywgJ1hNTCcpOwoJCWFuaW1hdGVIZWlnaHQuc2V0QXR0cmlidXRlKCd2YWx1ZXMnLCAnMTA7IDIwOyAxMCcpOwoJCWFuaW1hdGVIZWlnaHQuc2V0QXR0cmlidXRlKCdiZWdpbicsIGAke2kgKiAwLjE1fXNgKTsKCQlhbmltYXRlSGVpZ2h0LnNldEF0dHJpYnV0ZSgnZHVyJywgJzAuNnMnKTsKCQlhbmltYXRlSGVpZ2h0LnNldEF0dHJpYnV0ZSgncmVwZWF0Q291bnQnLCAnaW5kZWZpbml0ZScpOwoKCQljb25zdCBhbmltYXRlWSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnYW5pbWF0ZScpOwoJCWFuaW1hdGVZLnNldEF0dHJpYnV0ZSgnYXR0cmlidXRlTmFtZScsICd5Jyk7CgkJYW5pbWF0ZVkuc2V0QXR0cmlidXRlKCdhdHRyaWJ1dGVUeXBlJywgJ1hNTCcpOwoJCWFuaW1hdGVZLnNldEF0dHJpYnV0ZSgndmFsdWVzJywgJzEwOyA1OyAxMCcpOwoJCWFuaW1hdGVZLnNldEF0dHJpYnV0ZSgnYmVnaW4nLCBgJHtpICogMC4xNX1zYCk7CgkJYW5pbWF0ZVkuc2V0QXR0cmlidXRlKCdkdXInLCAnMC42cycpOwoJCWFuaW1hdGVZLnNldEF0dHJpYnV0ZSgncmVwZWF0Q291bnQnLCAnaW5kZWZpbml0ZScpOwoKCQlyZWN0LmFwcGVuZENoaWxkKGFuaW1hdGVPcGFjaXR5KTsKCQlyZWN0LmFwcGVuZENoaWxkKGFuaW1hdGVIZWlnaHQpOwoJCXJlY3QuYXBwZW5kQ2hpbGQoYW5pbWF0ZVkpOwoKCQlzdmcuYXBwZW5kQ2hpbGQocmVjdCk7Cgl9CgoJZGl2LmFwcGVuZENoaWxkKHN2Zyk7CgoJaWYgKHN0eWxleikgewoJCU9iamVjdC5hc3NpZ24oZGl2LnN0eWxlLCBzdHlsZXopOwoJfQoKCWNvbnN0IHRhcmdldEVsZW1lbnQgPSBieUlkKGlkVykgfHwgZG9jdW1lbnQuYm9keTsKCXRhcmdldEVsZW1lbnQuYXBwZW5kQ2hpbGQoZGl2KTsKfQoKZnVuY3Rpb24gY1NsckludChpZFcsIGlkSXQsIGlUeHQsIG1pbiwgbWF4LCBzdGVwLCB2YWx1ZSwgdHRpcCA9ICIiLCBzdHlsZXogPSB7fSkgewoJaWYgKGlkSXQgPT0gInJuZCIpCgkJaWRJdCA9IGdSbmRJZCgpOwoKCWlmIChjaGVja0VsbW50KGlkVywgaWRJdCkpCgkJcmV0dXJuOwoKCWNvbnN0IGNudHIgPSBieUlkKGlkVyk7CgoJY29uc3QgZGl2ID0gY0VsZW1lbnQoJ2RpdicpOwoJZGl2LmNsYXNzTGlzdC5hZGQoJ2xlbmd0aCcsICdyX3NsaWRlcl9iZycpOwoJZGl2LnNldEF0dHJpYnV0ZSgnZGF0YS1taW4nLCBtaW4pOwoJZGl2LnNldEF0dHJpYnV0ZSgnZGF0YS1tYXgnLCBtYXgpOwoJZGl2LnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lLWZsZXgiOwoJaWYgKHN0eWxleiAmJiBzdHlsZXouYmd6KSB7CgkJT2JqZWN0LmFzc2lnbihkaXYuc3R5bGUsIHN0eWxlei5iZ3opOwoJfQoKCWNvbnN0IHRpdGxlRGl2ID0gY0VsZW1lbnQoJ2RpdicpOwoJdGl0bGVEaXYuY2xhc3NMaXN0LmFkZCgnbF90aXRsZScsICdmX3RpdGxlJyk7Cgl0aXRsZURpdi5zZXRBdHRyaWJ1dGUoJ2RhdGEtbGVuZ3RoJywgdmFsdWUpOwoJdGl0bGVEaXYudGV4dENvbnRlbnQgPSBpVHh0ICsgIjogIjsKCWlmIChzdHlsZXogJiYgc3R5bGV6LnRpdGxleikgewoJCU9iamVjdC5hc3NpZ24odGl0bGVEaXYuc3R5bGUsIHN0eWxlei50aXRsZXopOwoJfQoKCWNvbnN0IGlucHV0ID0gY0VsZW1lbnQoJ2lucHV0Jyk7CgoJY29uc3QgbWludXNCdG4gPSBjRWxlbWVudCgiYnV0dG9uIik7CgltaW51c0J0bi5jbGFzc05hbWUgPSAiY29udHJvbHMtbnVtYmVyIjsKCW1pbnVzQnRuLnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lIjsKCW1pbnVzQnRuLnN0eWxlLm1hcmdpbkxlZnQgPSAiOHB4IjsKCW1pbnVzQnRuLnN0eWxlLm1hcmdpblJpZ2h0ID0gIjhweCI7CgltaW51c0J0bi5pbm5lckhUTUwgPSAoIiYjODcyMjsiKS50cmltKCk7CgltaW51c0J0bi5vbmNsaWNrID0gKCkgPT4gewoJCXN1bVJlc3RCdG4oaWRJdCwgMCwgbWluLCBtYXgpOwoJCXNJbnQoaWRJdCwgbWluLCBtYXgpOwoJCWFwcGx5RmlsbChpbnB1dCk7Cgl9OwoKCWNvbnN0IHBsdXNCdG4gPSBjRWxlbWVudCgiYnV0dG9uIik7CglwbHVzQnRuLmNsYXNzTmFtZSA9ICJjb250cm9scy1udW1iZXIiOwoJcGx1c0J0bi5zdHlsZS5kaXNwbGF5ID0gImlubGluZSI7CglwbHVzQnRuLnN0eWxlLm1hcmdpbkxlZnQgPSAiOHB4IjsKCXBsdXNCdG4uc3R5bGUubWFyZ2luUmlnaHQgPSAiOHB4IjsKCXBsdXNCdG4uaW5uZXJIVE1MID0gKCImIzQzOyIpLnRyaW0oKTsKCXBsdXNCdG4ub25jbGljayA9ICgpID0+IHsKCQlzdW1SZXN0QnRuKGlkSXQsIDEsIG1pbiwgbWF4KTsKCQlzSW50KGlkSXQsIG1pbiwgbWF4KTsKCQlhcHBseUZpbGwoaW5wdXQpOwoJfTsKCglpbnB1dC5jbGFzc0xpc3QuYWRkKCdzbGlkZXInKTsKCWlucHV0LnNldEF0dHJpYnV0ZSgiaWQiLCBpZEl0KTsKCWlucHV0LnNldEF0dHJpYnV0ZSgndHlwZScsICdyYW5nZScpOwoJaW5wdXQuc2V0QXR0cmlidXRlKCdtaW4nLCBtaW4pOwoJaW5wdXQuc2V0QXR0cmlidXRlKCdtYXgnLCBtYXgpOwoJaW5wdXQuc2V0QXR0cmlidXRlKCdzdGVwJywgc3RlcCk7CglpbnB1dC5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgdmFsdWUpOwoJaW5wdXQub25jaGFuZ2UgPSAoKSA9PiB7CgkJc0ludChpZEl0LCBtaW4sIG1heCk7CgkJYXBwbHlGaWxsKGlucHV0KTsKCX07CgoJZGl2LmFwcGVuZENoaWxkKHRpdGxlRGl2KTsKCWRpdi5hcHBlbmRDaGlsZChtaW51c0J0bik7CglkaXYuYXBwZW5kQ2hpbGQoaW5wdXQpOwoJZGl2LmFwcGVuZENoaWxkKHBsdXNCdG4pOwoKCWNudHIuYXBwZW5kQ2hpbGQoZGl2KTsKCgljb25zdCBpVHRpcCA9IGNFbGVtZW50KCJpIik7CglpZiAodHRpcCAhPSAiIikgewoJCWlUdGlwLmNsYXNzTmFtZSA9ICJmYSBmYS1xdWVzdGlvbi1jaXJjbGUgZmEtMiI7CgkJaVR0aXAuc2V0QXR0cmlidXRlKCJhcmlhLWhpZGRlbiIsICJ0cnVlIik7CgkJaVR0aXAuc3R5bGUuZGlzcGxheSA9ICJpbmxpbmUiOwoJCWlUdGlwLnN0eWxlLnBvc2l0aW9uID0gInJlbGF0aXZlIjsKCQlpVHRpcC5zdHlsZS5tYXJnaW5MZWZ0ID0gIjhweCIKCQlpVHRpcC5zdHlsZS5mb250V2VpZ2h0ID0gIjkwMCI7CgkJaVR0aXAuc3R5bGUuZm9udFNpemUgPSAiMTVweCI7CgkJaVR0aXAuc3R5bGUub3BhY2l0eSA9ICIwLjUiOwoKCQlpZiAoc3R5bGV6ICYmIHN0eWxlei50dGlwcykgewoJCQlPYmplY3QuYXNzaWduKGlUdGlwLnN0eWxlLCBzdHlsZXoudHRpcHMpOwoJCX0KCgkJaVR0aXAuc2V0QXR0cmlidXRlKCJkYXRhLXR0aXAiLCB0dGlwKTsKCQljbnRyLmFwcGVuZENoaWxkKGlUdGlwKTsKCX0KCgl1SW50LnB1c2goaWRJdCk7Cn0KCmZ1bmN0aW9uIHVTbGlkZXJzKCkgewoJY29uc3QgaVNsaWRlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCIucl9zbGlkZXJfYmciKTsKCglpU2xpZGVycy5mb3JFYWNoKChzbGlkZXIpID0+IHsKCQljb25zdCBzbGlkZXJJbnB1dCA9IHNsaWRlci5xdWVyeVNlbGVjdG9yKCIuc2xpZGVyIik7CgkJY29uc3Qgc2xpZGVyVmFsdWUgPSBzbGlkZXIucXVlcnlTZWxlY3RvcigiLmxfdGl0bGUiKTsKCgkJc2xpZGVySW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCAoZXZlbnQpID0+IHsKCQkJc2xpZGVyVmFsdWUuc2V0QXR0cmlidXRlKCJkYXRhLWxlbmd0aCIsIGV2ZW50LnRhcmdldC52YWx1ZSk7CgkJCWFwcGx5RmlsbChldmVudC50YXJnZXQpOwoJCX0pOwoKCQlhcHBseUZpbGwoc2xpZGVySW5wdXQpOwoJfSk7CgoJY29uc3QgZlNsaWRlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCIuZl9zbGlkZXJfYmciKTsKCglmU2xpZGVycy5mb3JFYWNoKGFzeW5jIChzbGlkZXIpID0+IHsKCQljb25zdCBzbGlkZXJJbnB1dCA9IHNsaWRlci5xdWVyeVNlbGVjdG9yKCIubnVtYmVyc2xpZGVyIik7CgoJCWxldCBzVmFsQ2Vyb3MgPSAoU3RyaW5nKHNsaWRlcklucHV0LnN0ZXApLnNwbGl0KCIuIilbMV0gfHwgIiIpOwoKCQlhcHBseUZpbGwoc2xpZGVySW5wdXQsIHRydWUsIHNWYWxDZXJvcy5sZW5ndGgsIHNsaWRlcklucHV0LnZhbHVlKTsKCX0pOwp9CgpmdW5jdGlvbiBhcHBseUZpbGwoc0VsbSwgaXNGbHQgPSBmYWxzZSwgZmx0UGFyc2UgPSAxLCB2YWwpIHsKCWlmIChpc0ZsdCkgewoJCXNFbG0ucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCIubF90aXRsZSIpLnNldEF0dHJpYnV0ZSgiZGF0YS1sZW5ndGgiLCBwYXJzZUZsb2F0KHZhbCkudG9GaXhlZChmbHRQYXJzZSkpOwoJCXNFbG0uc3R5bGUuYmFja2dyb3VuZCA9IGNTdHlsZXMuYmdTbGlkZXJzOwoJCXNFbG0uc3R5bGUuY29sb3IgPSAndmFyKC0tYy10ZXh0KSc7CgkJc0VsbS5zdHlsZS5ib3JkZXJSYWRpdXMgPSAiNXB4IjsKCQlzRWxtLnN0eWxlLmJvcmRlciA9ICIxcHggc29saWQgdmFyKC0tYy1jb250b3Jub3MpIjsKCQlyZXR1cm47Cgl9CgoJY29uc3QgcGVyY2VudGFnZSA9ICgoMTAwICogKHNFbG0udmFsdWUgLSBzRWxtLm1pbikpIC8gKHNFbG0ubWF4IC0gc0VsbS5taW4pKS50b0ZpeGVkKDEpOwoJY29uc3QgYmcgPSBgbGluZWFyLWdyYWRpZW50KDkwZGVnLCB2YXIoLS1jLXByaW1hcnkpIDAlLCB2YXIoLS1jLXNlY29uZGFyeSkgJHtwZXJjZW50YWdlfSUsICR7Y1N0eWxlcy5iZ1NsaWRlcnN9ICR7cGVyY2VudGFnZX0lLCAke2NTdHlsZXMuYmdTbGlkZXJzfSAxMDAlKWA7CglzRWxtLnN0eWxlLmJhY2tncm91bmQgPSBiZzsKCXNFbG0ucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCIubF90aXRsZSIpLnNldEF0dHJpYnV0ZSgiZGF0YS1sZW5ndGgiLCBzRWxtLnZhbHVlKTsKfQoKZnVuY3Rpb24gc3VtUmVzdEJ0bihpZEl0LCBzdW0sIG1pbiwgbWF4LCBpc0ZsdCA9IDAsIGZsdFBhcnNlID0gMSkgewoJaWYgKGJ5SWQoaWRJdCkgPT0gdW5kZWZpbmVkKSB7CgkJY0xvZyhpZEl0LCAiZG9lc250IGV4aXN0Iik7CgkJcmV0dXJuOwoJfQoKCWlmIChpc0ZsdCkgewoJCWlmIChzdW0pIHsKCQkJaWYgKGJ5SWQoaWRJdCkudmFsdWUgPiBtYXgpCgkJCQlieUlkKGlkSXQpLnZhbHVlID0gcGFyc2VGbG9hdChtYXgpOwoJCQllbHNlCgkJCQlieUlkKGlkSXQpLnZhbHVlID0gKHBhcnNlRmxvYXQoYnlJZChpZEl0KS52YWx1ZSkgKyBwYXJzZUZsb2F0KGJ5SWQoaWRJdCkuc3RlcCkpLnRvRml4ZWQoZmx0UGFyc2UpOwoJCX0gZWxzZSB7CgkJCWlmIChieUlkKGlkSXQpLnZhbHVlIDwgbWluKQoJCQkJYnlJZChpZEl0KS52YWx1ZSA9IHBhcnNlRmxvYXQobWF4KTsKCQkJZWxzZQoJCQkJYnlJZChpZEl0KS52YWx1ZSA9IChwYXJzZUZsb2F0KGJ5SWQoaWRJdCkudmFsdWUpIC0gcGFyc2VGbG9hdChieUlkKGlkSXQpLnN0ZXApKS50b0ZpeGVkKGZsdFBhcnNlKTsKCQl9Cgl9CgllbHNlIHsKCQlpZiAoc3VtKSB7CgkJCWlmIChieUlkKGlkSXQpLnZhbHVlID4gbWF4KQoJCQkJYnlJZChpZEl0KS52YWx1ZSA9IHBhcnNlSW50KG1heCk7CgkJCWVsc2UKCQkJCWJ5SWQoaWRJdCkudmFsdWUgPSBwYXJzZUZsb2F0KGJ5SWQoaWRJdCkudmFsdWUpICsgcGFyc2VGbG9hdChieUlkKGlkSXQpLnN0ZXApOwoJCX0gZWxzZSB7CgkJCWlmIChieUlkKGlkSXQpLnZhbHVlIDwgbWluKQoJCQkJYnlJZChpZEl0KS52YWx1ZSA9IHBhcnNlSW50KG1heCk7CgkJCWVsc2UKCQkJCWJ5SWQoaWRJdCkudmFsdWUgPSBwYXJzZUZsb2F0KGJ5SWQoaWRJdCkudmFsdWUpIC0gcGFyc2VGbG9hdChieUlkKGlkSXQpLnN0ZXApOwoJCX0KCX0KfQoKd2luZG93Lm1vYmlsZUNoZWNrID0gKCkgPT4gewoJbGV0IGNoZWNrID0gZmFsc2U7CgkoKGEpID0+IHsgaWYgKC8oYW5kcm9pZHxiYlxkK3xtZWVnbykuK21vYmlsZXxhdmFudGdvfGJhZGFcL3xibGFja2JlcnJ5fGJsYXplcnxjb21wYWx8ZWxhaW5lfGZlbm5lY3xoaXB0b3B8aWVtb2JpbGV8aXAoaG9uZXxvZCl8aXJpc3xraW5kbGV8bGdlIHxtYWVtb3xtaWRwfG1tcHxtb2JpbGUuK2ZpcmVmb3h8bmV0ZnJvbnR8b3BlcmEgbShvYnxpbilpfHBhbG0oIG9zKT98cGhvbmV8cChpeGl8cmUpXC98cGx1Y2tlcnxwb2NrZXR8cHNwfHNlcmllcyg0fDYpMHxzeW1iaWFufHRyZW98dXBcLihicm93c2VyfGxpbmspfHZvZGFmb25lfHdhcHx3aW5kb3dzIGNlfHhkYXx4aWluby9pLnRlc3QoYSkgfHwgLzEyMDd8NjMxMHw2NTkwfDNnc298NHRocHw1MFsxLTZdaXw3NzBzfDgwMnN8YSB3YXxhYmFjfGFjKGVyfG9vfHNcLSl8YWkoa298cm4pfGFsKGF2fGNhfGNvKXxhbW9pfGFuKGV4fG55fHl3KXxhcHR1fGFyKGNofGdvKXxhcyh0ZXx1cyl8YXR0d3xhdShkaXxcLW18ciB8cyApfGF2YW58YmUoY2t8bGx8bnEpfGJpKGxifHJkKXxibChhY3xheil8YnIoZXx2KXd8YnVtYnxid1wtKG58dSl8YzU1XC98Y2FwaXxjY3dhfGNkbVwtfGNlbGx8Y2h0bXxjbGRjfGNtZFwtfGNvKG1wfG5kKXxjcmF3fGRhKGl0fGxsfG5nKXxkYnRlfGRjXC1zfGRldml8ZGljYXxkbW9ifGRvKGN8cClvfGRzKDEyfFwtZCl8ZWwoNDl8YWkpfGVtKGwyfHVsKXxlcihpY3xrMCl8ZXNsOHxleihbNC03XTB8b3N8d2F8emUpfGZldGN8Zmx5KFwtfF8pfGcxIHV8ZzU2MHxnZW5lfGdmXC01fGdcLW1vfGdvKFwud3xvZCl8Z3IoYWR8dW4pfGhhaWV8aGNpdHxoZFwtKG18cHx0KXxoZWlcLXxoaShwdHx0YSl8aHAoIGl8aXApfGhzXC1jfGh0KGMoXC18IHxffGF8Z3xwfHN8dCl8dHApfGh1KGF3fHRjKXxpXC0oMjB8Z298bWEpfGkyMzB8aWFjKCB8XC18XC8pfGlicm98aWRlYXxpZzAxfGlrb218aW0xa3xpbm5vfGlwYXF8aXJpc3xqYSh0fHYpYXxqYnJvfGplbXV8amlnc3xrZGRpfGtlaml8a2d0KCB8XC8pfGtsb258a3B0IHxrd2NcLXxreW8oY3xrKXxsZShub3x4aSl8bGcoIGd8XC8oa3xsfHUpfDUwfDU0fFwtW2Etd10pfGxpYnd8bHlueHxtMVwtd3xtM2dhfG01MFwvfG1hKHRlfHVpfHhvKXxtYygwMXwyMXxjYSl8bVwtY3J8bWUocmN8cmkpfG1pKG84fG9hfHRzKXxtbWVmfG1vKDAxfDAyfGJpfGRlfGRvfHQoXC18IHxvfHYpfHp6KXxtdCg1MHxwMXx2ICl8bXdicHxteXdhfG4xMFswLTJdfG4yMFsyLTNdfG4zMCgwfDIpfG41MCgwfDJ8NSl8bjcoMCgwfDEpfDEwKXxuZSgoY3xtKVwtfG9ufHRmfHdmfHdnfHd0KXxub2soNnxpKXxuenBofG8yaW18b3AodGl8d3YpfG9yYW58b3dnMXxwODAwfHBhbihhfGR8dCl8cGR4Z3xwZygxM3xcLShbMS04XXxjKSl8cGhpbHxwaXJlfHBsKGF5fHVjKXxwblwtMnxwbyhja3xydHxzZSl8cHJveHxwc2lvfHB0XC1nfHFhXC1hfHFjKDA3fDEyfDIxfDMyfDYwfFwtWzItN118aVwtKXxxdGVrfHIzODB8cjYwMHxyYWtzfHJpbTl8cm8odmV8em8pfHM1NVwvfHNhKGdlfG1hfG1tfG1zfG55fHZhKXxzYygwMXxoXC18b298cFwtKXxzZGtcL3xzZShjKFwtfDB8MSl8NDd8bWN8bmR8cmkpfHNnaFwtfHNoYXJ8c2llKFwtfG0pfHNrXC0wfHNsKDQ1fGlkKXxzbShhbHxhcnxiM3xpdHx0NSl8c28oZnR8bnkpfHNwKDAxfGhcLXx2XC18diApfHN5KDAxfG1iKXx0MigxOHw1MCl8dDYoMDB8MTB8MTgpfHRhKGd0fGxrKXx0Y2xcLXx0ZGdcLXx0ZWwoaXxtKXx0aW1cLXx0XC1tb3x0byhwbHxzaCl8dHMoNzB8bVwtfG0zfG01KXx0eFwtOXx1cChcLmJ8ZzF8c2kpfHV0c3R8djQwMHx2NzUwfHZlcml8dmkocmd8dGUpfHZrKDQwfDVbMC0zXXxcLXYpfHZtNDB8dm9kYXx2dWxjfHZ4KDUyfDUzfDYwfDYxfDcwfDgwfDgxfDgzfDg1fDk4KXx3M2MoXC18ICl8d2ViY3x3aGl0fHdpKGcgfG5jfG53KXx3bWxifHdvbnV8eDcwMHx5YXNcLXx5b3VyfHpldG98enRlXC0vaS50ZXN0KGEuc3Vic3RyKDAsIDQpKSkgY2hlY2sgPSB0cnVlOyB9KShuYXZpZ2F0b3IudXNlckFnZW50IHx8IG5hdmlnYXRvci52ZW5kb3IgfHwgd2luZG93Lm9wZXJhKTsKCXJldHVybiBjaGVjazsKfTsKCndpbmRvdy5zdGVhbUNoZWNrID0gKCkgPT4gewoJbGV0IHVzZXJBZ2VudCA9IG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKTsKCWxldCBpc1N0ZWFtQnJvd3NlciA9IHVzZXJBZ2VudC5pbmRleE9mKCJzdGVhbSIpID4gLTE7CglyZXR1cm4gaXNTdGVhbUJyb3dzZXI7Cn07CgppZiAoIXdpbmRvdy5tb2JpbGVDaGVjaygpKSB7CglieUlkKCJxcmNvZGVfdGV4dCIpLmlubmVySFRNTCA9ICJzY2FuIG9uIG1vYmlsZSBvciBlbnRlcjogIiArIHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSArICIgb24geW91ciBtb2JpbGUgYnJvd3NlciI7CglieUlkKCJxcmltYWdlIikuc3JjID0gImh0dHBzOi8vY2hhcnQuZ29vZ2xlYXBpcy5jb20vY2hhcnQ/Y2h0PXFyJmNobD0iICsgd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lICsgIiZjaHM9MjUweDI1MCZjaGxkPUx8MCI7CgoJd2luZG93Lm9ubG9hZCA9ICgpID0+IHsKCQlpZiAod2luZG93LmlubmVyV2lkdGggPCAxMDAwKSB7CgkJCXRQYW5lbCgnbGVmdF9wYW5lbCcpOwoJCQl0UGFuZWwoKTsKCQl9CgkJZWxzZSB7CgkJCWlmICh3aW5kb3cuc3RlYW1DaGVjaygpKSB7CgkJCQlieUlkKCJyaWdodF9wYW5lbCIpLnN0eWxlLm9wYWNpdHkgPSAwOwoJCQkJYnlJZCgicmlnaHRfcGFuZWwiKS5zdHlsZS53aWR0aCA9ICIwcHgiOwoKCQkJCXNldFRpbWVvdXQoYXN5bmMgKCkgPT4gewoJCQkJCWJ5SWQoInJpZ2h0X3BhbmVsIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKCQkJCX0sIDI1MCk7CgoJCQkJYnlJZCgibGVmdF9wYW5lbCIpLnN0eWxlLm9wYWNpdHkgPSAwOwoJCQkJYnlJZCgibGVmdF9wYW5lbCIpLnN0eWxlLndpZHRoID0gIjBweCI7CgoJCQkJc2V0VGltZW91dChhc3luYyAoKSA9PiB7CgkJCQkJYnlJZCgibGVmdF9wYW5lbCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CgkJCQl9LCAyNTApOwoKCQkJCW5vdGlmeSgicGFuZWxzIGRpc2FibGVkIG9uIHN0ZWFtLiIpOwoJCQl9IGVsc2UgewoJCQkJYnlJZCgicmlnaHRfcGFuZWwiKS5zdHlsZS5vcGFjaXR5ID0gMTsKCQkJCXNldFRpbWVvdXQoYXN5bmMgKCkgPT4gewoJCQkJCWJ5SWQoInJpZ2h0X3BhbmVsIikuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CgkJCQl9LCAyNTApOwoKCQkJCWJ5SWQoImxlZnRfcGFuZWwiKS5zdHlsZS5vcGFjaXR5ID0gMTsKCQkJCXNldFRpbWVvdXQoYXN5bmMgKCkgPT4gewoJCQkJCWJ5SWQoImxlZnRfcGFuZWwiKS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKCQkJCX0sIDI1MCk7CgkJCX0KCQl9Cgl9Owp9CmVsc2UgewoJZG9jdW1lbnQuYm9keS5zdHlsZS56b29tID0gIjc1JSI7Cgl0UGFuZWwoJ2xlZnRfcGFuZWwnKTsKCXRQYW5lbCgpOwoJYnlJZCgicXJjb2RlX3RleHQiKS5pbm5lckhUTUwgPSAib25seSBvbiBwYyIudHJpbSgpOwoJYnlJZCgicXJpbWFnZSIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7Cn0KCmZ1bmN0aW9uIHN0clRvQm9vbChzdHIpIHsKCXN3aXRjaCAoc3RyLnRvTG93ZXJDYXNlKCkudHJpbSgpKSB7CgkJY2FzZSAidHJ1ZSI6CgkJY2FzZSAieWVzIjoKCQljYXNlICIxIjoKCQkJcmV0dXJuIHRydWU7CgkJY2FzZSAiZmFsc2UiOgoJCWNhc2UgIm5vIjoKCQljYXNlICIwIjoKCQljYXNlIG51bGw6CgkJCXJldHVybiBmYWxzZTsKCQlkZWZhdWx0OgoJCQlyZXR1cm4gQm9vbGVhbihzdHIpOwoJfQp9CgpmdW5jdGlvbiBnQm9vbChtZGwpIHsKCSQuZ2V0KCIvZ19ib29sP2ZlYXR1cmU9IiArIG1kbCwgKHJUeHQpID0+IHsKCQlpZiAoYnlJZChtZGwpID09IHVuZGVmaW5lZCkgewoJCQljTG9nKG1kbCwgImRvZXNudCBleGlzdCIpOwoJCQlyZXR1cm47CgkJfQoKCQlieUlkKG1kbCkuY2hlY2tlZCA9IHN0clRvQm9vbChyVHh0KTsKCX0pOwp9CgpmdW5jdGlvbiBnSW50KG1kbCwgcmV0ID0gdHJ1ZSkgewoJJC5nZXQoIi9nX2ludD9mZWF0dXJlPSIgKyBtZGwsIChyVHh0KSA9PiB7CgkJaWYgKGJ5SWQobWRsKSA9PSB1bmRlZmluZWQpIHsKCQkJY0xvZyhtZGwsICJkb2VzbnQgZXhpc3QiKTsKCQkJcmV0dXJuOwoJCX0KCgkJYnlJZChtZGwpLnZhbHVlID0gclR4dDsKCgkJaWYgKG1kbC5pbmNsdWRlcygidGhlbWVfc2VsZWN0IikpIHsKCQkJYnlJZChtZGwpLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCJjaGFuZ2UiKSk7CgkJfQoKCQlpZiAocmV0KSB7CgkJCWlmIChieUlkKG1kbCArICJ6IikgIT0gdW5kZWZpbmVkKQoJCQkJYnlJZChtZGwgKyAieiIpLmlubmVySFRNTCA9IGJ5SWQobWRsKS52YWx1ZTsKCQl9Cgl9KTsKfQoKZnVuY3Rpb24gZ0Zsb2F0KG1kbCkgewoJJC5nZXQoIi9nX2Zsb2F0P2ZlYXR1cmU9IiArIG1kbCwgKHJUeHQpID0+IHsKCQlpZiAoYnlJZChtZGwpID09IHVuZGVmaW5lZCkgewoJCQljTG9nKG1kbCwgImRvZXNudCBleGlzdCIpOwoJCQlyZXR1cm47CgkJfQoKCQl2YXIgc1ZhbENlcm9zID0gKFN0cmluZyhieUlkKG1kbCkuc3RlcCkuc3BsaXQoIi4iKVsxXSB8fCAiIik7CgoJCWJ5SWQobWRsKS52YWx1ZSA9IHBhcnNlRmxvYXQoclR4dCkudG9GaXhlZChzVmFsQ2Vyb3MubGVuZ3RoKTsKCgkJaWYgKGJ5SWQobWRsICsgInoiKSAhPSB1bmRlZmluZWQpCgkJCWJ5SWQobWRsICsgInoiKS5pbm5lckhUTUwgPSBieUlkKG1kbCkudmFsdWU7Cgl9KTsKfQoKZnVuY3Rpb24gc0Jvb2wobWRsKSB7CglsZXQgbW9kdWxleiA9IGJ5SWQobWRsKTsKCWlmIChtb2R1bGV6ID09IHVuZGVmaW5lZCkgewoJCWNMb2cobWRsLCAiZG9lc250IGV4aXN0IikKCQlyZXR1cm47Cgl9Cgl2YXIgdmFsdWUgPSBtb2R1bGV6LmNoZWNrZWQ7CgoJJC5nZXQoIi9zX2Jvb2w/ZmVhdHVyZT0iICsgbWRsICsgIiZ2YWw9IiArIHZhbHVlLCAoclR4dCkgPT4geyB9KTsKfQoKZnVuY3Rpb24gc0ludChtZGwsIG1pbiA9IDAsIG1heCA9IDApIHsKCWxldCBtb2R1bGV6ID0gYnlJZChtZGwpOwoJaWYgKG1vZHVsZXogPT0gdW5kZWZpbmVkKSB7CgkJY0xvZyhtZGwgKyAiIG5vdCBmb3VuZCIpOwoJCXJldHVybjsKCX0KCgl2YXIgdmFsdWUgPSBtb2R1bGV6LnZhbHVlOwoKCWlmIChtaW4gPT0gMCAmJiBtYXggPT0gMCkgewoJCSQuZ2V0KCIvc19pbnQ/ZmVhdHVyZT0iICsgbWRsICsgIiZ2YWw9IiArIHZhbHVlLCAoclR4dCkgPT4gewoJCQl2YXIgZWxlbWVudEV4aXN0cyA9IGJ5SWQobWRsICsgInoiKTsKCQkJaWYgKGVsZW1lbnRFeGlzdHMgIT0gdW5kZWZpbmVkIHx8IGVsZW1lbnRFeGlzdHMgIT0gbnVsbCkKCQkJCWVsZW1lbnRFeGlzdHMuaW5uZXJIVE1MID0gclR4dDsKCQl9KTsKCX0gZWxzZSB7CgkJaWYgKHBhcnNlSW50KHZhbHVlKSA+PSBwYXJzZUludChtaW4pICYmIHBhcnNlSW50KHZhbHVlKSA8PSBwYXJzZUludChtYXgpKSB7CgkJCSQuZ2V0KCIvc19pbnQ/ZmVhdHVyZT0iICsgbWRsICsgIiZ2YWw9IiArIHZhbHVlLCAoclR4dCkgPT4gewoJCQkJdmFyIGVsZW1lbnRFeGlzdHMgPSBieUlkKG1kbCArICJ6Iik7CgkJCQlpZiAoZWxlbWVudEV4aXN0cyAhPSB1bmRlZmluZWQgfHwgZWxlbWVudEV4aXN0cyAhPSBudWxsKQoJCQkJCWVsZW1lbnRFeGlzdHMuaW5uZXJIVE1MID0gclR4dDsKCQkJfSk7CgkJfQoJCWVsc2UgewoJCQljTG9nKCJtaW5tYXggb3ZlcnBhc3NlZCB8ICIsIHZhbHVlLCBtaW4sIG1heCk7CgkJfQoJfQp9CgpmdW5jdGlvbiBzRmxvYXQobWRsKSB7CglsZXQgbW9kdWxleiA9IGJ5SWQobWRsKTsKCWlmIChtb2R1bGV6ID09IHVuZGVmaW5lZCkgewoJCWNMb2cobWRsLCAiZG9lc250IGV4aXN0IikKCQlyZXR1cm47Cgl9CgoJdmFyIHZhbHVlID0gcGFyc2VGbG9hdChtb2R1bGV6LnZhbHVlKTsKCXZhciBtaW4gPSBwYXJzZUZsb2F0KG1vZHVsZXoubWluKTsKCXZhciBtYXggPSBwYXJzZUZsb2F0KG1vZHVsZXoubWF4KTsKCglpZiAodmFsdWUgPj0gbWluICYmIHZhbHVlIDw9IG1heCkgewoJCSQuZ2V0KCIvc19mbG9hdD9mZWF0dXJlPSIgKyBtZGwgKyAiJnZhbD0iICsgdmFsdWUsIChyVHh0KSA9PiB7CgkJCWlmIChieUlkKG1kbCArICJ6IikgIT0gdW5kZWZpbmVkKQoJCQkJYnlJZChtZGwgKyAieiIpLmlubmVySFRNTCA9IHJUeHQ7CgkJfSk7Cgl9Cn0KCmZ1bmN0aW9uIHNJbmZvKG1kbCwgdmFsLCBmbmMgPSAoKSA9PiB7IH0pIHsKCSQuZ2V0KCIvc19pbmZvP2ZlYXR1cmU9IiArIG1kbCArICImdmFsPSIgKyB2YWwsIChyVHh0KSA9PiB7CgkJZm5jKCk7Cgl9KTsKfQoKZnVuY3Rpb24gZ1JuZElkKGxlbiA9IDgpIHsKCXZhciBpZCA9ICcnOwoJdmFyIGNoYXJhY3RlcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODknOwoJdmFyIGNoYXJhY3RlcnNMZW5ndGggPSBjaGFyYWN0ZXJzLmxlbmd0aDsKCglpZCA9ICcnOwoKCWZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKCQlpZCArPSBjaGFyYWN0ZXJzLmNoYXJBdChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjaGFyYWN0ZXJzTGVuZ3RoKSk7Cgl9CgoJcmV0dXJuIGlkOwp9CgpmdW5jdGlvbiBzQnRuKG1kbCwgdmFsID0gIiIpIHsKCXJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CgkJaWYgKHZhbCA9PSAiIikgewoJCQkkLmdldCgiL3RvZ2dsZT9mZWF0dXJlPSIgKyBtZGwsIChyVHh0KSA9PiB7CgkJCQlyZXNvbHZlKHJUeHQpOwoJCQl9KS5mYWlsKChlcnJvcikgPT4gewoJCQkJcmVqZWN0KGVycm9yKTsKCQkJfSk7CgkJfSBlbHNlIHsKCQkJJC5nZXQoIi90b2dnbGU/ZmVhdHVyZT0iICsgbWRsICsgIiZ2YWw9IiArIHZhbCwgKHJUeHQpID0+IHsKCQkJCXJlc29sdmUoclR4dCk7CgkJCX0pLmZhaWwoKGVycm9yKSA9PiB7CgkJCQlyZWplY3QoZXJyb3IpOwoJCQl9KTsKCQl9Cgl9KTsKfQoKZnVuY3Rpb24gY0V4aXQoKSB7CglzQnRuKCJkZWFkIik7CglzZXRUaW1lb3V0KCgpID0+IHsKCQl3aW5kb3cub3BlbigiIiwgIl9zZWxmIiwgIiIpOwoJCXdpbmRvdy5jbG9zZSgpOwoJCWhpc3RvcnkuZ28oLTEpOwoJCW5hdmlnYXRvci5hcHAuYmFja0hpc3RvcnkoKTsKCQl3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7Cgl9LCA1MDAwKTsKfQoKZnVuY3Rpb24gZkNvbWJvKGlkSXQsIGlkU3YpIHsKCSQuZ2V0KCIvZ19pbmZvP2luZm89IiArIGlkU3YsIChyVHh0KSA9PiB7CgkJdmFyIHNlbGVjdCA9IGJ5SWQoaWRJdCk7CgoJCWlmIChzZWxlY3QgPT0gdW5kZWZpbmVkKSB7CgkJCWNMb2coaWRJdCwgImRvZXNudCBleGlzdCIpOwoJCQlyZXR1cm47CgkJfQoKCQl2YXIgcmVzcG9uc2UgPSB3aW5kb3cuYXRvYihyVHh0KTsKCgkJaWYgKHJlc3BvbnNlICE9IG51bGwpIHsKCQkJcmVzcG9uc2UgPSBKU09OLnBhcnNlKHJlc3BvbnNlKTsKCQkJaWYgKHJlc3BvbnNlICE9IG51bGwpIHsKCQkJCXNlbGVjdC5pbm5lckhUTUwgPSAoIiIpLnRyaW0oKTsKCgkJCQlmb3IgKGNvbnN0IGtleSBpbiByZXNwb25zZSkgewoJCQkJCWlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChyZXNwb25zZSwga2V5KSkgewoJCQkJCQljb25zdCBlbGVtZW50ID0gcmVzcG9uc2Vba2V5XTsKCQkJCQkJdmFyIG9wdCA9IGNFbGVtZW50KCJvcHRpb24iKTsKCQkJCQkJb3B0LnZhbHVlID0ga2V5OwoJCQkJCQlvcHQuaWQgPSBpZEl0ICsgIl8iICsga2V5OwoJCQkJCQlvcHQuaW5uZXJIVE1MID0gZWxlbWVudFsiaWQiXTsKCQkJCQkJc2VsZWN0LmFwcGVuZENoaWxkKG9wdCk7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJfSk7Cn0KCndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJyZXNpemUiLCAoKSA9PiB7CglpZiAod2luZG93LmlubmVyV2lkdGggPCAxMDAwKSB7CgkJdFBhbmVsKCdsZWZ0X3BhbmVsJywgMSk7CgkJdFBhbmVsKCdyaWdodF9wYW5lbCcsIDEpOwoJfQoJZWxzZSB7CgkJdFBhbmVsKCdsZWZ0X3BhbmVsJywgMik7CgkJdFBhbmVsKCdyaWdodF9wYW5lbCcsIDIpOwoJfQp9KTsKCmFzeW5jIGZ1bmN0aW9uIHRQYW5lbChpZCA9ICJyaWdodF9wYW5lbCIsIHR5cGUgPSAwKSB7Cgljb25zdCBwRWxtID0gYnlJZChpZCk7CglpZiAodHlwZSA9PSAwKSB7CgkJaWYgKHBFbG0uc3R5bGUuZGlzcGxheSAhPSAibm9uZSIpIHsKCQkJcEVsbS5zdHlsZS53aWR0aCA9ICIwcHgiOwoJCQlwRWxtLnN0eWxlLmhlaWdodCA9ICIwcHgiOwoJCQlwRWxtLnN0eWxlLm9wYWNpdHkgPSAiMCI7CgkJCXNldFRpbWVvdXQoYXN5bmMgKCkgPT4gewoJCQkJcEVsbS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwoJCQl9LCAyNTApOwoKCQkJaWYgKHdpbmRvdy5tb2JpbGVDaGVjaygpIHx8ICh3aW5kb3cuaW5uZXJXaWR0aCA8IDEwMDApKSB7CgkJCQlieUlkKCJjZW50ZXJfcGFuZWwiKS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKCQkJCWlmICgoaWQpLmluY2x1ZGVzKCJyaWdodCIpKSB7CgkJCQkJYnlJZCgibV90X3JpZ2h0X3BhbmVsIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCWJ5SWQoIm1fdF9sZWZ0X3BhbmVsIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKCQkJCX0KCQkJfQoJCX0KCQllbHNlIHsKCQkJcEVsbS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKCQkJYXdhaXQgc2V0VGltZW91dChhc3luYyAoKSA9PiB7IH0sIDI1MCk7CgoJCQlwRWxtLnN0eWxlLndpZHRoID0gImF1dG8iOwoJCQlwRWxtLnN0eWxlLmhlaWdodCA9ICJhdXRvIjsKCQkJcEVsbS5zdHlsZS5vcGFjaXR5ID0gIjEiOwoKCQkJaWYgKHdpbmRvdy5tb2JpbGVDaGVjaygpIHx8ICh3aW5kb3cuaW5uZXJXaWR0aCA8IDEwMDApKSB7CgkJCQlieUlkKCJjZW50ZXJfcGFuZWwiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwoJCQkJaWYgKChpZCkuaW5jbHVkZXMoInJpZ2h0IikpIHsKCQkJCQlieUlkKCJtX3RfcmlnaHRfcGFuZWwiKS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCWJ5SWQoIm1fdF9sZWZ0X3BhbmVsIikuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CgkJCQl9CgkJCX0KCgkJfQoJfQoJZWxzZSB7CgkJaWYgKHBFbG0uc3R5bGUuZGlzcGxheSAhPSAibm9uZSIgJiYgdHlwZSA9PSAxKSB7CgkJCXBFbG0uc3R5bGUud2lkdGggPSAiMHB4IjsKCQkJcEVsbS5zdHlsZS5oZWlnaHQgPSAiMHB4IjsKCQkJcEVsbS5zdHlsZS5vcGFjaXR5ID0gIjAiOwoJCQlzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsKCQkJCXBFbG0uc3R5bGUuZGlzcGxheSA9ICJub25lIjsKCQkJfSwgMjUwKTsKCgkJCWlmICh3aW5kb3cubW9iaWxlQ2hlY2soKSB8fCAod2luZG93LmlubmVyV2lkdGggPCAxMDAwKSkgewoJCQkJYnlJZCgiY2VudGVyX3BhbmVsIikuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CgkJCQlpZiAoKGlkKS5pbmNsdWRlcygicmlnaHQiKSkgewoJCQkJCWJ5SWQoIm1fdF9yaWdodF9wYW5lbCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQlieUlkKCJtX3RfbGVmdF9wYW5lbCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CgkJCQl9CgkJCX0KCQl9CgkJZWxzZSBpZiAodHlwZSA9PSAyICYmIHBFbG0uc3R5bGUuZGlzcGxheSA9PSAibm9uZSIpIHsKCQkJcEVsbS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKCQkJYXdhaXQgc2xlZXAoMjUwKTsKCgkJCXBFbG0uc3R5bGUud2lkdGggPSAiYXV0byI7CgkJCXBFbG0uc3R5bGUuaGVpZ2h0ID0gImF1dG8iOwoJCQlwRWxtLnN0eWxlLm9wYWNpdHkgPSAiMSI7CgoJCQlpZiAod2luZG93Lm1vYmlsZUNoZWNrKCkgfHwgKHdpbmRvdy5pbm5lcldpZHRoIDwgMTAwMCkpIHsKCQkJCWJ5SWQoImNlbnRlcl9wYW5lbCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CgkJCQlpZiAoKGlkKS5pbmNsdWRlcygicmlnaHQiKSkgewoJCQkJCWJ5SWQoIm1fdF9yaWdodF9wYW5lbCIpLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJYnlJZCgibV90X2xlZnRfcGFuZWwiKS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKCQkJCX0KCQkJfQoKCQl9Cgl9Cn0KCnZhciBub3RpZnlJZCA9IDAsIG5vdGlmeUNudHIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjbm90aWZpY2F0aW9uLWNvbnRhaW5lciIpOwpmdW5jdGlvbiBub3RpZnkoYSwgYiwgZCkgeyBiID0gdm9pZCAwID09PSBiID8gMjUwMCA6IGI7IGQgPSArK25vdGlmeUlkOyB2YXIgYyA9IGNFbGVtZW50KCJkaXYiKTsgYy5jbGFzc0xpc3QuYWRkKCJub3RpZmljYXRpb24iKTsgYy5pbm5lckhUTUwgPSAoIjxwPiIgKyBhICsgIjwvcD48YnV0dG9uIGNsYXNzPSdjbG9zZS1idXR0b24nIGRhdGEtbm90aWZpY2F0aW9uLWlkPSciICsgZCArICInPiZ0aW1lczs8L2J1dHRvbj4iKS50cmltKCk7IGMuc3R5bGUubWFyZ2luTGVmdCA9ICJhdXRvIjsgYy5zdHlsZS53aWR0aCA9ICJmaXQtY29udGVudCI7IG5vdGlmeUNudHIuYXBwZW5kQ2hpbGQoYyk7IHNldFRpbWVvdXQoKCkgPT4geyBjLnN0eWxlLm9wYWNpdHkgPSAiMCI7IHNldFRpbWVvdXQoKCkgPT4geyBjLnJlbW92ZSgpIH0sIDQ1MCkgfSwgYik7IChhID0gYy5wcmV2aW91c1NpYmxpbmcpICYmIGEuc3R5bGUgJiYgKGEuc3R5bGUubWFyZ2luVG9wID0gIjZweCIpIH0Kbm90aWZ5Q250ci5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIChhKSA9PiB7IGlmIChhLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoImNsb3NlLWJ1dHRvbiIpKSB7IHZhciBiID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiW2RhdGEtbm90aWZpY2F0aW9uLWlkPSciICsgYS50YXJnZXQuZGF0YXNldC5ub3RpZmljYXRpb25JZCArICInXSIpLnBhcmVudEVsZW1lbnQ7IGIuc3R5bGUub3BhY2l0eSA9ICIwIjsgc2V0VGltZW91dCgoKSA9PiB7IGIucmVtb3ZlKCkgfSwgMjUwKTsgKGEgPSBiLnByZXZpb3VzU2libGluZykgJiYgYS5zdHlsZSAmJiAoYS5zdHlsZS5tYXJnaW5Ub3AgPSAiNnB4IikgfSB9KTsKYXN5bmMgZnVuY3Rpb24gc2xlZXAobXMpIHsgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpOyB9CgpmdW5jdGlvbiBnVG1JbnQoKSB7IHJldHVybiBNYXRoLnJvdW5kKCtuZXcgRGF0ZSgpIC8gMTAwMCk7IH0KCmZ1bmN0aW9uIGdUbVN0cih0bXMsIGhybWluID0gMSkgewoJdmFyIGRhdGUgPSBuZXcgRGF0ZSgrdG1zICogMTAwMCk7CglpZiAoaHJtaW4gPT0gMSkgewoJCXZhciBob3VyID0gKCIwIiArIGRhdGUuZ2V0SG91cnMoKSkuc3Vic3RyKC0yKTsKCQl2YXIgbWludXRlcyA9ICgiMCIgKyBkYXRlLmdldE1pbnV0ZXMoKSkuc3Vic3RyKC0yKTsKCQlyZXR1cm4gKGhvdXIgKyAiOiIgKyBtaW51dGVzKTsKCX0KCWVsc2UgaWYgKGhybWluID09IDIpIHsKCQl2YXIgaG91ciA9ICgiMCIgKyBkYXRlLmdldEhvdXJzKCkpLnN1YnN0cigtMik7CgkJdmFyIG1pbnV0ZXMgPSAoIjAiICsgZGF0ZS5nZXRNaW51dGVzKCkpLnN1YnN0cigtMik7CgkJdmFyIHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7CgkJdmFyIG1vbnRoID0gKCIwIiArIChkYXRlLmdldE1vbnRoKCkgKyAxKSkuc3Vic3RyKC0yKTsKCQl2YXIgZGF5ID0gKCIwIiArIGRhdGUuZ2V0RGF0ZSgpKS5zdWJzdHIoLTIpOwoJCXJldHVybiAoZGF5ICsgIi8iICsgbW9udGggKyAiLyIgKyB5ZWFyKSArICIgLSAiICsgKGhvdXIgKyAiOiIgKyBtaW51dGVzKTsKCX0KCWVsc2UgewoJCXZhciB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpOwoJCXZhciBtb250aCA9ICgiMCIgKyAoZGF0ZS5nZXRNb250aCgpICsgMSkpLnN1YnN0cigtMik7CgkJdmFyIGRheSA9ICgiMCIgKyBkYXRlLmdldERhdGUoKSkuc3Vic3RyKC0yKTsKCQlyZXR1cm4gKGRheSArICIvIiArIG1vbnRoICsgIi8iICsgeWVhcik7Cgl9Cn0KCmZ1bmN0aW9uIGNoZWNrRGxnKGlkRCkgewoJdmFyIG1vZGFsID0gYnlJZChpZEQpOwoJaWYgKG1vZGFsKSB7CgkJcmV0dXJuIG1vZGFsLmhhc0F0dHJpYnV0ZSgnb3BlbicpOwoJfQoJcmV0dXJuIGZhbHNlOwp9CgpmdW5jdGlvbiBzaG93RGxnKGlkRCkgewoJdmFyIG1vZGFsID0gYnlJZChpZEQpOwoJaWYgKG1vZGFsKSB7CgkJcmV0dXJuIG1vZGFsLnNob3dNb2RhbCgpOwoJfQoJcmV0dXJuIGZhbHNlOwp9CgpmdW5jdGlvbiBjbG9zZURsZyhpZEQpIHsKCXZhciBtb2RhbCA9IGJ5SWQoaWREKTsKCWlmIChtb2RhbCkgewoJCXJldHVybiBtb2RhbC5jbG9zZSgpOwoJfQoJcmV0dXJuIGZhbHNlOwp9CgpmdW5jdGlvbiBjVHh0VmFsaWQoaWQsIHdybiA9IGZhbHNlKSB7CglsZXQgZWxtbnQgPSBieUlkKGlkKTsKCWlmIChlbG1udCkgewoJCWlmICh3cm4pIHsKCQkJaWYgKCFlbG1udC52YWxpZGl0eS52YWxpZCkKCQkJCWFsZXJ0KCdpbnZhbGlkIGlucHV0XG4qIG5vIHN5bWJvbHMsIHsnICsgZWxtbnQubWluTGVuZ3RoICsgJy0nICsgZWxtbnQubWF4TGVuZ3RoICsgIiBjaGFycyBvbmx5fSIpOwoKCQkJcmV0dXJuIGVsbW50LnZhbGlkaXR5LnZhbGlkOwoJCX0KCQllbHNlCgkJCXJldHVybiBlbG1udC52YWxpZGl0eS52YWxpZDsKCX0KCWVsc2UKCQlyZXR1cm4gZmFsc2U7Cn0KCmZ1bmN0aW9uIGNoZWNrRWxtbnQoaWQxLCBpZDIpIHsKCWlmICghYnlJZChpZDEpKSB7CgkJY0xvZyhpZDEsICJkb2VzbnQgZXhpc3QiKTsKCQlyZXR1cm4gdHJ1ZTsKCX0KCglpZiAoaWQyKSB7CgkJaWYgKGJ5SWQoaWQyKSkgewoJCQljTG9nKGlkMiwgImFscmVhZHkgZXhpc3RzIik7CgkJCXJldHVybiB0cnVlOwoJCX0KCX0KCglyZXR1cm4gZmFsc2U7Cn0KCmZ1bmN0aW9uIHNlYXJjaFRhYmxlKGlkaSwgaWR0KSB7Cgl2YXIgaW5wdXQsIGZpbHRlciwgdGFibGUsIHRyLCB0ZCwgaSwgaiwgdHh0VmFsdWU7CglpbnB1dCA9IGJ5SWQoaWRpKTsKCWZpbHRlciA9IGlucHV0LnZhbHVlLnRvVXBwZXJDYXNlKCk7Cgl0YWJsZSA9IGJ5SWQoaWR0KTsKCXRyID0gdGFibGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRyIik7CgoJZm9yIChpID0gMTsgaSA8IHRyLmxlbmd0aDsgaSsrKSB7CgkJdHJbaV0uc3R5bGUuZGlzcGxheSA9ICJub25lIjsKCgkJdGQgPSB0cltpXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgidGQiKTsKCQlmb3IgKGogPSAwOyBqIDwgdGQubGVuZ3RoOyBqKyspIHsKCQkJaWYgKHRkW2pdKSB7CgkJCQl0eHRWYWx1ZSA9IHRkW2pdLnRleHRDb250ZW50IHx8IHRkW2pdLmlubmVyVGV4dDsKCQkJCWlmICh0eHRWYWx1ZS50b1VwcGVyQ2FzZSgpLmluZGV4T2YoZmlsdGVyKSA+IC0xKSB7CgkJCQkJdHJbaV0uc3R5bGUuZGlzcGxheSA9ICIiOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQl9CgkJfQoJfQp9CgpmdW5jdGlvbiBzb3J0VGFibGUobiwgaWQpIHsKCXZhciB0YWJsZSwKCQlyb3dzLAoJCXN3aXRjaGluZywKCQlpLAoJCXgsCgkJeSwKCQlzaG91bGRTd2l0Y2gsCgkJZGlyLAoJCXN3aXRjaENudCA9IDA7Cgl0YWJsZSA9IGJ5SWQoaWQpOwoJc3dpdGNoaW5nID0gdHJ1ZTsKCWRpciA9ICJhc2MiOwoJd2hpbGUgKHN3aXRjaGluZykgewoJCXN3aXRjaGluZyA9IGZhbHNlOwoJCXJvd3MgPSB0YWJsZS5yb3dzOwoJCWZvciAoaSA9IDE7IGkgPCByb3dzLmxlbmd0aCAtIDE7IGkrKykgewoJCQlzaG91bGRTd2l0Y2ggPSBmYWxzZTsKCQkJeCA9IHJvd3NbaV0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoIlREIilbbl07CgkJCXkgPSByb3dzW2kgKyAxXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiVEQiKVtuXTsKCQkJaWYgKGRpciA9PSAiYXNjIikgewoJCQkJaWYgKHguaW5uZXJIVE1MLnRvTG93ZXJDYXNlKCkgPiB5LmlubmVySFRNTC50b0xvd2VyQ2FzZSgpKSB7CgkJCQkJc2hvdWxkU3dpdGNoID0gdHJ1ZTsKCQkJCQlicmVhazsKCQkJCX0KCQkJfSBlbHNlIGlmIChkaXIgPT0gImRlc2MiKSB7CgkJCQlpZiAoeC5pbm5lckhUTUwudG9Mb3dlckNhc2UoKSA8IHkuaW5uZXJIVE1MLnRvTG93ZXJDYXNlKCkpIHsKCQkJCQlzaG91bGRTd2l0Y2ggPSB0cnVlOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQl9CgkJfQoJCWlmIChzaG91bGRTd2l0Y2gpIHsKCQkJcm93c1tpXS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShyb3dzW2kgKyAxXSwgcm93c1tpXSk7CgkJCXN3aXRjaGluZyA9IHRydWU7CgkJCXN3aXRjaENudCsrOwoJCX0gZWxzZSB7CgkJCWlmIChzd2l0Y2hDbnQgPT0gMCAmJiBkaXIgPT0gImFzYyIpIHsKCQkJCWRpciA9ICJkZXNjIjsKCQkJCXN3aXRjaGluZyA9IHRydWU7CgkJCX0KCQl9Cgl9Cn0KCmZ1bmN0aW9uIGNUaGVtZSgpIHsKCWNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmJvZHk7Cgljb25zdCB0aGVtZVNlbGVjdCA9IGJ5SWQoJ3RoZW1lX3NlbGVjdCcpOwoJY29uc3Qgc2VsZWN0ZWQgPSB0aGVtZVNlbGVjdC52YWx1ZTsKCWNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2RhdGEtdGhlbWUnLCBzZWxlY3RlZCk7CglzSW50KCd0aGVtZV9zZWxlY3QnKTsKfQoKYXN5bmMgZnVuY3Rpb24gbFNlcnZlcigpIHsKCWF3YWl0IHNsZWVwKDE1MDApOwoJckluZm8oKTsKCWF3YWl0IHNsZWVwKDE1MDApOwoJdVNsaWRlcnMoKTsKCWF3YWl0IHNsZWVwKDEwMCk7CglwU25kKCJzbmQxIik7Cn0KbFNlcnZlcigpOwoKZnVuY3Rpb24gY0xvZyguLi5hcmdzKSB7Cgljb25zb2xlLmxvZyguLi5hcmdzKTsKfTsKCmNMb2coImJyZWFraW5nIGNvY29udXRzIik7Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw==";
eval(atob(A));